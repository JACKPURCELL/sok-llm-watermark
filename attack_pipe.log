nohup: ignoring input
start rohith23
2024-01-10 18:52:29.280773: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:52:29.334483: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:52:29.334573: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:52:29.336016: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:52:29.344793: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:52:30.903058: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63069.40lines/s]
Running swap attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  12%|█▏        | 124/1000 [00:00<00:00, 1220.72 examples/s]
Map:  27%|██▋       | 267/1000 [00:00<00:00, 1335.44 examples/s]
Map:  41%|████      | 412/1000 [00:00<00:00, 1380.63 examples/s]
Map:  55%|█████▌    | 551/1000 [00:00<00:00, 1379.87 examples/s]
Map:  70%|██████▉   | 698/1000 [00:00<00:00, 1407.44 examples/s]
Map:  91%|█████████ | 908/1000 [00:00<00:00, 1399.59 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 38184.54it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 256/1000 [00:00<00:00, 2555.39it/s]
Logging series metrics to wandb:  54%|█████▎    | 536/1000 [00:00<00:00, 2698.98it/s]
Logging series metrics to wandb:  82%|████████▏ | 820/1000 [00:00<00:00, 2762.27it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2727.49it/s]
2024-01-10 18:53:06.128734: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:53:06.201578: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:53:06.201818: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:53:06.203396: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:53:06.213148: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:53:07.964043: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 59214.82lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<28:18,  1.70s/ examples]
Map:   1%|          | 7/1000 [00:01<03:14,  5.11 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:34, 10.40 examples/s]
Map:   2%|▏         | 21/1000 [00:02<00:53, 18.36 examples/s]
Map:   3%|▎         | 29/1000 [00:02<00:35, 27.18 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:27, 35.62 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:43, 21.85 examples/s]
Map:   5%|▌         | 53/1000 [00:03<00:33, 28.29 examples/s]
Map:   6%|▌         | 62/1000 [00:03<00:25, 37.08 examples/s]
Map:   7%|▋         | 71/1000 [00:03<00:20, 45.74 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:17, 53.50 examples/s]
Map:   9%|▉         | 91/1000 [00:03<00:14, 61.61 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:13, 67.49 examples/s]
Map:  11%|█         | 110/1000 [00:03<00:12, 72.40 examples/s]
Map:  12%|█▏        | 120/1000 [00:03<00:11, 78.25 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:10, 81.63 examples/s]
Map:  14%|█▍        | 143/1000 [00:04<00:09, 92.08 examples/s]
Map:  15%|█▌        | 154/1000 [00:04<00:09, 92.56 examples/s]
Map:  16%|█▋        | 165/1000 [00:04<00:08, 95.12 examples/s]
Map:  18%|█▊        | 175/1000 [00:04<00:08, 93.57 examples/s]
Map:  18%|█▊        | 185/1000 [00:04<00:08, 93.68 examples/s]
Map:  20%|█▉        | 196/1000 [00:04<00:08, 96.51 examples/s]
Map:  21%|██        | 207/1000 [00:04<00:08, 96.78 examples/s]
Map:  22%|██▏       | 221/1000 [00:04<00:07, 106.42 examples/s]
Map:  23%|██▎       | 233/1000 [00:04<00:07, 105.98 examples/s]
Map:  24%|██▍       | 244/1000 [00:04<00:07, 105.04 examples/s]
Map:  26%|██▌       | 256/1000 [00:05<00:07, 103.91 examples/s]
Map:  27%|██▋       | 268/1000 [00:05<00:06, 106.51 examples/s]
Map:  28%|██▊       | 280/1000 [00:05<00:06, 105.58 examples/s]
Map:  29%|██▉       | 293/1000 [00:05<00:06, 108.86 examples/s]
Map:  30%|███       | 305/1000 [00:05<00:06, 108.57 examples/s]
Map:  32%|███▏      | 318/1000 [00:05<00:06, 111.56 examples/s]
Map:  33%|███▎      | 331/1000 [00:05<00:05, 115.47 examples/s]
Map:  34%|███▍      | 343/1000 [00:05<00:05, 112.81 examples/s]
Map:  36%|███▌      | 357/1000 [00:05<00:05, 119.72 examples/s]
Map:  37%|███▋      | 370/1000 [00:06<00:05, 118.97 examples/s]
Map:  38%|███▊      | 382/1000 [00:06<00:05, 117.66 examples/s]
Map:  40%|████      | 400/1000 [00:06<00:05, 113.24 examples/s]
Map:  41%|████      | 412/1000 [00:06<00:05, 112.44 examples/s]
Map:  43%|████▎     | 427/1000 [00:06<00:04, 118.17 examples/s]
Map:  44%|████▍     | 439/1000 [00:06<00:04, 116.70 examples/s]
Map:  45%|████▌     | 452/1000 [00:06<00:04, 117.23 examples/s]
Map:  46%|████▋     | 465/1000 [00:06<00:04, 117.43 examples/s]
Map:  48%|████▊     | 477/1000 [00:07<00:04, 116.42 examples/s]
Map:  49%|████▉     | 489/1000 [00:07<00:04, 116.22 examples/s]
Map:  50%|█████     | 501/1000 [00:07<00:04, 114.79 examples/s]
Map:  52%|█████▏    | 516/1000 [00:07<00:04, 120.10 examples/s]
Map:  53%|█████▎    | 529/1000 [00:07<00:03, 120.25 examples/s]
Map:  54%|█████▍    | 542/1000 [00:07<00:03, 121.15 examples/s]
Map:  56%|█████▌    | 556/1000 [00:07<00:03, 121.71 examples/s]
Map:  57%|█████▋    | 569/1000 [00:07<00:03, 121.41 examples/s]
Map:  58%|█████▊    | 582/1000 [00:07<00:03, 120.15 examples/s]
Map:  60%|█████▉    | 596/1000 [00:08<00:03, 122.37 examples/s]
Map:  61%|██████    | 610/1000 [00:08<00:03, 122.76 examples/s]
Map:  62%|██████▎   | 625/1000 [00:08<00:02, 126.95 examples/s]
Map:  64%|██████▍   | 638/1000 [00:08<00:02, 124.68 examples/s]
Map:  66%|██████▌   | 657/1000 [00:08<00:02, 123.91 examples/s]
Map:  67%|██████▋   | 670/1000 [00:08<00:02, 125.08 examples/s]
Map:  68%|██████▊   | 683/1000 [00:08<00:02, 124.27 examples/s]
Map:  70%|██████▉   | 697/1000 [00:08<00:02, 127.20 examples/s]
Map:  71%|███████   | 711/1000 [00:08<00:02, 125.84 examples/s]
Map:  72%|███████▏  | 724/1000 [00:09<00:02, 125.31 examples/s]
Map:  74%|███████▍  | 742/1000 [00:09<00:02, 119.33 examples/s]
Map:  76%|███████▌  | 755/1000 [00:09<00:02, 121.66 examples/s]
Map:  77%|███████▋  | 773/1000 [00:09<00:01, 117.18 examples/s]
Map:  79%|███████▉  | 788/1000 [00:09<00:01, 123.92 examples/s]
Map:  81%|████████  | 807/1000 [00:09<00:01, 122.25 examples/s]
Map:  83%|████████▎ | 827/1000 [00:09<00:01, 123.57 examples/s]
Map:  84%|████████▍ | 842/1000 [00:09<00:01, 124.02 examples/s]
Map:  86%|████████▌ | 857/1000 [00:10<00:01, 126.85 examples/s]
Map:  87%|████████▋ | 872/1000 [00:10<00:00, 130.82 examples/s]
Map:  89%|████████▊ | 887/1000 [00:10<00:00, 132.55 examples/s]
Map:  91%|█████████ | 907/1000 [00:10<00:00, 128.56 examples/s]
Map:  92%|█████████▏| 923/1000 [00:10<00:00, 132.89 examples/s]
Map:  94%|█████████▍| 938/1000 [00:10<00:00, 133.68 examples/s]
Map:  96%|█████████▌| 955/1000 [00:10<00:00, 139.56 examples/s]
Map:  97%|█████████▋| 973/1000 [00:10<00:00, 149.65 examples/s]
Map:  99%|█████████▉| 990/1000 [00:11<00:00, 153.35 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 43646.11it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  33%|███▎      | 330/1000 [00:00<00:00, 3295.77it/s]
Logging series metrics to wandb:  67%|██████▋   | 670/1000 [00:00<00:00, 3354.26it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3343.28it/s]
2024-01-10 18:53:53.256323: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:53:53.308166: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:53:53.308225: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:53:53.309397: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:53:53.316825: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:53:54.594378: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62612.77lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:30,  1.53s/ examples]
Map:   1%|          | 7/1000 [00:01<02:56,  5.62 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:27, 11.30 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:49, 19.77 examples/s]
Map:   3%|▎         | 29/1000 [00:01<00:33, 28.84 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:25, 37.10 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:44, 21.29 examples/s]
Map:   5%|▌         | 54/1000 [00:02<00:33, 28.65 examples/s]
Map:   6%|▋         | 63/1000 [00:02<00:25, 37.14 examples/s]
Map:   7%|▋         | 73/1000 [00:03<00:19, 46.39 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:17, 52.10 examples/s]
Map:   9%|▉         | 91/1000 [00:03<00:15, 60.32 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:13, 66.57 examples/s]
Map:  11%|█         | 111/1000 [00:03<00:12, 71.13 examples/s]
Map:  12%|█▏        | 121/1000 [00:03<00:11, 74.84 examples/s]
Map:  13%|█▎        | 132/1000 [00:03<00:10, 81.96 examples/s]
Map:  14%|█▍        | 143/1000 [00:03<00:09, 87.59 examples/s]
Map:  16%|█▌        | 157/1000 [00:04<00:09, 87.69 examples/s]
Map:  17%|█▋        | 168/1000 [00:04<00:09, 90.87 examples/s]
Map:  18%|█▊        | 178/1000 [00:04<00:09, 90.09 examples/s]
Map:  19%|█▉        | 189/1000 [00:04<00:08, 92.89 examples/s]
Map:  20%|█▉        | 199/1000 [00:04<00:08, 90.96 examples/s]
Map:  21%|██        | 210/1000 [00:04<00:08, 95.57 examples/s]
Map:  22%|██▏       | 223/1000 [00:04<00:07, 101.41 examples/s]
Map:  24%|██▎       | 236/1000 [00:04<00:07, 105.67 examples/s]
Map:  25%|██▍       | 248/1000 [00:04<00:07, 106.22 examples/s]
Map:  26%|██▌       | 262/1000 [00:05<00:06, 113.86 examples/s]
Map:  28%|██▊       | 276/1000 [00:05<00:06, 119.73 examples/s]
Map:  29%|██▉       | 291/1000 [00:05<00:05, 124.62 examples/s]
Map:  30%|███       | 305/1000 [00:05<00:05, 127.47 examples/s]
Map:  32%|███▏      | 322/1000 [00:05<00:04, 136.60 examples/s]
Map:  34%|███▍      | 338/1000 [00:05<00:04, 139.37 examples/s]
Map:  36%|███▌      | 356/1000 [00:05<00:05, 128.69 examples/s]
Map:  37%|███▋      | 371/1000 [00:05<00:04, 133.22 examples/s]
Map:  39%|███▊      | 386/1000 [00:05<00:04, 136.53 examples/s]
Map:  40%|████      | 401/1000 [00:06<00:04, 137.49 examples/s]
Map:  42%|████▏     | 416/1000 [00:06<00:04, 137.45 examples/s]
Map:  43%|████▎     | 431/1000 [00:06<00:04, 140.00 examples/s]
Map:  45%|████▍     | 446/1000 [00:06<00:03, 139.79 examples/s]
Map:  46%|████▋     | 464/1000 [00:06<00:03, 147.47 examples/s]
Map:  48%|████▊     | 479/1000 [00:06<00:03, 145.20 examples/s]
Map:  49%|████▉     | 494/1000 [00:06<00:03, 143.82 examples/s]
Map:  51%|█████     | 511/1000 [00:06<00:03, 147.44 examples/s]
Map:  53%|█████▎    | 528/1000 [00:06<00:03, 150.25 examples/s]
Map:  54%|█████▍    | 544/1000 [00:07<00:03, 149.37 examples/s]
Map:  56%|█████▌    | 559/1000 [00:07<00:03, 146.59 examples/s]
Map:  58%|█████▊    | 581/1000 [00:07<00:02, 143.00 examples/s]
Map:  60%|█████▉    | 598/1000 [00:07<00:02, 147.31 examples/s]
Map:  61%|██████▏   | 614/1000 [00:07<00:02, 147.14 examples/s]
Map:  63%|██████▎   | 632/1000 [00:07<00:02, 152.29 examples/s]
Map:  65%|██████▍   | 648/1000 [00:07<00:02, 151.41 examples/s]
Map:  67%|██████▋   | 667/1000 [00:07<00:02, 157.30 examples/s]
Map:  68%|██████▊   | 683/1000 [00:07<00:02, 155.05 examples/s]
Map:  70%|███████   | 701/1000 [00:08<00:01, 160.42 examples/s]
Map:  72%|███████▎  | 725/1000 [00:08<00:01, 157.87 examples/s]
Map:  74%|███████▍  | 741/1000 [00:08<00:01, 154.21 examples/s]
Map:  76%|███████▌  | 758/1000 [00:08<00:01, 157.33 examples/s]
Map:  78%|███████▊  | 782/1000 [00:08<00:01, 152.81 examples/s]
Map:  80%|████████  | 800/1000 [00:08<00:01, 154.94 examples/s]
Map:  82%|████████▏ | 816/1000 [00:08<00:01, 154.55 examples/s]
Map:  83%|████████▎ | 832/1000 [00:08<00:01, 155.67 examples/s]
Map:  85%|████████▍ | 848/1000 [00:09<00:00, 156.16 examples/s]
Map:  87%|████████▋ | 867/1000 [00:09<00:00, 164.15 examples/s]
Map:  89%|████████▉ | 892/1000 [00:09<00:00, 160.96 examples/s]
Map:  91%|█████████ | 909/1000 [00:09<00:00, 161.36 examples/s]
Map:  93%|█████████▎| 928/1000 [00:09<00:00, 164.05 examples/s]
Map:  94%|█████████▍| 945/1000 [00:09<00:00, 162.48 examples/s]
Map:  96%|█████████▋| 964/1000 [00:09<00:00, 166.41 examples/s]
Map:  98%|█████████▊| 982/1000 [00:09<00:00, 168.67 examples/s]
Map: 100%|█████████▉| 999/1000 [00:09<00:00, 163.19 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 42076.42it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  34%|███▍      | 345/1000 [00:00<00:00, 3446.77it/s]
Logging series metrics to wandb:  69%|██████▉   | 690/1000 [00:00<00:00, 3405.17it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3348.23it/s]
2024-01-10 18:54:37.484121: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:54:37.531848: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:54:37.531914: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:54:37.533056: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:54:37.540965: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:54:38.791750: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60129.94lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<26:33,  1.60s/ examples]
Map:   1%|          | 7/1000 [00:01<03:03,  5.41 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:30, 10.95 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:51, 19.06 examples/s]
Map:   3%|▎         | 29/1000 [00:02<00:34, 28.02 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:26, 36.52 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:45, 21.05 examples/s]
Map:   5%|▌         | 54/1000 [00:02<00:33, 28.39 examples/s]
Map:   6%|▋         | 64/1000 [00:03<00:24, 37.94 examples/s]
Map:   7%|▋         | 73/1000 [00:03<00:20, 46.14 examples/s]
Map:   8%|▊         | 83/1000 [00:03<00:16, 54.81 examples/s]
Map:   9%|▉         | 92/1000 [00:03<00:14, 61.36 examples/s]
Map:  10%|█         | 102/1000 [00:03<00:13, 68.00 examples/s]
Map:  11%|█         | 111/1000 [00:03<00:12, 71.73 examples/s]
Map:  12%|█▏        | 121/1000 [00:03<00:11, 76.69 examples/s]
Map:  13%|█▎        | 132/1000 [00:03<00:10, 83.36 examples/s]
Map:  14%|█▍        | 143/1000 [00:03<00:09, 87.91 examples/s]
Map:  15%|█▌        | 153/1000 [00:04<00:09, 89.27 examples/s]
Map:  16%|█▋        | 164/1000 [00:04<00:09, 91.71 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:09, 91.08 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 92.42 examples/s]
Map:  20%|█▉        | 195/1000 [00:04<00:08, 95.26 examples/s]
Map:  20%|██        | 205/1000 [00:04<00:09, 81.58 examples/s]
Map:  22%|██▏       | 215/1000 [00:04<00:09, 83.14 examples/s]
Map:  23%|██▎       | 226/1000 [00:04<00:10, 76.75 examples/s]
Map:  24%|██▎       | 236/1000 [00:05<00:09, 80.74 examples/s]
Map:  25%|██▍       | 248/1000 [00:05<00:08, 88.40 examples/s]
Map:  26%|██▌       | 259/1000 [00:05<00:08, 91.38 examples/s]
Map:  27%|██▋       | 270/1000 [00:05<00:07, 95.76 examples/s]
Map:  28%|██▊       | 281/1000 [00:05<00:07, 97.62 examples/s]
Map:  29%|██▉       | 293/1000 [00:05<00:07, 100.54 examples/s]
Map:  30%|███       | 305/1000 [00:05<00:06, 101.57 examples/s]
Map:  32%|███▏      | 317/1000 [00:05<00:06, 105.75 examples/s]
Map:  33%|███▎      | 330/1000 [00:05<00:06, 110.34 examples/s]
Map:  35%|███▍      | 347/1000 [00:06<00:06, 108.46 examples/s]
Map:  36%|███▌      | 360/1000 [00:06<00:05, 110.94 examples/s]
Map:  37%|███▋      | 372/1000 [00:06<00:05, 109.93 examples/s]
Map:  38%|███▊      | 384/1000 [00:06<00:05, 109.41 examples/s]
Map:  40%|███▉      | 395/1000 [00:06<00:05, 108.04 examples/s]
Map:  41%|████      | 408/1000 [00:06<00:05, 109.39 examples/s]
Map:  42%|████▏     | 423/1000 [00:06<00:05, 115.20 examples/s]
Map:  44%|████▍     | 440/1000 [00:06<00:04, 112.13 examples/s]
Map:  45%|████▌     | 452/1000 [00:07<00:04, 113.88 examples/s]
Map:  46%|████▋     | 464/1000 [00:07<00:04, 113.33 examples/s]
Map:  48%|████▊     | 477/1000 [00:07<00:04, 113.37 examples/s]
Map:  49%|████▉     | 490/1000 [00:07<00:04, 113.95 examples/s]
Map:  50%|█████     | 504/1000 [00:07<00:04, 116.56 examples/s]
Map:  52%|█████▏    | 519/1000 [00:07<00:03, 120.93 examples/s]
Map:  53%|█████▎    | 532/1000 [00:07<00:03, 122.01 examples/s]
Map:  55%|█████▌    | 551/1000 [00:07<00:03, 119.66 examples/s]
Map:  57%|█████▋    | 569/1000 [00:08<00:03, 116.81 examples/s]
Map:  58%|█████▊    | 582/1000 [00:08<00:03, 116.62 examples/s]
Map:  60%|█████▉    | 596/1000 [00:08<00:03, 117.67 examples/s]
Map:  61%|██████    | 608/1000 [00:08<00:03, 115.88 examples/s]
Map:  62%|██████▏   | 623/1000 [00:08<00:03, 120.85 examples/s]
Map:  64%|██████▍   | 641/1000 [00:08<00:03, 116.74 examples/s]
Map:  66%|██████▌   | 655/1000 [00:08<00:02, 118.92 examples/s]
Map:  67%|██████▋   | 670/1000 [00:08<00:02, 123.60 examples/s]
Map:  68%|██████▊   | 684/1000 [00:08<00:02, 125.37 examples/s]
Map:  70%|██████▉   | 697/1000 [00:09<00:02, 124.19 examples/s]
Map:  71%|███████   | 710/1000 [00:09<00:02, 124.27 examples/s]
Map:  72%|███████▏  | 723/1000 [00:09<00:02, 123.12 examples/s]
Map:  74%|███████▎  | 736/1000 [00:09<00:02, 119.68 examples/s]
Map:  75%|███████▍  | 748/1000 [00:09<00:02, 118.36 examples/s]
Map:  76%|███████▌  | 761/1000 [00:09<00:02, 118.45 examples/s]
Map:  78%|███████▊  | 775/1000 [00:09<00:01, 122.85 examples/s]
Map:  79%|███████▉  | 793/1000 [00:09<00:01, 138.59 examples/s]
Map:  81%|████████  | 808/1000 [00:09<00:01, 139.19 examples/s]
Map:  82%|████████▏ | 824/1000 [00:10<00:01, 142.62 examples/s]
Map:  84%|████████▍ | 841/1000 [00:10<00:01, 148.61 examples/s]
Map:  86%|████████▌ | 862/1000 [00:10<00:00, 161.06 examples/s]
Map:  88%|████████▊ | 879/1000 [00:10<00:00, 158.85 examples/s]
Map:  90%|████████▉ | 897/1000 [00:10<00:00, 162.10 examples/s]
Map:  92%|█████████▏| 916/1000 [00:10<00:00, 166.51 examples/s]
Map:  93%|█████████▎| 933/1000 [00:10<00:00, 163.81 examples/s]
Map:  95%|█████████▌| 951/1000 [00:10<00:00, 165.14 examples/s]
Map:  98%|█████████▊| 976/1000 [00:10<00:00, 163.90 examples/s]
Map:  99%|█████████▉| 994/1000 [00:11<00:00, 164.80 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 30317.71it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 323/1000 [00:00<00:00, 3229.12it/s]
Logging series metrics to wandb:  65%|██████▍   | 646/1000 [00:00<00:00, 3085.55it/s]
Logging series metrics to wandb:  99%|█████████▉| 994/1000 [00:00<00:00, 3260.61it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3223.97it/s]
2024-01-10 18:55:23.065194: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:55:23.114292: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:55:23.114348: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:55:23.115443: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:55:23.122101: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:55:24.359459: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60913.26lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:03,  1.51s/ examples]
Map:   1%|          | 7/1000 [00:01<02:54,  5.71 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:26, 11.43 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:49, 19.86 examples/s]
Map:   3%|▎         | 29/1000 [00:01<00:33, 28.91 examples/s]
Map:   4%|▎         | 36/1000 [00:02<00:26, 35.97 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:48, 19.49 examples/s]
Map:   5%|▌         | 54/1000 [00:02<00:35, 26.36 examples/s]
Map:   6%|▋         | 63/1000 [00:03<00:27, 34.32 examples/s]
Map:   7%|▋         | 72/1000 [00:03<00:21, 42.34 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:18, 49.06 examples/s]
Map:   9%|▉         | 91/1000 [00:03<00:15, 57.72 examples/s]
Map:  10%|█         | 100/1000 [00:03<00:14, 63.18 examples/s]
Map:  11%|█         | 110/1000 [00:03<00:12, 69.06 examples/s]
Map:  12%|█▏        | 120/1000 [00:03<00:11, 75.88 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:11, 78.82 examples/s]
Map:  14%|█▍        | 143/1000 [00:04<00:09, 88.69 examples/s]
Map:  15%|█▌        | 154/1000 [00:04<00:09, 88.93 examples/s]
Map:  16%|█▋        | 164/1000 [00:04<00:09, 90.72 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:09, 90.33 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:09, 90.01 examples/s]
Map:  20%|█▉        | 195/1000 [00:04<00:08, 92.01 examples/s]
Map:  21%|██        | 206/1000 [00:04<00:08, 92.37 examples/s]
Map:  22%|██▏       | 219/1000 [00:04<00:07, 100.22 examples/s]
Map:  23%|██▎       | 232/1000 [00:04<00:07, 105.56 examples/s]
Map:  24%|██▍       | 244/1000 [00:05<00:07, 104.72 examples/s]
Map:  26%|██▌       | 255/1000 [00:05<00:07, 104.58 examples/s]
Map:  27%|██▋       | 266/1000 [00:05<00:06, 104.94 examples/s]
Map:  28%|██▊       | 278/1000 [00:05<00:06, 105.79 examples/s]
Map:  30%|██▉       | 295/1000 [00:05<00:06, 107.86 examples/s]
Map:  31%|███       | 312/1000 [00:05<00:06, 107.32 examples/s]
Map:  32%|███▎      | 325/1000 [00:05<00:06, 109.94 examples/s]
Map:  34%|███▎      | 337/1000 [00:05<00:06, 107.84 examples/s]
Map:  35%|███▍      | 349/1000 [00:05<00:05, 108.62 examples/s]
Map:  36%|███▌      | 361/1000 [00:06<00:05, 110.32 examples/s]
Map:  38%|███▊      | 378/1000 [00:06<00:05, 107.71 examples/s]
Map:  39%|███▉      | 390/1000 [00:06<00:05, 103.96 examples/s]
Map:  40%|████      | 404/1000 [00:06<00:05, 110.91 examples/s]
Map:  42%|████▏     | 420/1000 [00:06<00:04, 121.79 examples/s]
Map:  43%|████▎     | 434/1000 [00:06<00:04, 124.81 examples/s]
Map:  45%|████▍     | 449/1000 [00:06<00:04, 130.17 examples/s]
Map:  47%|████▋     | 467/1000 [00:06<00:03, 141.34 examples/s]
Map:  48%|████▊     | 483/1000 [00:07<00:03, 144.29 examples/s]
Map:  50%|████▉     | 498/1000 [00:07<00:03, 142.02 examples/s]
Map:  52%|█████▏    | 516/1000 [00:07<00:03, 148.47 examples/s]
Map:  53%|█████▎    | 533/1000 [00:07<00:03, 150.94 examples/s]
Map:  55%|█████▍    | 549/1000 [00:07<00:03, 150.08 examples/s]
Map:  57%|█████▋    | 570/1000 [00:07<00:03, 141.83 examples/s]
Map:  59%|█████▊    | 586/1000 [00:07<00:02, 144.02 examples/s]
Map:  60%|██████    | 602/1000 [00:07<00:02, 144.08 examples/s]
Map:  62%|██████▏   | 620/1000 [00:07<00:02, 150.45 examples/s]
Map:  64%|██████▎   | 636/1000 [00:08<00:02, 148.65 examples/s]
Map:  65%|██████▌   | 653/1000 [00:08<00:02, 151.60 examples/s]
Map:  67%|██████▋   | 671/1000 [00:08<00:02, 156.70 examples/s]
Map:  69%|██████▉   | 688/1000 [00:08<00:01, 158.09 examples/s]
Map:  70%|███████   | 704/1000 [00:08<00:01, 155.81 examples/s]
Map:  72%|███████▏  | 720/1000 [00:08<00:01, 154.87 examples/s]
Map:  74%|███████▎  | 736/1000 [00:08<00:01, 152.97 examples/s]
Map:  76%|███████▌  | 755/1000 [00:08<00:01, 160.27 examples/s]
Map:  78%|███████▊  | 777/1000 [00:08<00:01, 154.15 examples/s]
Map:  80%|███████▉  | 795/1000 [00:09<00:01, 158.92 examples/s]
Map:  81%|████████  | 812/1000 [00:09<00:01, 157.40 examples/s]
Map:  83%|████████▎ | 829/1000 [00:09<00:01, 156.24 examples/s]
Map:  84%|████████▍ | 845/1000 [00:09<00:00, 156.34 examples/s]
Map:  86%|████████▋ | 865/1000 [00:09<00:00, 165.31 examples/s]
Map:  89%|████████▊ | 887/1000 [00:09<00:00, 136.80 examples/s]
Map:  90%|█████████ | 903/1000 [00:09<00:00, 140.45 examples/s]
Map:  92%|█████████▏| 922/1000 [00:09<00:00, 149.26 examples/s]
Map:  94%|█████████▍| 941/1000 [00:10<00:00, 156.60 examples/s]
Map:  96%|█████████▌| 959/1000 [00:10<00:00, 159.93 examples/s]
Map:  98%|█████████▊| 977/1000 [00:10<00:00, 162.02 examples/s]
Map: 100%|█████████▉| 998/1000 [00:10<00:00, 170.74 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 30666.17it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  39%|███▊      | 387/1000 [00:00<00:00, 3858.87it/s]
Logging series metrics to wandb:  77%|███████▋  | 773/1000 [00:00<00:00, 3755.17it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3751.11it/s]
2024-01-10 18:56:09.382638: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:56:09.432611: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:56:09.432690: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:56:09.433971: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:56:09.440977: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:56:10.694112: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56959.97lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<24:19,  1.46s/ examples]
Map:   1%|          | 7/1000 [00:01<02:49,  5.87 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:24, 11.63 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:49, 19.96 examples/s]
Map:   3%|▎         | 30/1000 [00:01<00:32, 30.25 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:26, 36.74 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:42, 22.39 examples/s]
Map:   5%|▌         | 53/1000 [00:02<00:32, 29.30 examples/s]
Map:   6%|▋         | 63/1000 [00:02<00:24, 38.76 examples/s]
Map:   7%|▋         | 73/1000 [00:03<00:19, 48.26 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:17, 53.90 examples/s]
Map:   9%|▉         | 91/1000 [00:03<00:14, 61.97 examples/s]
Map:  10%|█         | 100/1000 [00:03<00:13, 67.00 examples/s]
Map:  11%|█         | 109/1000 [00:03<00:12, 72.00 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:11, 77.41 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:10, 80.89 examples/s]
Map:  14%|█▍        | 143/1000 [00:03<00:09, 91.16 examples/s]
Map:  15%|█▌        | 154/1000 [00:03<00:09, 91.79 examples/s]
Map:  16%|█▋        | 164/1000 [00:03<00:08, 93.47 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:08, 94.16 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 95.53 examples/s]
Map:  20%|█▉        | 196/1000 [00:04<00:08, 97.80 examples/s]
Map:  21%|██        | 207/1000 [00:04<00:08, 96.39 examples/s]
Map:  22%|██▏       | 221/1000 [00:04<00:07, 104.90 examples/s]
Map:  23%|██▎       | 234/1000 [00:04<00:07, 108.11 examples/s]
Map:  25%|██▍       | 246/1000 [00:04<00:07, 106.81 examples/s]
Map:  26%|██▌       | 257/1000 [00:04<00:06, 106.39 examples/s]
Map:  27%|██▋       | 269/1000 [00:04<00:06, 106.85 examples/s]
Map:  28%|██▊       | 281/1000 [00:05<00:06, 107.45 examples/s]
Map:  29%|██▉       | 294/1000 [00:05<00:06, 110.06 examples/s]
Map:  31%|███       | 312/1000 [00:05<00:06, 109.47 examples/s]
Map:  32%|███▎      | 325/1000 [00:05<00:05, 112.70 examples/s]
Map:  34%|███▍      | 342/1000 [00:05<00:05, 111.43 examples/s]
Map:  36%|███▌      | 357/1000 [00:05<00:05, 116.96 examples/s]
Map:  37%|███▋      | 369/1000 [00:05<00:05, 115.99 examples/s]
Map:  38%|███▊      | 381/1000 [00:05<00:05, 114.34 examples/s]
Map:  40%|███▉      | 397/1000 [00:06<00:05, 110.60 examples/s]
Map:  41%|████      | 410/1000 [00:06<00:05, 111.80 examples/s]
Map:  42%|████▎     | 425/1000 [00:06<00:04, 118.90 examples/s]
Map:  44%|████▍     | 443/1000 [00:06<00:04, 113.84 examples/s]
Map:  46%|████▌     | 457/1000 [00:06<00:04, 118.17 examples/s]
Map:  47%|████▋     | 470/1000 [00:06<00:04, 117.90 examples/s]
Map:  48%|████▊     | 484/1000 [00:06<00:04, 118.52 examples/s]
Map:  50%|████▉     | 499/1000 [00:06<00:03, 125.70 examples/s]
Map:  52%|█████▏    | 515/1000 [00:07<00:03, 133.37 examples/s]
Map:  53%|█████▎    | 530/1000 [00:07<00:03, 135.32 examples/s]
Map:  55%|█████▌    | 551/1000 [00:07<00:03, 131.09 examples/s]
Map:  57%|█████▋    | 568/1000 [00:07<00:03, 137.21 examples/s]
Map:  58%|█████▊    | 583/1000 [00:07<00:02, 139.69 examples/s]
Map:  60%|██████    | 600/1000 [00:07<00:02, 145.43 examples/s]
Map:  62%|██████▏   | 617/1000 [00:07<00:02, 151.21 examples/s]
Map:  63%|██████▎   | 634/1000 [00:07<00:02, 152.14 examples/s]
Map:  65%|██████▌   | 651/1000 [00:07<00:02, 155.78 examples/s]
Map:  67%|██████▋   | 670/1000 [00:08<00:02, 161.35 examples/s]
Map:  69%|██████▉   | 690/1000 [00:08<00:01, 167.93 examples/s]
Map:  71%|███████   | 708/1000 [00:08<00:01, 165.44 examples/s]
Map:  73%|███████▎  | 732/1000 [00:08<00:01, 160.24 examples/s]
Map:  76%|███████▌  | 758/1000 [00:08<00:01, 160.28 examples/s]
Map:  78%|███████▊  | 781/1000 [00:08<00:01, 155.89 examples/s]
Map:  80%|███████▉  | 798/1000 [00:08<00:01, 158.41 examples/s]
Map:  81%|████████▏ | 814/1000 [00:08<00:01, 156.96 examples/s]
Map:  83%|████████▎ | 831/1000 [00:09<00:01, 158.20 examples/s]
Map:  85%|████████▍ | 849/1000 [00:09<00:00, 161.20 examples/s]
Map:  87%|████████▋ | 868/1000 [00:09<00:00, 167.26 examples/s]
Map:  89%|████████▉ | 892/1000 [00:09<00:00, 162.55 examples/s]
Map:  92%|█████████▏| 918/1000 [00:09<00:00, 164.95 examples/s]
Map:  94%|█████████▎| 936/1000 [00:09<00:00, 163.58 examples/s]
Map:  95%|█████████▌| 954/1000 [00:09<00:00, 166.97 examples/s]
Map:  97%|█████████▋| 971/1000 [00:09<00:00, 162.73 examples/s]
Map:  99%|█████████▉| 989/1000 [00:10<00:00, 164.57 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 28271.70it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  33%|███▎      | 328/1000 [00:00<00:00, 3267.53it/s]
Logging series metrics to wandb:  66%|██████▌   | 655/1000 [00:00<00:00, 2839.72it/s]
Logging series metrics to wandb:  95%|█████████▍| 947/1000 [00:00<00:00, 2872.22it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2921.12it/s]
2024-01-10 18:56:53.467461: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:56:53.560086: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:56:53.560184: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:56:53.562226: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:56:53.574690: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:56:55.066549: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64252.95lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 19/1000 [00:00<00:05, 178.16 examples/s]
Map:   4%|▍         | 38/1000 [00:00<00:05, 183.62 examples/s]
Map:   6%|▌         | 58/1000 [00:00<00:05, 185.01 examples/s]
Map:   8%|▊         | 78/1000 [00:00<00:04, 185.80 examples/s]
Map:  10%|█         | 105/1000 [00:00<00:04, 181.35 examples/s]
Map:  13%|█▎        | 126/1000 [00:00<00:04, 186.27 examples/s]
Map:  15%|█▍        | 147/1000 [00:00<00:04, 191.43 examples/s]
Map:  17%|█▋        | 167/1000 [00:00<00:04, 190.67 examples/s]
Map:  19%|█▉        | 188/1000 [00:00<00:04, 192.23 examples/s]
Map:  21%|██        | 208/1000 [00:01<00:04, 188.95 examples/s]
Map:  23%|██▎       | 233/1000 [00:01<00:03, 202.09 examples/s]
Map:  26%|██▋       | 264/1000 [00:01<00:03, 199.73 examples/s]
Map:  28%|██▊       | 285/1000 [00:01<00:03, 198.87 examples/s]
Map:  31%|███       | 307/1000 [00:01<00:03, 199.94 examples/s]
Map:  33%|███▎      | 329/1000 [00:01<00:03, 202.41 examples/s]
Map:  36%|███▌      | 359/1000 [00:01<00:03, 198.14 examples/s]
Map:  39%|███▉      | 389/1000 [00:02<00:03, 195.38 examples/s]
Map:  41%|████      | 409/1000 [00:02<00:03, 194.81 examples/s]
Map:  43%|████▎     | 431/1000 [00:02<00:02, 196.66 examples/s]
Map:  45%|████▌     | 452/1000 [00:02<00:02, 198.50 examples/s]
Map:  47%|████▋     | 473/1000 [00:02<00:02, 197.12 examples/s]
Map:  49%|████▉     | 493/1000 [00:02<00:02, 193.65 examples/s]
Map:  51%|█████▏    | 513/1000 [00:02<00:02, 194.64 examples/s]
Map:  53%|█████▎    | 534/1000 [00:02<00:02, 198.08 examples/s]
Map:  55%|█████▌    | 554/1000 [00:02<00:02, 193.69 examples/s]
Map:  58%|█████▊    | 583/1000 [00:03<00:02, 190.32 examples/s]
Map:  60%|██████    | 603/1000 [00:03<00:02, 191.07 examples/s]
Map:  62%|██████▎   | 625/1000 [00:03<00:01, 196.56 examples/s]
Map:  64%|██████▍   | 645/1000 [00:03<00:01, 193.96 examples/s]
Map:  67%|██████▋   | 667/1000 [00:03<00:01, 199.17 examples/s]
Map:  69%|██████▉   | 688/1000 [00:03<00:01, 200.28 examples/s]
Map:  72%|███████▏  | 717/1000 [00:03<00:01, 194.78 examples/s]
Map:  74%|███████▎  | 737/1000 [00:03<00:01, 192.25 examples/s]
Map:  76%|███████▌  | 757/1000 [00:03<00:01, 192.74 examples/s]
Map:  79%|███████▊  | 786/1000 [00:04<00:01, 189.82 examples/s]
Map:  81%|████████  | 806/1000 [00:04<00:01, 189.69 examples/s]
Map:  83%|████████▎ | 826/1000 [00:04<00:00, 189.28 examples/s]
Map:  85%|████████▍ | 846/1000 [00:04<00:00, 188.99 examples/s]
Map:  87%|████████▋ | 868/1000 [00:04<00:00, 194.39 examples/s]
Map:  89%|████████▉ | 888/1000 [00:04<00:00, 193.37 examples/s]
Map:  92%|█████████▏| 919/1000 [00:04<00:00, 193.53 examples/s]
Map:  94%|█████████▍| 939/1000 [00:04<00:00, 192.96 examples/s]
Map:  96%|█████████▌| 960/1000 [00:04<00:00, 194.52 examples/s]
Map:  99%|█████████▊| 987/1000 [00:05<00:00, 183.50 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 33171.50it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 272/1000 [00:00<00:00, 2718.95it/s]
Logging series metrics to wandb:  54%|█████▍    | 544/1000 [00:00<00:00, 2703.22it/s]
Logging series metrics to wandb:  82%|████████▏ | 818/1000 [00:00<00:00, 2717.76it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2721.54it/s]
2024-01-10 18:57:32.775359: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:57:32.822577: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:57:32.822634: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:57:32.823804: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:57:32.830769: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:57:34.184944: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60509.02lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  13%|█▎        | 129/1000 [00:00<00:00, 1267.82 examples/s]
Map:  27%|██▋       | 268/1000 [00:00<00:00, 1330.97 examples/s]
Map:  40%|████      | 403/1000 [00:00<00:00, 1080.80 examples/s]
Map:  55%|█████▌    | 550/1000 [00:00<00:00, 1212.13 examples/s]
Map:  69%|██████▉   | 694/1000 [00:00<00:00, 1273.74 examples/s]
Map:  84%|████████▎ | 837/1000 [00:00<00:00, 1320.57 examples/s]
Map:  98%|█████████▊| 982/1000 [00:00<00:00, 1355.77 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 36318.72it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  22%|██▏       | 220/1000 [00:00<00:00, 2195.23it/s]
Logging series metrics to wandb:  45%|████▍     | 449/1000 [00:00<00:00, 2246.47it/s]
Logging series metrics to wandb:  67%|██████▋   | 674/1000 [00:00<00:00, 1900.96it/s]
Logging series metrics to wandb:  94%|█████████▎| 935/1000 [00:00<00:00, 2149.91it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2152.46it/s]
2024-01-10 18:58:09.657749: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:58:09.716738: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:58:09.716812: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:58:09.718537: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:58:09.726937: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:58:11.186680: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 66916.15lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  16%|█▌        | 158/1000 [00:00<00:00, 1561.45 examples/s]
Map:  33%|███▎      | 331/1000 [00:00<00:00, 1655.85 examples/s]
Map:  50%|█████     | 502/1000 [00:00<00:00, 1676.47 examples/s]
Map:  74%|███████▍  | 742/1000 [00:00<00:00, 1632.52 examples/s]
Map:  99%|█████████▉| 990/1000 [00:00<00:00, 1638.51 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35777.81it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 275/1000 [00:00<00:00, 2744.23it/s]
Logging series metrics to wandb:  56%|█████▌    | 562/1000 [00:00<00:00, 2812.87it/s]
Logging series metrics to wandb:  84%|████████▍ | 844/1000 [00:00<00:00, 2813.80it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2815.91it/s]
2024-01-10 18:58:45.989728: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:58:46.039684: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:58:46.039748: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:58:46.040858: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:58:46.047505: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:58:47.393401: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65763.09lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  22%|██▏       | 217/1000 [00:00<00:00, 2140.50 examples/s]
Map:  46%|████▋     | 464/1000 [00:00<00:00, 2311.84 examples/s]
Map:  71%|███████   | 706/1000 [00:00<00:00, 2358.09 examples/s]
Map:  96%|█████████▌| 955/1000 [00:00<00:00, 2403.45 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 33876.94it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 274/1000 [00:00<00:00, 2738.96it/s]
Logging series metrics to wandb:  55%|█████▌    | 552/1000 [00:00<00:00, 2758.35it/s]
Logging series metrics to wandb:  83%|████████▎ | 828/1000 [00:00<00:00, 2731.49it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2694.41it/s]
2024-01-10 18:59:21.030387: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:59:21.084985: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:59:21.085061: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:59:21.086534: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:59:21.095387: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:59:22.583067: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63339.89lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  20%|██        | 205/1000 [00:00<00:00, 2028.53 examples/s]
Map:  50%|████▉     | 499/1000 [00:00<00:00, 1975.45 examples/s]
Map:  79%|███████▉  | 793/1000 [00:00<00:00, 1963.33 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1882.84 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 44069.39it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  36%|███▋      | 363/1000 [00:00<00:00, 3625.97it/s]
Logging series metrics to wandb:  74%|███████▍  | 739/1000 [00:00<00:00, 3702.39it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3657.83it/s]
finish opt
2024-01-10 18:59:54.630143: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 18:59:54.684151: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 18:59:54.684202: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 18:59:54.685384: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 18:59:54.692404: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 18:59:55.891717: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 66917.21lines/s]
Running swap attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  24%|██▍       | 241/1000 [00:00<00:00, 2389.82 examples/s]
Map:  49%|████▉     | 490/1000 [00:00<00:00, 2435.41 examples/s]
Map:  85%|████████▌ | 850/1000 [00:00<00:00, 2408.49 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 55699.77it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  41%|████▏     | 414/1000 [00:00<00:00, 4134.61it/s]
Logging series metrics to wandb:  84%|████████▎ | 836/1000 [00:00<00:00, 4183.50it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 4175.30it/s]
2024-01-10 19:00:27.136610: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:00:27.170649: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:00:27.170699: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:00:27.171587: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:00:27.176691: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:00:28.091489: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 93000.09lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<24:11,  1.45s/ examples]
Map:   1%|          | 9/1000 [00:01<02:10,  7.57 examples/s]
Map:   2%|▏         | 17/1000 [00:01<01:04, 15.17 examples/s]
Map:   3%|▎         | 26/1000 [00:01<00:39, 24.58 examples/s]
Map:   3%|▎         | 34/1000 [00:01<00:29, 32.95 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:21, 44.78 examples/s]
Map:   6%|▌         | 57/1000 [00:02<00:30, 30.68 examples/s]
Map:   7%|▋         | 68/1000 [00:02<00:23, 39.89 examples/s]
Map:   8%|▊         | 77/1000 [00:02<00:19, 47.26 examples/s]
Map:   9%|▉         | 89/1000 [00:02<00:15, 59.41 examples/s]
Map:  10%|█         | 100/1000 [00:03<00:13, 68.24 examples/s]
Map:  11%|█▏        | 113/1000 [00:03<00:10, 81.42 examples/s]
Map:  12%|█▎        | 125/1000 [00:03<00:09, 87.68 examples/s]
Map:  14%|█▍        | 140/1000 [00:03<00:08, 100.00 examples/s]
Map:  16%|█▌        | 157/1000 [00:03<00:07, 116.60 examples/s]
Map:  18%|█▊        | 176/1000 [00:03<00:06, 134.24 examples/s]
Map:  19%|█▉        | 193/1000 [00:03<00:05, 140.66 examples/s]
Map:  21%|██▏       | 213/1000 [00:03<00:05, 153.49 examples/s]
Map:  23%|██▎       | 232/1000 [00:03<00:04, 159.14 examples/s]
Map:  25%|██▌       | 252/1000 [00:04<00:04, 169.60 examples/s]
Map:  27%|██▋       | 271/1000 [00:04<00:04, 175.15 examples/s]
Map:  29%|██▉       | 292/1000 [00:04<00:03, 180.67 examples/s]
Map:  32%|███▏      | 319/1000 [00:04<00:03, 178.40 examples/s]
Map:  34%|███▍      | 340/1000 [00:04<00:03, 183.48 examples/s]
Map:  36%|███▌      | 361/1000 [00:04<00:03, 188.92 examples/s]
Map:  39%|███▉      | 391/1000 [00:04<00:03, 186.77 examples/s]
Map:  41%|████      | 411/1000 [00:04<00:03, 186.05 examples/s]
Map:  43%|████▎     | 432/1000 [00:04<00:02, 190.41 examples/s]
Map:  45%|████▌     | 453/1000 [00:05<00:02, 193.53 examples/s]
Map:  48%|████▊     | 481/1000 [00:05<00:02, 188.72 examples/s]
Map:  51%|█████▏    | 514/1000 [00:05<00:02, 196.32 examples/s]
Map:  54%|█████▍    | 539/1000 [00:05<00:02, 206.50 examples/s]
Map:  57%|█████▋    | 569/1000 [00:05<00:02, 200.27 examples/s]
Map:  59%|█████▉    | 591/1000 [00:05<00:02, 202.57 examples/s]
Map:  62%|██████▏   | 615/1000 [00:05<00:01, 210.38 examples/s]
Map:  65%|██████▍   | 647/1000 [00:06<00:01, 206.76 examples/s]
Map:  67%|██████▋   | 670/1000 [00:06<00:01, 210.25 examples/s]
Map:  69%|██████▉   | 693/1000 [00:06<00:01, 211.34 examples/s]
Map:  72%|███████▏  | 719/1000 [00:06<00:01, 219.31 examples/s]
Map:  74%|███████▍  | 742/1000 [00:06<00:01, 218.68 examples/s]
Map:  77%|███████▋  | 767/1000 [00:06<00:01, 189.65 examples/s]
Map:  79%|███████▉  | 791/1000 [00:06<00:01, 178.20 examples/s]
Map:  82%|████████▏ | 816/1000 [00:06<00:01, 172.32 examples/s]
Map:  84%|████████▍ | 840/1000 [00:07<00:00, 163.62 examples/s]
Map:  86%|████████▌ | 862/1000 [00:07<00:00, 156.10 examples/s]
Map:  88%|████████▊ | 880/1000 [00:07<00:00, 157.03 examples/s]
Map:  90%|████████▉ | 896/1000 [00:07<00:00, 154.90 examples/s]
Map:  92%|█████████▏| 915/1000 [00:07<00:00, 159.16 examples/s]
Map:  93%|█████████▎| 933/1000 [00:07<00:00, 161.40 examples/s]
Map:  96%|█████████▌| 958/1000 [00:07<00:00, 160.04 examples/s]
Map:  98%|█████████▊| 975/1000 [00:07<00:00, 159.07 examples/s]
Map:  99%|█████████▉| 992/1000 [00:08<00:00, 158.12 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56272.95it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  40%|████      | 403/1000 [00:00<00:00, 4024.72it/s]
Logging series metrics to wandb:  81%|████████  | 807/1000 [00:00<00:00, 4028.48it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 4021.97it/s]
2024-01-10 19:01:06.563750: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:01:06.616631: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:01:06.616686: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:01:06.617920: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:01:06.625505: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:01:08.225306: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 45886.53lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<27:46,  1.67s/ examples]
Map:   1%|          | 9/1000 [00:01<02:28,  6.66 examples/s]
Map:   2%|▏         | 17/1000 [00:01<01:13, 13.47 examples/s]
Map:   2%|▎         | 25/1000 [00:02<00:45, 21.28 examples/s]
Map:   3%|▎         | 33/1000 [00:02<00:33, 29.15 examples/s]
Map:   4%|▍         | 43/1000 [00:02<00:23, 40.08 examples/s]
Map:   5%|▌         | 51/1000 [00:03<00:43, 21.60 examples/s]
Map:   6%|▌         | 61/1000 [00:03<00:31, 30.18 examples/s]
Map:   7%|▋         | 69/1000 [00:03<00:25, 36.23 examples/s]
Map:   8%|▊         | 78/1000 [00:03<00:21, 43.76 examples/s]
Map:   9%|▉         | 90/1000 [00:03<00:16, 55.39 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:13, 64.67 examples/s]
Map:  12%|█▏        | 115/1000 [00:03<00:11, 77.60 examples/s]
Map:  12%|█▎        | 125/1000 [00:03<00:10, 80.90 examples/s]
Map:  14%|█▎        | 135/1000 [00:03<00:10, 85.32 examples/s]
Map:  15%|█▍        | 146/1000 [00:04<00:09, 88.40 examples/s]
Map:  16%|█▌        | 159/1000 [00:04<00:08, 97.32 examples/s]
Map:  17%|█▋        | 172/1000 [00:04<00:07, 104.64 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:07, 105.49 examples/s]
Map:  20%|██        | 200/1000 [00:04<00:07, 103.60 examples/s]
Map:  21%|██▏       | 213/1000 [00:04<00:07, 107.59 examples/s]
Map:  23%|██▎       | 226/1000 [00:04<00:06, 110.87 examples/s]
Map:  25%|██▍       | 246/1000 [00:04<00:06, 114.35 examples/s]
Map:  26%|██▋       | 265/1000 [00:05<00:06, 115.21 examples/s]
Map:  28%|██▊       | 283/1000 [00:05<00:06, 115.32 examples/s]
Map:  30%|██▉       | 296/1000 [00:05<00:06, 116.24 examples/s]
Map:  31%|███       | 308/1000 [00:05<00:05, 116.18 examples/s]
Map:  32%|███▏      | 320/1000 [00:05<00:05, 113.55 examples/s]
Map:  33%|███▎      | 332/1000 [00:05<00:05, 114.47 examples/s]
Map:  34%|███▍      | 344/1000 [00:05<00:05, 113.70 examples/s]
Map:  36%|███▌      | 358/1000 [00:05<00:05, 118.61 examples/s]
Map:  37%|███▋      | 371/1000 [00:05<00:05, 119.31 examples/s]
Map:  38%|███▊      | 383/1000 [00:06<00:05, 113.77 examples/s]
Map:  40%|███▉      | 396/1000 [00:06<00:05, 117.36 examples/s]
Map:  41%|████      | 409/1000 [00:06<00:04, 118.73 examples/s]
Map:  42%|████▏     | 422/1000 [00:06<00:04, 118.99 examples/s]
Map:  44%|████▎     | 436/1000 [00:06<00:04, 119.61 examples/s]
Map:  45%|████▌     | 453/1000 [00:06<00:04, 130.57 examples/s]
Map:  47%|████▋     | 467/1000 [00:06<00:04, 131.66 examples/s]
Map:  49%|████▊     | 486/1000 [00:06<00:03, 145.97 examples/s]
Map:  51%|█████     | 507/1000 [00:06<00:03, 161.70 examples/s]
Map:  53%|█████▎    | 526/1000 [00:07<00:02, 167.63 examples/s]
Map:  55%|█████▍    | 546/1000 [00:07<00:02, 174.59 examples/s]
Map:  56%|█████▋    | 564/1000 [00:07<00:02, 173.55 examples/s]
Map:  58%|█████▊    | 582/1000 [00:07<00:02, 172.57 examples/s]
Map:  60%|██████    | 603/1000 [00:07<00:02, 181.80 examples/s]
Map:  62%|██████▏   | 623/1000 [00:07<00:02, 185.81 examples/s]
Map:  65%|██████▌   | 650/1000 [00:07<00:01, 179.31 examples/s]
Map:  67%|██████▋   | 670/1000 [00:07<00:01, 181.26 examples/s]
Map:  69%|██████▉   | 689/1000 [00:07<00:01, 179.95 examples/s]
Map:  71%|███████   | 711/1000 [00:08<00:01, 187.86 examples/s]
Map:  74%|███████▍  | 740/1000 [00:08<00:01, 186.71 examples/s]
Map:  76%|███████▌  | 760/1000 [00:08<00:01, 186.57 examples/s]
Map:  78%|███████▊  | 780/1000 [00:08<00:01, 184.77 examples/s]
Map:  80%|███████▉  | 799/1000 [00:08<00:01, 184.47 examples/s]
Map:  82%|████████▏ | 821/1000 [00:08<00:00, 188.11 examples/s]
Map:  84%|████████▍ | 840/1000 [00:08<00:00, 185.53 examples/s]
Map:  87%|████████▋ | 869/1000 [00:08<00:00, 183.41 examples/s]
Map:  89%|████████▉ | 889/1000 [00:09<00:00, 183.96 examples/s]
Map:  91%|█████████ | 910/1000 [00:09<00:00, 187.50 examples/s]
Map:  93%|█████████▎| 932/1000 [00:09<00:00, 193.88 examples/s]
Map:  95%|█████████▌| 952/1000 [00:09<00:00, 190.33 examples/s]
Map:  97%|█████████▋| 973/1000 [00:09<00:00, 191.88 examples/s]
Map: 100%|██████████| 1000/1000 [00:09<00:00, 172.37 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 54127.73it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▉       | 293/1000 [00:00<00:00, 2927.92it/s]
Logging series metrics to wandb:  62%|██████▏   | 616/1000 [00:00<00:00, 3101.82it/s]
Logging series metrics to wandb:  96%|█████████▋| 964/1000 [00:00<00:00, 3271.10it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3197.63it/s]
2024-01-10 19:01:51.633507: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:01:51.686956: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:01:51.687012: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:01:51.688227: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:01:51.695499: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:01:53.194402: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63382.96lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<26:59,  1.62s/ examples]
Map:   1%|          | 8/1000 [00:01<02:40,  6.17 examples/s]
Map:   2%|▏         | 15/1000 [00:01<01:19, 12.44 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:45, 21.51 examples/s]
Map:   3%|▎         | 32/1000 [00:02<00:32, 29.68 examples/s]
Map:   4%|▍         | 43/1000 [00:02<00:22, 42.01 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:36, 25.87 examples/s]
Map:   6%|▋         | 63/1000 [00:02<00:25, 37.06 examples/s]
Map:   7%|▋         | 72/1000 [00:03<00:21, 43.82 examples/s]
Map:   8%|▊         | 83/1000 [00:03<00:16, 54.00 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:14, 63.05 examples/s]
Map:  10%|█         | 105/1000 [00:03<00:12, 72.01 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:10, 85.25 examples/s]
Map:  14%|█▎        | 135/1000 [00:03<00:09, 88.43 examples/s]
Map:  15%|█▍        | 147/1000 [00:03<00:09, 92.50 examples/s]
Map:  16%|█▌        | 160/1000 [00:03<00:08, 100.23 examples/s]
Map:  18%|█▊        | 175/1000 [00:03<00:07, 109.82 examples/s]
Map:  19%|█▊        | 187/1000 [00:04<00:07, 107.09 examples/s]
Map:  20%|██        | 205/1000 [00:04<00:07, 108.74 examples/s]
Map:  22%|██▏       | 218/1000 [00:04<00:07, 110.58 examples/s]
Map:  23%|██▎       | 231/1000 [00:04<00:06, 113.21 examples/s]
Map:  24%|██▍       | 245/1000 [00:04<00:06, 119.53 examples/s]
Map:  26%|██▌       | 258/1000 [00:04<00:06, 119.29 examples/s]
Map:  27%|██▋       | 271/1000 [00:04<00:06, 120.64 examples/s]
Map:  28%|██▊       | 285/1000 [00:04<00:05, 123.64 examples/s]
Map:  30%|██▉       | 299/1000 [00:05<00:05, 122.79 examples/s]
Map:  32%|███▏      | 318/1000 [00:05<00:05, 120.90 examples/s]
Map:  33%|███▎      | 332/1000 [00:05<00:05, 124.27 examples/s]
Map:  34%|███▍      | 345/1000 [00:05<00:05, 124.10 examples/s]
Map:  36%|███▌      | 360/1000 [00:05<00:04, 130.99 examples/s]
Map:  37%|███▋      | 374/1000 [00:05<00:04, 128.13 examples/s]
Map:  39%|███▊      | 387/1000 [00:05<00:04, 125.24 examples/s]
Map:  40%|████      | 400/1000 [00:05<00:04, 124.71 examples/s]
Map:  42%|████▏     | 415/1000 [00:05<00:04, 127.72 examples/s]
Map:  43%|████▎     | 429/1000 [00:06<00:04, 129.26 examples/s]
Map:  44%|████▍     | 445/1000 [00:06<00:04, 135.88 examples/s]
Map:  46%|████▌     | 460/1000 [00:06<00:03, 137.20 examples/s]
Map:  48%|████▊     | 483/1000 [00:06<00:03, 139.13 examples/s]
Map:  50%|█████     | 502/1000 [00:06<00:03, 149.49 examples/s]
Map:  52%|█████▏    | 524/1000 [00:06<00:02, 165.65 examples/s]
Map:  55%|█████▍    | 546/1000 [00:06<00:02, 174.68 examples/s]
Map:  56%|█████▋    | 564/1000 [00:06<00:02, 172.66 examples/s]
Map:  58%|█████▊    | 583/1000 [00:06<00:02, 173.80 examples/s]
Map:  60%|██████    | 605/1000 [00:07<00:02, 184.02 examples/s]
Map:  62%|██████▎   | 625/1000 [00:07<00:02, 182.68 examples/s]
Map:  65%|██████▌   | 653/1000 [00:07<00:01, 179.68 examples/s]
Map:  67%|██████▋   | 672/1000 [00:07<00:01, 179.77 examples/s]
Map:  69%|██████▉   | 693/1000 [00:07<00:01, 183.93 examples/s]
Map:  71%|███████▏  | 714/1000 [00:07<00:01, 188.83 examples/s]
Map:  74%|███████▎  | 735/1000 [00:07<00:01, 192.01 examples/s]
Map:  76%|███████▌  | 755/1000 [00:07<00:01, 192.79 examples/s]
Map:  78%|███████▊  | 783/1000 [00:07<00:01, 186.07 examples/s]
Map:  80%|████████  | 802/1000 [00:08<00:01, 186.80 examples/s]
Map:  82%|████████▎ | 825/1000 [00:08<00:00, 194.65 examples/s]
Map:  85%|████████▌ | 852/1000 [00:08<00:00, 182.43 examples/s]
Map:  87%|████████▋ | 872/1000 [00:08<00:00, 185.03 examples/s]
Map:  89%|████████▉ | 891/1000 [00:08<00:00, 180.92 examples/s]
Map:  91%|█████████ | 911/1000 [00:08<00:00, 185.50 examples/s]
Map:  93%|█████████▎| 932/1000 [00:08<00:00, 190.54 examples/s]
Map:  96%|█████████▌| 960/1000 [00:08<00:00, 184.57 examples/s]
Map:  98%|█████████▊| 979/1000 [00:09<00:00, 183.68 examples/s]
Map: 100%|█████████▉| 998/1000 [00:09<00:00, 184.12 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47432.93it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  33%|███▎      | 333/1000 [00:00<00:00, 3327.42it/s]
Logging series metrics to wandb:  67%|██████▋   | 666/1000 [00:00<00:00, 3222.38it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3273.53it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3265.87it/s]
2024-01-10 19:02:37.017637: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:02:37.067404: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:02:37.067483: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:02:37.068897: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:02:37.076075: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:02:38.609178: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 53409.53lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:07,  1.51s/ examples]
Map:   1%|          | 9/1000 [00:01<02:15,  7.30 examples/s]
Map:   2%|▏         | 16/1000 [00:01<01:11, 13.82 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:44, 22.12 examples/s]
Map:   3%|▎         | 31/1000 [00:01<00:33, 29.28 examples/s]
Map:   4%|▍         | 42/1000 [00:02<00:22, 42.56 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:37, 25.36 examples/s]
Map:   6%|▋         | 63/1000 [00:02<00:25, 36.24 examples/s]
Map:   7%|▋         | 71/1000 [00:02<00:22, 41.44 examples/s]
Map:   8%|▊         | 82/1000 [00:03<00:17, 51.33 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:14, 61.86 examples/s]
Map:  10%|█         | 104/1000 [00:03<00:12, 69.02 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:10, 84.08 examples/s]
Map:  13%|█▎        | 129/1000 [00:03<00:10, 84.81 examples/s]
Map:  14%|█▍        | 140/1000 [00:03<00:09, 90.42 examples/s]
Map:  15%|█▌        | 154/1000 [00:03<00:08, 98.77 examples/s]
Map:  17%|█▋        | 172/1000 [00:03<00:07, 103.54 examples/s]
Map:  18%|█▊        | 183/1000 [00:04<00:07, 105.04 examples/s]
Map:  19%|█▉        | 194/1000 [00:04<00:07, 102.62 examples/s]
Map:  21%|██        | 207/1000 [00:04<00:07, 108.54 examples/s]
Map:  22%|██▏       | 221/1000 [00:04<00:06, 113.21 examples/s]
Map:  23%|██▎       | 233/1000 [00:04<00:06, 111.36 examples/s]
Map:  25%|██▍       | 249/1000 [00:04<00:06, 121.75 examples/s]
Map:  26%|██▋       | 263/1000 [00:04<00:06, 122.27 examples/s]
Map:  28%|██▊       | 277/1000 [00:04<00:05, 123.43 examples/s]
Map:  29%|██▉       | 290/1000 [00:04<00:05, 122.89 examples/s]
Map:  31%|███       | 308/1000 [00:05<00:05, 116.17 examples/s]
Map:  32%|███▏      | 322/1000 [00:05<00:05, 121.34 examples/s]
Map:  34%|███▍      | 341/1000 [00:05<00:04, 136.22 examples/s]
Map:  36%|███▌      | 359/1000 [00:05<00:04, 145.55 examples/s]
Map:  38%|███▊      | 376/1000 [00:05<00:04, 148.10 examples/s]
Map:  39%|███▉      | 393/1000 [00:05<00:04, 149.77 examples/s]
Map:  41%|████      | 409/1000 [00:05<00:03, 151.05 examples/s]
Map:  43%|████▎     | 427/1000 [00:05<00:03, 157.27 examples/s]
Map:  45%|████▍     | 446/1000 [00:05<00:03, 163.46 examples/s]
Map:  46%|████▋     | 465/1000 [00:06<00:03, 165.74 examples/s]
Map:  48%|████▊     | 485/1000 [00:06<00:02, 172.83 examples/s]
Map:  50%|█████     | 505/1000 [00:06<00:02, 179.61 examples/s]
Map:  52%|█████▎    | 525/1000 [00:06<00:02, 182.73 examples/s]
Map:  55%|█████▍    | 546/1000 [00:06<00:02, 185.16 examples/s]
Map:  57%|█████▊    | 575/1000 [00:06<00:02, 183.34 examples/s]
Map:  60%|█████▉    | 595/1000 [00:06<00:02, 184.84 examples/s]
Map:  62%|██████▏   | 616/1000 [00:06<00:02, 188.93 examples/s]
Map:  64%|██████▎   | 636/1000 [00:06<00:01, 187.01 examples/s]
Map:  66%|██████▌   | 657/1000 [00:07<00:01, 189.65 examples/s]
Map:  68%|██████▊   | 677/1000 [00:07<00:01, 188.91 examples/s]
Map:  70%|███████   | 702/1000 [00:07<00:01, 178.36 examples/s]
Map:  72%|███████▏  | 723/1000 [00:07<00:01, 182.43 examples/s]
Map:  74%|███████▍  | 744/1000 [00:07<00:01, 186.42 examples/s]
Map:  76%|███████▋  | 763/1000 [00:07<00:01, 180.83 examples/s]
Map:  78%|███████▊  | 783/1000 [00:07<00:01, 183.84 examples/s]
Map:  80%|████████  | 803/1000 [00:07<00:01, 184.78 examples/s]
Map:  82%|████████▎ | 825/1000 [00:07<00:00, 189.72 examples/s]
Map:  85%|████████▌ | 852/1000 [00:08<00:00, 179.63 examples/s]
Map:  87%|████████▋ | 874/1000 [00:08<00:00, 187.33 examples/s]
Map:  90%|█████████ | 903/1000 [00:08<00:00, 184.55 examples/s]
Map:  93%|█████████▎| 926/1000 [00:08<00:00, 193.64 examples/s]
Map:  96%|█████████▌| 955/1000 [00:08<00:00, 188.86 examples/s]
Map:  98%|█████████▊| 982/1000 [00:08<00:00, 184.57 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 45166.58it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▉       | 293/1000 [00:00<00:00, 2918.00it/s]
Logging series metrics to wandb:  62%|██████▏   | 624/1000 [00:00<00:00, 3146.61it/s]
Logging series metrics to wandb:  96%|█████████▌| 962/1000 [00:00<00:00, 3251.07it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3217.07it/s]
2024-01-10 19:03:24.664598: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:03:24.730413: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:03:24.730520: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:03:24.731881: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:03:24.740155: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:03:26.325350: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61810.02lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:37,  1.54s/ examples]
Map:   1%|          | 9/1000 [00:01<02:18,  7.16 examples/s]
Map:   2%|▏         | 16/1000 [00:01<01:12, 13.55 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:44, 21.77 examples/s]
Map:   3%|▎         | 31/1000 [00:02<00:33, 29.05 examples/s]
Map:   4%|▍         | 42/1000 [00:02<00:22, 42.60 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:37, 25.27 examples/s]
Map:   6%|▋         | 63/1000 [00:02<00:26, 36.03 examples/s]
Map:   7%|▋         | 71/1000 [00:02<00:22, 41.61 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:17, 51.09 examples/s]
Map:   9%|▉         | 92/1000 [00:03<00:14, 60.99 examples/s]
Map:  10%|█         | 102/1000 [00:03<00:13, 68.89 examples/s]
Map:  12%|█▏        | 115/1000 [00:03<00:10, 81.82 examples/s]
Map:  13%|█▎        | 126/1000 [00:03<00:10, 84.86 examples/s]
Map:  14%|█▍        | 138/1000 [00:03<00:09, 91.61 examples/s]
Map:  15%|█▌        | 150/1000 [00:03<00:08, 94.83 examples/s]
Map:  16%|█▌        | 162/1000 [00:03<00:08, 98.62 examples/s]
Map:  18%|█▊        | 176/1000 [00:03<00:07, 109.00 examples/s]
Map:  19%|█▉        | 192/1000 [00:04<00:07, 105.71 examples/s]
Map:  20%|██        | 205/1000 [00:04<00:07, 110.78 examples/s]
Map:  22%|██▏       | 217/1000 [00:04<00:07, 111.76 examples/s]
Map:  23%|██▎       | 229/1000 [00:04<00:06, 112.68 examples/s]
Map:  24%|██▍       | 242/1000 [00:04<00:06, 114.42 examples/s]
Map:  26%|██▌       | 256/1000 [00:04<00:06, 117.45 examples/s]
Map:  27%|██▋       | 270/1000 [00:04<00:06, 119.01 examples/s]
Map:  28%|██▊       | 282/1000 [00:04<00:06, 116.65 examples/s]
Map:  30%|██▉       | 299/1000 [00:05<00:06, 113.43 examples/s]
Map:  32%|███▏      | 316/1000 [00:05<00:06, 110.58 examples/s]
Map:  34%|███▎      | 335/1000 [00:05<00:05, 114.25 examples/s]
Map:  35%|███▍      | 347/1000 [00:05<00:05, 112.49 examples/s]
Map:  36%|███▋      | 363/1000 [00:05<00:05, 120.25 examples/s]
Map:  38%|███▊      | 376/1000 [00:05<00:05, 120.44 examples/s]
Map:  39%|███▉      | 390/1000 [00:05<00:05, 120.48 examples/s]
Map:  41%|████      | 409/1000 [00:05<00:05, 118.19 examples/s]
Map:  42%|████▏     | 423/1000 [00:06<00:04, 120.39 examples/s]
Map:  44%|████▎     | 437/1000 [00:06<00:04, 122.87 examples/s]
Map:  46%|████▌     | 455/1000 [00:06<00:04, 131.60 examples/s]
Map:  47%|████▋     | 471/1000 [00:06<00:03, 136.33 examples/s]
Map:  49%|████▉     | 489/1000 [00:06<00:03, 146.07 examples/s]
Map:  51%|█████     | 511/1000 [00:06<00:02, 164.07 examples/s]
Map:  53%|█████▎    | 530/1000 [00:06<00:02, 168.67 examples/s]
Map:  55%|█████▌    | 551/1000 [00:06<00:02, 175.54 examples/s]
Map:  57%|█████▋    | 569/1000 [00:06<00:02, 175.39 examples/s]
Map:  59%|█████▉    | 588/1000 [00:07<00:02, 176.81 examples/s]
Map:  61%|██████    | 608/1000 [00:07<00:02, 181.76 examples/s]
Map:  63%|██████▎   | 627/1000 [00:07<00:02, 177.76 examples/s]
Map:  65%|██████▍   | 646/1000 [00:07<00:02, 174.92 examples/s]
Map:  66%|██████▋   | 665/1000 [00:07<00:01, 177.64 examples/s]
Map:  70%|██████▉   | 695/1000 [00:07<00:01, 183.43 examples/s]
Map:  72%|███████▏  | 716/1000 [00:07<00:01, 187.56 examples/s]
Map:  74%|███████▎  | 736/1000 [00:07<00:01, 189.65 examples/s]
Map:  76%|███████▌  | 757/1000 [00:07<00:01, 193.94 examples/s]
Map:  78%|███████▊  | 784/1000 [00:08<00:01, 185.29 examples/s]
Map:  80%|████████  | 804/1000 [00:08<00:01, 187.25 examples/s]
Map:  83%|████████▎ | 826/1000 [00:08<00:00, 193.50 examples/s]
Map:  85%|████████▌ | 852/1000 [00:08<00:00, 178.85 examples/s]
Map:  87%|████████▋ | 874/1000 [00:08<00:00, 186.14 examples/s]
Map:  90%|█████████ | 902/1000 [00:08<00:00, 184.17 examples/s]
Map:  92%|█████████▎| 925/1000 [00:08<00:00, 192.58 examples/s]
Map:  94%|█████████▍| 945/1000 [00:08<00:00, 189.89 examples/s]
Map:  96%|█████████▋| 965/1000 [00:09<00:00, 189.42 examples/s]
Map:  99%|█████████▉| 992/1000 [00:09<00:00, 183.05 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47852.87it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 271/1000 [00:00<00:00, 2700.36it/s]
Logging series metrics to wandb:  54%|█████▍    | 542/1000 [00:00<00:00, 2578.08it/s]
Logging series metrics to wandb:  81%|████████  | 811/1000 [00:00<00:00, 2625.81it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2631.61it/s]
2024-01-10 19:04:12.840177: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:04:12.927708: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:04:12.927803: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:04:12.929822: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:04:12.941870: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:04:14.615740: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 59967.46lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 21/1000 [00:00<00:04, 203.36 examples/s]
Map:   5%|▍         | 48/1000 [00:00<00:04, 231.60 examples/s]
Map:   7%|▋         | 74/1000 [00:00<00:03, 238.07 examples/s]
Map:  10%|▉         | 99/1000 [00:00<00:03, 239.08 examples/s]
Map:  12%|█▎        | 125/1000 [00:00<00:03, 241.87 examples/s]
Map:  15%|█▌        | 151/1000 [00:00<00:03, 246.88 examples/s]
Map:  18%|█▊        | 178/1000 [00:00<00:03, 249.62 examples/s]
Map:  22%|██▏       | 215/1000 [00:00<00:03, 241.98 examples/s]
Map:  24%|██▍       | 241/1000 [00:00<00:03, 243.99 examples/s]
Map:  27%|██▋       | 268/1000 [00:01<00:02, 248.23 examples/s]
Map:  29%|██▉       | 293/1000 [00:01<00:02, 244.91 examples/s]
Map:  33%|███▎      | 330/1000 [00:01<00:02, 240.79 examples/s]
Map:  37%|███▋      | 367/1000 [00:01<00:02, 240.57 examples/s]
Map:  40%|████      | 401/1000 [00:01<00:02, 234.94 examples/s]
Map:  43%|████▎     | 427/1000 [00:01<00:02, 238.75 examples/s]
Map:  45%|████▌     | 452/1000 [00:01<00:02, 239.71 examples/s]
Map:  49%|████▉     | 489/1000 [00:02<00:02, 238.03 examples/s]
Map:  52%|█████▏    | 516/1000 [00:02<00:01, 244.04 examples/s]
Map:  55%|█████▍    | 545/1000 [00:02<00:01, 253.35 examples/s]
Map:  57%|█████▋    | 572/1000 [00:02<00:01, 254.41 examples/s]
Map:  61%|██████    | 610/1000 [00:02<00:01, 249.73 examples/s]
Map:  64%|██████▎   | 636/1000 [00:02<00:01, 249.16 examples/s]
Map:  66%|██████▋   | 663/1000 [00:02<00:01, 251.58 examples/s]
Map:  69%|██████▉   | 689/1000 [00:02<00:01, 248.77 examples/s]
Map:  72%|███████▏  | 719/1000 [00:02<00:01, 258.31 examples/s]
Map:  76%|███████▌  | 757/1000 [00:03<00:00, 253.39 examples/s]
Map:  79%|███████▉  | 794/1000 [00:03<00:00, 244.99 examples/s]
Map:  83%|████████▎ | 829/1000 [00:03<00:00, 237.29 examples/s]
Map:  86%|████████▋ | 865/1000 [00:03<00:00, 233.98 examples/s]
Map:  89%|████████▉ | 890/1000 [00:03<00:00, 234.62 examples/s]
Map:  92%|█████████▏| 916/1000 [00:03<00:00, 237.68 examples/s]
Map:  94%|█████████▍| 942/1000 [00:03<00:00, 241.28 examples/s]
Map:  97%|█████████▋| 969/1000 [00:03<00:00, 245.03 examples/s]
Map:  99%|█████████▉| 994/1000 [00:04<00:00, 243.35 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35840.48it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▊       | 286/1000 [00:00<00:00, 2859.37it/s]
Logging series metrics to wandb:  57%|█████▋    | 572/1000 [00:00<00:00, 2797.43it/s]
Logging series metrics to wandb:  85%|████████▌ | 852/1000 [00:00<00:00, 2481.29it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2537.96it/s]
2024-01-10 19:04:53.880854: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:04:53.929131: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:04:53.929178: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:04:53.930346: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:04:53.937821: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:04:55.221418: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61123.64lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 184/1000 [00:00<00:00, 1814.55 examples/s]
Map:  37%|███▋      | 370/1000 [00:00<00:00, 1832.68 examples/s]
Map:  57%|█████▋    | 568/1000 [00:00<00:00, 1895.56 examples/s]
Map:  85%|████████▍ | 848/1000 [00:00<00:00, 1875.07 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37067.22it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 284/1000 [00:00<00:00, 2835.05it/s]
Logging series metrics to wandb:  57%|█████▋    | 568/1000 [00:00<00:00, 2823.40it/s]
Logging series metrics to wandb:  85%|████████▌ | 851/1000 [00:00<00:00, 2749.97it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2767.27it/s]
2024-01-10 19:05:29.640889: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:05:29.690413: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:05:29.690477: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:05:29.691595: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:05:29.698295: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:05:31.086640: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 67499.82lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 184/1000 [00:00<00:00, 1814.39 examples/s]
Map:  38%|███▊      | 381/1000 [00:00<00:00, 1900.76 examples/s]
Map:  58%|█████▊    | 582/1000 [00:00<00:00, 1943.84 examples/s]
Map:  79%|███████▊  | 786/1000 [00:00<00:00, 1977.51 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1686.81 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35530.20it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▊       | 286/1000 [00:00<00:00, 2858.93it/s]
Logging series metrics to wandb:  57%|█████▋    | 572/1000 [00:00<00:00, 2840.25it/s]
Logging series metrics to wandb:  86%|████████▌ | 857/1000 [00:00<00:00, 2730.95it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2749.29it/s]
2024-01-10 19:06:06.574130: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:06:06.629066: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:06:06.629166: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:06:06.630464: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:06:06.638242: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:06:08.100029: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64447.44lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  24%|██▎       | 236/1000 [00:00<00:00, 2322.21 examples/s]
Map:  51%|█████     | 508/1000 [00:00<00:00, 2549.93 examples/s]
Map:  78%|███████▊  | 777/1000 [00:00<00:00, 2612.32 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 33852.61it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▋       | 263/1000 [00:00<00:00, 2622.99it/s]
Logging series metrics to wandb:  53%|█████▎    | 526/1000 [00:00<00:00, 2513.94it/s]
Logging series metrics to wandb:  79%|███████▊  | 787/1000 [00:00<00:00, 2554.50it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2551.03it/s]
2024-01-10 19:06:44.445857: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:06:44.506043: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:06:44.506141: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:06:44.507466: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:06:44.516402: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:06:45.998282: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64096.83lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  20%|██        | 202/1000 [00:00<00:00, 1988.71 examples/s]
Map:  51%|█████     | 506/1000 [00:00<00:00, 2012.89 examples/s]
Map:  71%|███████   | 708/1000 [00:00<00:00, 2013.61 examples/s]
Map:  98%|█████████▊| 983/1000 [00:00<00:00, 1926.48 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/rohith23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37829.81it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 272/1000 [00:00<00:00, 2718.19it/s]
Logging series metrics to wandb:  54%|█████▍    | 544/1000 [00:00<00:00, 2688.57it/s]
Logging series metrics to wandb:  83%|████████▎ | 827/1000 [00:00<00:00, 2751.71it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2734.14it/s]
finish llama
finish rohith23
start lean23
2024-01-10 19:07:21.431266: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:07:21.482903: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:07:21.482955: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:07:21.484096: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:07:21.493359: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:07:22.909600: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 58614.87lines/s]
Running swap attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   6%|▌         | 60/1000 [00:00<00:01, 587.27 examples/s]
Map:  13%|█▎        | 134/1000 [00:00<00:01, 672.01 examples/s]
Map:  21%|██        | 209/1000 [00:00<00:01, 700.86 examples/s]
Map:  34%|███▎      | 337/1000 [00:00<00:00, 925.15 examples/s]
Map:  46%|████▋     | 464/1000 [00:00<00:00, 1045.27 examples/s]
Map:  60%|█████▉    | 598/1000 [00:00<00:00, 1140.99 examples/s]
Map:  73%|███████▎  | 732/1000 [00:00<00:00, 1202.28 examples/s]
Map:  86%|████████▋ | 864/1000 [00:00<00:00, 1235.94 examples/s]
Map: 100%|█████████▉| 996/1000 [00:00<00:00, 1256.41 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35486.61it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 269/1000 [00:00<00:00, 2680.88it/s]
Logging series metrics to wandb:  55%|█████▍    | 548/1000 [00:00<00:00, 2740.13it/s]
Logging series metrics to wandb:  82%|████████▏ | 824/1000 [00:00<00:00, 2749.10it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2728.32it/s]
2024-01-10 19:08:00.602256: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:08:00.657787: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:08:00.657839: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:08:00.659017: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:08:00.666498: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:08:02.107825: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60211.95lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<29:04,  1.75s/ examples]
Map:   1%|          | 8/1000 [00:01<02:53,  5.71 examples/s]
Map:   2%|▏         | 16/1000 [00:01<01:18, 12.51 examples/s]
Map:   2%|▏         | 22/1000 [00:02<00:54, 17.93 examples/s]
Map:   3%|▎         | 30/1000 [00:02<00:37, 26.09 examples/s]
Map:   4%|▍         | 38/1000 [00:02<00:28, 33.94 examples/s]
Map:   5%|▍         | 46/1000 [00:02<00:23, 40.83 examples/s]
Map:   6%|▌         | 55/1000 [00:03<00:50, 18.65 examples/s]
Map:   6%|▋         | 64/1000 [00:03<00:36, 25.49 examples/s]
Map:   7%|▋         | 72/1000 [00:03<00:29, 31.83 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:23, 39.39 examples/s]
Map:   9%|▉         | 90/1000 [00:03<00:19, 46.92 examples/s]
Map:  10%|▉         | 99/1000 [00:03<00:16, 53.90 examples/s]
Map:  11%|█         | 109/1000 [00:04<00:14, 61.90 examples/s]
Map:  12%|█▏        | 119/1000 [00:04<00:12, 68.17 examples/s]
Map:  13%|█▎        | 128/1000 [00:04<00:12, 70.49 examples/s]
Map:  14%|█▍        | 138/1000 [00:04<00:11, 77.07 examples/s]
Map:  15%|█▌        | 152/1000 [00:04<00:09, 91.29 examples/s]
Map:  17%|█▋        | 166/1000 [00:04<00:08, 102.10 examples/s]
Map:  18%|█▊        | 178/1000 [00:04<00:07, 105.47 examples/s]
Map:  19%|█▉        | 191/1000 [00:04<00:07, 110.68 examples/s]
Map:  21%|██        | 206/1000 [00:04<00:06, 119.20 examples/s]
Map:  22%|██▏       | 220/1000 [00:05<00:06, 121.09 examples/s]
Map:  23%|██▎       | 233/1000 [00:05<00:06, 119.84 examples/s]
Map:  25%|██▍       | 246/1000 [00:05<00:06, 121.70 examples/s]
Map:  26%|██▌       | 260/1000 [00:05<00:05, 124.04 examples/s]
Map:  27%|██▋       | 273/1000 [00:05<00:05, 124.59 examples/s]
Map:  29%|██▊       | 287/1000 [00:05<00:05, 126.89 examples/s]
Map:  30%|███       | 302/1000 [00:05<00:05, 130.14 examples/s]
Map:  32%|███▏      | 322/1000 [00:05<00:05, 125.84 examples/s]
Map:  34%|███▎      | 337/1000 [00:05<00:05, 129.56 examples/s]
Map:  36%|███▌      | 358/1000 [00:06<00:04, 130.22 examples/s]
Map:  37%|███▋      | 374/1000 [00:06<00:04, 133.16 examples/s]
Map:  39%|███▉      | 390/1000 [00:06<00:04, 137.69 examples/s]
Map:  41%|████      | 406/1000 [00:06<00:04, 138.93 examples/s]
Map:  42%|████▏     | 422/1000 [00:06<00:04, 142.98 examples/s]
Map:  44%|████▍     | 440/1000 [00:06<00:04, 131.70 examples/s]
Map:  46%|████▌     | 455/1000 [00:06<00:04, 116.02 examples/s]
Map:  47%|████▋     | 472/1000 [00:07<00:04, 110.38 examples/s]
Map:  49%|████▉     | 488/1000 [00:07<00:04, 118.65 examples/s]
Map:  50%|█████     | 505/1000 [00:07<00:03, 129.41 examples/s]
Map:  52%|█████▏    | 521/1000 [00:07<00:03, 133.75 examples/s]
Map:  54%|█████▍    | 540/1000 [00:07<00:03, 125.94 examples/s]
Map:  56%|█████▌    | 556/1000 [00:07<00:03, 131.06 examples/s]
Map:  57%|█████▋    | 572/1000 [00:07<00:03, 135.11 examples/s]
Map:  59%|█████▉    | 588/1000 [00:07<00:02, 140.26 examples/s]
Map:  60%|██████    | 605/1000 [00:07<00:02, 145.71 examples/s]
Map:  62%|██████▏   | 621/1000 [00:08<00:02, 148.01 examples/s]
Map:  64%|██████▍   | 638/1000 [00:08<00:02, 152.87 examples/s]
Map:  66%|██████▌   | 655/1000 [00:08<00:02, 155.02 examples/s]
Map:  67%|██████▋   | 671/1000 [00:08<00:02, 151.50 examples/s]
Map:  69%|██████▊   | 687/1000 [00:08<00:02, 152.49 examples/s]
Map:  70%|███████   | 705/1000 [00:08<00:01, 155.40 examples/s]
Map:  72%|███████▏  | 723/1000 [00:08<00:01, 156.57 examples/s]
Map:  74%|███████▍  | 739/1000 [00:08<00:01, 154.21 examples/s]
Map:  76%|███████▌  | 755/1000 [00:08<00:01, 154.24 examples/s]
Map:  78%|███████▊  | 778/1000 [00:09<00:01, 151.07 examples/s]
Map:  79%|███████▉  | 794/1000 [00:09<00:01, 151.34 examples/s]
Map:  82%|████████▏ | 817/1000 [00:09<00:01, 150.07 examples/s]
Map:  83%|████████▎ | 834/1000 [00:09<00:01, 151.92 examples/s]
Map:  85%|████████▌ | 850/1000 [00:09<00:00, 151.09 examples/s]
Map:  87%|████████▋ | 867/1000 [00:09<00:00, 152.66 examples/s]
Map:  88%|████████▊ | 883/1000 [00:09<00:00, 151.37 examples/s]
Map:  90%|█████████ | 901/1000 [00:09<00:00, 158.50 examples/s]
Map:  92%|█████████▏| 917/1000 [00:10<00:00, 157.25 examples/s]
Map:  93%|█████████▎| 933/1000 [00:10<00:00, 154.80 examples/s]
Map:  95%|█████████▌| 952/1000 [00:10<00:00, 161.23 examples/s]
Map:  98%|█████████▊| 976/1000 [00:10<00:00, 156.88 examples/s]
Map:  99%|█████████▉| 993/1000 [00:10<00:00, 155.81 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 46056.33it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  31%|███       | 312/1000 [00:00<00:00, 3109.27it/s]
Logging series metrics to wandb:  62%|██████▏   | 623/1000 [00:00<00:00, 3036.29it/s]
Logging series metrics to wandb:  98%|█████████▊| 982/1000 [00:00<00:00, 3283.58it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3222.26it/s]
2024-01-10 19:08:48.655782: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:08:48.736989: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:08:48.737073: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:08:48.738490: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:08:48.747007: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:08:50.134666: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 66289.00lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<30:09,  1.81s/ examples]
Map:   1%|          | 8/1000 [00:01<02:59,  5.52 examples/s]
Map:   2%|▏         | 15/1000 [00:02<01:26, 11.37 examples/s]
Map:   2%|▏         | 21/1000 [00:02<00:58, 16.80 examples/s]
Map:   3%|▎         | 28/1000 [00:02<00:40, 24.11 examples/s]
Map:   4%|▎         | 36/1000 [00:02<00:29, 32.74 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:23, 40.28 examples/s]
Map:   5%|▌         | 51/1000 [00:03<00:49, 19.01 examples/s]
Map:   6%|▌         | 59/1000 [00:03<00:38, 24.67 examples/s]
Map:   7%|▋         | 68/1000 [00:03<00:28, 32.50 examples/s]
Map:   8%|▊         | 78/1000 [00:03<00:22, 41.80 examples/s]
Map:   9%|▊         | 87/1000 [00:03<00:18, 49.39 examples/s]
Map:  10%|▉         | 97/1000 [00:03<00:15, 57.20 examples/s]
Map:  11%|█         | 107/1000 [00:04<00:13, 64.15 examples/s]
Map:  12%|█▏        | 118/1000 [00:04<00:12, 72.48 examples/s]
Map:  13%|█▎        | 128/1000 [00:04<00:11, 76.26 examples/s]
Map:  14%|█▍        | 139/1000 [00:04<00:10, 79.72 examples/s]
Map:  15%|█▌        | 150/1000 [00:04<00:10, 84.72 examples/s]
Map:  16%|█▌        | 161/1000 [00:04<00:09, 88.84 examples/s]
Map:  17%|█▋        | 172/1000 [00:04<00:09, 91.19 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 94.04 examples/s]
Map:  20%|█▉        | 195/1000 [00:04<00:08, 95.40 examples/s]
Map:  21%|██        | 207/1000 [00:05<00:08, 98.29 examples/s]
Map:  22%|██▏       | 218/1000 [00:05<00:07, 98.37 examples/s]
Map:  23%|██▎       | 228/1000 [00:05<00:07, 98.12 examples/s]
Map:  24%|██▍       | 239/1000 [00:05<00:07, 98.60 examples/s]
Map:  25%|██▌       | 250/1000 [00:05<00:07, 100.72 examples/s]
Map:  26%|██▌       | 262/1000 [00:05<00:07, 103.89 examples/s]
Map:  27%|██▋       | 274/1000 [00:05<00:06, 105.76 examples/s]
Map:  29%|██▊       | 286/1000 [00:05<00:06, 108.23 examples/s]
Map:  30%|██▉       | 298/1000 [00:05<00:06, 107.23 examples/s]
Map:  31%|███▏      | 313/1000 [00:06<00:06, 103.30 examples/s]
Map:  32%|███▎      | 325/1000 [00:06<00:06, 105.85 examples/s]
Map:  34%|███▎      | 337/1000 [00:06<00:06, 105.21 examples/s]
Map:  35%|███▍      | 348/1000 [00:06<00:06, 104.84 examples/s]
Map:  36%|███▌      | 360/1000 [00:06<00:05, 107.37 examples/s]
Map:  37%|███▋      | 374/1000 [00:06<00:06, 92.93 examples/s] 
Map:  39%|███▊      | 386/1000 [00:06<00:07, 85.41 examples/s]
Map:  40%|███▉      | 398/1000 [00:07<00:07, 78.62 examples/s]
Map:  41%|████      | 409/1000 [00:07<00:08, 71.75 examples/s]
Map:  42%|████▏     | 423/1000 [00:07<00:07, 75.82 examples/s]
Map:  44%|████▎     | 435/1000 [00:07<00:06, 82.77 examples/s]
Map:  45%|████▍     | 447/1000 [00:07<00:06, 88.39 examples/s]
Map:  46%|████▌     | 459/1000 [00:07<00:05, 93.36 examples/s]
Map:  47%|████▋     | 472/1000 [00:07<00:06, 85.19 examples/s]
Map:  48%|████▊     | 485/1000 [00:08<00:06, 80.69 examples/s]
Map:  50%|████▉     | 497/1000 [00:08<00:06, 75.63 examples/s]
Map:  51%|█████     | 506/1000 [00:08<00:06, 76.63 examples/s]
Map:  52%|█████▏    | 518/1000 [00:08<00:05, 84.54 examples/s]
Map:  53%|█████▎    | 531/1000 [00:08<00:05, 80.30 examples/s]
Map:  54%|█████▍    | 543/1000 [00:08<00:05, 86.19 examples/s]
Map:  56%|█████▌    | 555/1000 [00:08<00:04, 93.02 examples/s]
Map:  57%|█████▋    | 566/1000 [00:09<00:04, 95.09 examples/s]
Map:  58%|█████▊    | 577/1000 [00:09<00:04, 96.60 examples/s]
Map:  59%|█████▉    | 590/1000 [00:09<00:03, 102.66 examples/s]
Map:  60%|██████    | 602/1000 [00:09<00:03, 105.40 examples/s]
Map:  61%|██████▏   | 614/1000 [00:09<00:03, 107.98 examples/s]
Map:  63%|██████▎   | 626/1000 [00:09<00:03, 109.61 examples/s]
Map:  64%|██████▍   | 639/1000 [00:09<00:03, 111.92 examples/s]
Map:  65%|██████▌   | 651/1000 [00:09<00:03, 111.69 examples/s]
Map:  66%|██████▋   | 665/1000 [00:09<00:02, 116.09 examples/s]
Map:  68%|██████▊   | 677/1000 [00:09<00:02, 110.91 examples/s]
Map:  69%|██████▉   | 689/1000 [00:10<00:02, 110.65 examples/s]
Map:  71%|███████   | 707/1000 [00:10<00:02, 111.04 examples/s]
Map:  72%|███████▏  | 720/1000 [00:10<00:02, 114.56 examples/s]
Map:  73%|███████▎  | 733/1000 [00:10<00:02, 113.75 examples/s]
Map:  75%|███████▍  | 746/1000 [00:10<00:02, 115.71 examples/s]
Map:  76%|███████▌  | 758/1000 [00:10<00:02, 114.92 examples/s]
Map:  78%|███████▊  | 775/1000 [00:10<00:01, 113.39 examples/s]
Map:  79%|███████▊  | 787/1000 [00:10<00:01, 112.23 examples/s]
Map:  80%|████████  | 800/1000 [00:11<00:01, 111.52 examples/s]
Map:  81%|████████  | 812/1000 [00:11<00:01, 110.59 examples/s]
Map:  82%|████████▏ | 824/1000 [00:11<00:01, 109.42 examples/s]
Map:  84%|████████▎ | 836/1000 [00:11<00:01, 109.05 examples/s]
Map:  85%|████████▍ | 849/1000 [00:11<00:01, 110.02 examples/s]
Map:  86%|████████▌ | 862/1000 [00:11<00:01, 111.34 examples/s]
Map:  87%|████████▋ | 874/1000 [00:11<00:01, 112.51 examples/s]
Map:  89%|████████▊ | 887/1000 [00:11<00:00, 113.65 examples/s]
Map:  90%|█████████ | 901/1000 [00:11<00:00, 117.83 examples/s]
Map:  91%|█████████▏| 913/1000 [00:12<00:00, 114.18 examples/s]
Map:  93%|█████████▎| 926/1000 [00:12<00:00, 114.13 examples/s]
Map:  94%|█████████▍| 938/1000 [00:12<00:00, 114.30 examples/s]
Map:  95%|█████████▌| 952/1000 [00:12<00:00, 119.74 examples/s]
Map:  96%|█████████▋| 964/1000 [00:12<00:00, 117.48 examples/s]
Map:  98%|█████████▊| 976/1000 [00:12<00:00, 114.03 examples/s]
Map:  99%|█████████▉| 990/1000 [00:12<00:00, 118.04 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 32139.52it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▍       | 243/1000 [00:00<00:00, 2423.72it/s]
Logging series metrics to wandb:  49%|████▊     | 486/1000 [00:00<00:00, 2407.75it/s]
Logging series metrics to wandb:  76%|███████▌  | 762/1000 [00:00<00:00, 2566.36it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2580.03it/s]
2024-01-10 19:09:42.937790: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:09:42.993049: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:09:42.993103: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:09:42.994299: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:09:43.001654: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:09:44.373951: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64009.77lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<31:19,  1.88s/ examples]
Map:   1%|          | 8/1000 [00:02<03:05,  5.35 examples/s]
Map:   2%|▏         | 15/1000 [00:02<01:28, 11.08 examples/s]
Map:   2%|▏         | 22/1000 [00:02<00:56, 17.44 examples/s]
Map:   3%|▎         | 30/1000 [00:02<00:37, 25.81 examples/s]
Map:   4%|▍         | 38/1000 [00:02<00:28, 34.20 examples/s]
Map:   5%|▍         | 46/1000 [00:02<00:23, 41.07 examples/s]
Map:   6%|▌         | 55/1000 [00:03<00:39, 24.00 examples/s]
Map:   6%|▋         | 65/1000 [00:03<00:28, 32.62 examples/s]
Map:   8%|▊         | 75/1000 [00:03<00:22, 41.49 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:18, 48.88 examples/s]
Map:   9%|▉         | 93/1000 [00:03<00:16, 55.65 examples/s]
Map:  10%|█         | 104/1000 [00:03<00:13, 64.88 examples/s]
Map:  11%|█▏        | 114/1000 [00:03<00:12, 71.10 examples/s]
Map:  12%|█▎        | 125/1000 [00:04<00:11, 78.10 examples/s]
Map:  14%|█▎        | 135/1000 [00:04<00:10, 81.93 examples/s]
Map:  15%|█▍        | 146/1000 [00:04<00:10, 85.07 examples/s]
Map:  16%|█▌        | 157/1000 [00:04<00:09, 89.95 examples/s]
Map:  17%|█▋        | 169/1000 [00:04<00:08, 93.20 examples/s]
Map:  18%|█▊        | 179/1000 [00:04<00:08, 93.81 examples/s]
Map:  19%|█▉        | 190/1000 [00:04<00:08, 95.21 examples/s]
Map:  20%|██        | 202/1000 [00:04<00:07, 100.01 examples/s]
Map:  22%|██▏       | 218/1000 [00:04<00:07, 98.58 examples/s] 
Map:  23%|██▎       | 229/1000 [00:05<00:07, 97.33 examples/s]
Map:  24%|██▍       | 240/1000 [00:05<00:07, 97.87 examples/s]
Map:  25%|██▌       | 253/1000 [00:05<00:07, 102.42 examples/s]
Map:  27%|██▋       | 268/1000 [00:05<00:06, 112.12 examples/s]
Map:  28%|██▊       | 283/1000 [00:05<00:05, 120.36 examples/s]
Map:  30%|██▉       | 298/1000 [00:05<00:05, 126.62 examples/s]
Map:  31%|███       | 312/1000 [00:05<00:05, 127.60 examples/s]
Map:  33%|███▎      | 329/1000 [00:05<00:04, 135.21 examples/s]
Map:  34%|███▍      | 345/1000 [00:05<00:04, 141.14 examples/s]
Map:  36%|███▌      | 360/1000 [00:06<00:04, 140.54 examples/s]
Map:  38%|███▊      | 375/1000 [00:06<00:04, 139.68 examples/s]
Map:  39%|███▉      | 390/1000 [00:06<00:04, 140.16 examples/s]
Map:  41%|████      | 411/1000 [00:06<00:04, 137.40 examples/s]
Map:  43%|████▎     | 426/1000 [00:06<00:04, 138.40 examples/s]
Map:  44%|████▍     | 441/1000 [00:06<00:03, 140.68 examples/s]
Map:  46%|████▌     | 456/1000 [00:06<00:03, 139.33 examples/s]
Map:  47%|████▋     | 473/1000 [00:06<00:03, 142.77 examples/s]
Map:  49%|████▉     | 491/1000 [00:06<00:03, 149.03 examples/s]
Map:  51%|█████     | 508/1000 [00:07<00:03, 153.91 examples/s]
Map:  52%|█████▎    | 525/1000 [00:07<00:03, 154.34 examples/s]
Map:  55%|█████▍    | 548/1000 [00:07<00:02, 151.68 examples/s]
Map:  56%|█████▋    | 565/1000 [00:07<00:02, 153.44 examples/s]
Map:  58%|█████▊    | 582/1000 [00:07<00:02, 155.46 examples/s]
Map:  60%|██████    | 600/1000 [00:07<00:02, 159.27 examples/s]
Map:  62%|██████▏   | 617/1000 [00:07<00:02, 159.63 examples/s]
Map:  63%|██████▎   | 634/1000 [00:07<00:02, 159.02 examples/s]
Map:  65%|██████▌   | 650/1000 [00:07<00:02, 156.25 examples/s]
Map:  67%|██████▋   | 668/1000 [00:08<00:02, 161.13 examples/s]
Map:  69%|██████▉   | 691/1000 [00:08<00:01, 155.90 examples/s]
Map:  71%|███████   | 709/1000 [00:08<00:01, 158.74 examples/s]
Map:  73%|███████▎  | 726/1000 [00:08<00:01, 158.21 examples/s]
Map:  75%|███████▍  | 746/1000 [00:08<00:01, 145.63 examples/s]
Map:  76%|███████▋  | 763/1000 [00:08<00:01, 130.32 examples/s]
Map:  78%|███████▊  | 779/1000 [00:08<00:01, 134.64 examples/s]
Map:  80%|███████▉  | 795/1000 [00:08<00:01, 140.07 examples/s]
Map:  81%|████████  | 812/1000 [00:09<00:01, 144.29 examples/s]
Map:  83%|████████▎ | 828/1000 [00:09<00:01, 147.25 examples/s]
Map:  84%|████████▍ | 844/1000 [00:09<00:01, 148.41 examples/s]
Map:  86%|████████▌ | 861/1000 [00:09<00:00, 152.61 examples/s]
Map:  88%|████████▊ | 878/1000 [00:09<00:00, 156.70 examples/s]
Map:  90%|████████▉ | 895/1000 [00:09<00:00, 159.11 examples/s]
Map:  91%|█████████▏| 913/1000 [00:09<00:00, 160.35 examples/s]
Map:  94%|█████████▍| 938/1000 [00:09<00:00, 158.50 examples/s]
Map:  96%|█████████▌| 956/1000 [00:09<00:00, 160.92 examples/s]
Map:  98%|█████████▊| 979/1000 [00:10<00:00, 156.41 examples/s]
Map: 100%|█████████▉| 996/1000 [00:10<00:00, 156.32 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47618.17it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  36%|███▋      | 363/1000 [00:00<00:00, 3625.22it/s]
Logging series metrics to wandb:  73%|███████▎  | 726/1000 [00:00<00:00, 3598.30it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3606.68it/s]
2024-01-10 19:10:30.056404: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:10:30.104450: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:10:30.104503: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:10:30.105673: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:10:30.112625: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:10:31.350765: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60723.65lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<24:17,  1.46s/ examples]
Map:   1%|          | 8/1000 [00:01<02:27,  6.74 examples/s]
Map:   2%|▏         | 16/1000 [00:01<01:07, 14.58 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:43, 22.41 examples/s]
Map:   3%|▎         | 32/1000 [00:01<00:31, 31.09 examples/s]
Map:   4%|▍         | 40/1000 [00:02<00:24, 38.84 examples/s]
Map:   5%|▍         | 47/1000 [00:02<00:21, 43.96 examples/s]
Map:   6%|▌         | 55/1000 [00:02<00:36, 25.99 examples/s]
Map:   6%|▋         | 65/1000 [00:02<00:26, 35.38 examples/s]
Map:   7%|▋         | 74/1000 [00:02<00:21, 43.83 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:17, 52.56 examples/s]
Map:   9%|▉         | 93/1000 [00:03<00:15, 59.03 examples/s]
Map:  10%|█         | 103/1000 [00:03<00:13, 66.78 examples/s]
Map:  11%|█▏        | 113/1000 [00:03<00:12, 71.68 examples/s]
Map:  12%|█▏        | 123/1000 [00:03<00:11, 76.21 examples/s]
Map:  13%|█▎        | 134/1000 [00:03<00:10, 81.48 examples/s]
Map:  14%|█▍        | 144/1000 [00:03<00:10, 84.43 examples/s]
Map:  16%|█▌        | 156/1000 [00:03<00:09, 89.04 examples/s]
Map:  17%|█▋        | 167/1000 [00:03<00:08, 93.06 examples/s]
Map:  18%|█▊        | 178/1000 [00:04<00:08, 93.53 examples/s]
Map:  19%|█▉        | 189/1000 [00:04<00:08, 95.53 examples/s]
Map:  20%|██        | 201/1000 [00:04<00:08, 99.32 examples/s]
Map:  21%|██        | 212/1000 [00:04<00:07, 99.27 examples/s]
Map:  22%|██▏       | 224/1000 [00:04<00:07, 101.84 examples/s]
Map:  24%|██▎       | 235/1000 [00:04<00:07, 101.47 examples/s]
Map:  25%|██▍       | 246/1000 [00:04<00:07, 102.47 examples/s]
Map:  26%|██▌       | 259/1000 [00:04<00:06, 106.61 examples/s]
Map:  27%|██▋       | 271/1000 [00:04<00:06, 105.68 examples/s]
Map:  28%|██▊       | 283/1000 [00:05<00:06, 107.21 examples/s]
Map:  30%|██▉       | 295/1000 [00:05<00:06, 108.76 examples/s]
Map:  31%|███       | 307/1000 [00:05<00:06, 107.17 examples/s]
Map:  32%|███▏      | 318/1000 [00:05<00:06, 104.88 examples/s]
Map:  33%|███▎      | 331/1000 [00:05<00:06, 108.37 examples/s]
Map:  34%|███▍      | 342/1000 [00:05<00:06, 104.75 examples/s]
Map:  35%|███▌      | 354/1000 [00:05<00:06, 104.65 examples/s]
Map:  37%|███▋      | 366/1000 [00:05<00:05, 106.44 examples/s]
Map:  38%|███▊      | 378/1000 [00:05<00:05, 106.69 examples/s]
Map:  39%|███▉      | 390/1000 [00:06<00:05, 107.26 examples/s]
Map:  40%|████      | 402/1000 [00:06<00:05, 106.06 examples/s]
Map:  41%|████▏     | 413/1000 [00:06<00:05, 103.60 examples/s]
Map:  42%|████▎     | 425/1000 [00:06<00:05, 105.65 examples/s]
Map:  44%|████▎     | 437/1000 [00:06<00:05, 105.22 examples/s]
Map:  45%|████▍     | 448/1000 [00:06<00:05, 104.14 examples/s]
Map:  46%|████▌     | 460/1000 [00:06<00:05, 107.52 examples/s]
Map:  47%|████▋     | 472/1000 [00:06<00:04, 109.73 examples/s]
Map:  48%|████▊     | 484/1000 [00:06<00:04, 109.25 examples/s]
Map:  50%|████▉     | 496/1000 [00:07<00:04, 109.64 examples/s]
Map:  51%|█████     | 509/1000 [00:07<00:04, 113.05 examples/s]
Map:  52%|█████▏    | 522/1000 [00:07<00:04, 114.73 examples/s]
Map:  53%|█████▎    | 534/1000 [00:07<00:04, 114.87 examples/s]
Map:  55%|█████▍    | 546/1000 [00:07<00:04, 112.29 examples/s]
Map:  56%|█████▌    | 558/1000 [00:07<00:03, 112.02 examples/s]
Map:  58%|█████▊    | 576/1000 [00:07<00:03, 112.00 examples/s]
Map:  59%|█████▉    | 589/1000 [00:07<00:03, 114.05 examples/s]
Map:  60%|██████    | 602/1000 [00:07<00:03, 115.56 examples/s]
Map:  61%|██████▏   | 614/1000 [00:08<00:03, 115.11 examples/s]
Map:  63%|██████▎   | 627/1000 [00:08<00:03, 116.10 examples/s]
Map:  64%|██████▍   | 640/1000 [00:08<00:03, 117.12 examples/s]
Map:  65%|██████▌   | 652/1000 [00:08<00:02, 116.17 examples/s]
Map:  67%|██████▋   | 666/1000 [00:08<00:02, 121.86 examples/s]
Map:  68%|██████▊   | 685/1000 [00:08<00:02, 119.70 examples/s]
Map:  70%|██████▉   | 698/1000 [00:08<00:02, 121.08 examples/s]
Map:  71%|███████   | 711/1000 [00:08<00:02, 121.36 examples/s]
Map:  72%|███████▏  | 724/1000 [00:08<00:02, 120.85 examples/s]
Map:  74%|███████▎  | 737/1000 [00:09<00:02, 119.59 examples/s]
Map:  75%|███████▌  | 750/1000 [00:09<00:02, 118.75 examples/s]
Map:  76%|███████▌  | 762/1000 [00:09<00:02, 117.08 examples/s]
Map:  77%|███████▋  | 774/1000 [00:09<00:01, 115.11 examples/s]
Map:  79%|███████▊  | 786/1000 [00:09<00:01, 114.69 examples/s]
Map:  80%|███████▉  | 799/1000 [00:09<00:01, 114.59 examples/s]
Map:  81%|████████  | 811/1000 [00:09<00:01, 113.45 examples/s]
Map:  82%|████████▏ | 824/1000 [00:09<00:01, 114.87 examples/s]
Map:  84%|████████▎ | 837/1000 [00:09<00:01, 116.20 examples/s]
Map:  85%|████████▌ | 850/1000 [00:10<00:01, 114.55 examples/s]
Map:  86%|████████▋ | 864/1000 [00:10<00:01, 118.97 examples/s]
Map:  88%|████████▊ | 879/1000 [00:10<00:00, 125.37 examples/s]
Map:  90%|████████▉ | 896/1000 [00:10<00:00, 134.26 examples/s]
Map:  91%|█████████▏| 913/1000 [00:10<00:00, 139.04 examples/s]
Map:  93%|█████████▎| 928/1000 [00:10<00:00, 139.19 examples/s]
Map:  94%|█████████▍| 944/1000 [00:10<00:00, 142.83 examples/s]
Map:  96%|█████████▌| 961/1000 [00:10<00:00, 148.71 examples/s]
Map:  98%|█████████▊| 977/1000 [00:10<00:00, 149.39 examples/s]
Map: 100%|█████████▉| 995/1000 [00:11<00:00, 155.06 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 45728.44it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  30%|███       | 300/1000 [00:00<00:00, 2984.52it/s]
Logging series metrics to wandb:  60%|██████    | 601/1000 [00:00<00:00, 2995.69it/s]
Logging series metrics to wandb:  94%|█████████▎| 936/1000 [00:00<00:00, 3156.26it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3131.86it/s]
2024-01-10 19:11:16.941876: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:11:16.995575: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:11:16.995640: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:11:16.996891: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:11:17.004451: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:11:18.567429: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56749.57lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<29:47,  1.79s/ examples]
Map:   1%|          | 8/1000 [00:01<02:58,  5.57 examples/s]
Map:   2%|▏         | 15/1000 [00:02<01:26, 11.40 examples/s]
Map:   2%|▏         | 21/1000 [00:02<00:58, 16.78 examples/s]
Map:   3%|▎         | 28/1000 [00:02<00:40, 23.76 examples/s]
Map:   4%|▎         | 36/1000 [00:02<00:30, 32.03 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:24, 39.28 examples/s]
Map:   5%|▌         | 51/1000 [00:03<00:48, 19.38 examples/s]
Map:   6%|▌         | 58/1000 [00:03<00:37, 24.81 examples/s]
Map:   7%|▋         | 67/1000 [00:03<00:28, 32.69 examples/s]
Map:   8%|▊         | 76/1000 [00:03<00:22, 40.98 examples/s]
Map:   8%|▊         | 85/1000 [00:03<00:18, 48.39 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:16, 55.26 examples/s]
Map:  10%|█         | 105/1000 [00:03<00:13, 64.40 examples/s]
Map:  11%|█▏        | 114/1000 [00:04<00:12, 69.32 examples/s]
Map:  12%|█▎        | 125/1000 [00:04<00:11, 76.90 examples/s]
Map:  14%|█▍        | 138/1000 [00:04<00:09, 88.47 examples/s]
Map:  15%|█▌        | 153/1000 [00:04<00:08, 101.64 examples/s]
Map:  17%|█▋        | 167/1000 [00:04<00:07, 109.74 examples/s]
Map:  18%|█▊        | 181/1000 [00:04<00:07, 112.95 examples/s]
Map:  20%|█▉        | 195/1000 [00:04<00:06, 118.88 examples/s]
Map:  21%|██        | 210/1000 [00:04<00:06, 123.09 examples/s]
Map:  22%|██▏       | 223/1000 [00:04<00:06, 122.92 examples/s]
Map:  24%|██▎       | 237/1000 [00:05<00:06, 122.66 examples/s]
Map:  25%|██▌       | 253/1000 [00:05<00:05, 128.80 examples/s]
Map:  27%|██▋       | 270/1000 [00:05<00:05, 136.45 examples/s]
Map:  29%|██▊       | 286/1000 [00:05<00:05, 140.09 examples/s]
Map:  30%|███       | 301/1000 [00:05<00:05, 139.18 examples/s]
Map:  32%|███▏      | 316/1000 [00:05<00:04, 137.18 examples/s]
Map:  33%|███▎      | 333/1000 [00:05<00:04, 143.04 examples/s]
Map:  35%|███▌      | 354/1000 [00:05<00:04, 137.76 examples/s]
Map:  37%|███▋      | 370/1000 [00:05<00:04, 139.14 examples/s]
Map:  38%|███▊      | 385/1000 [00:06<00:04, 138.69 examples/s]
Map:  40%|████      | 402/1000 [00:06<00:04, 122.92 examples/s]
Map:  42%|████▏     | 421/1000 [00:06<00:04, 118.19 examples/s]
Map:  44%|████▎     | 436/1000 [00:06<00:04, 124.27 examples/s]
Map:  45%|████▍     | 449/1000 [00:06<00:04, 125.36 examples/s]
Map:  47%|████▋     | 466/1000 [00:06<00:04, 132.31 examples/s]
Map:  48%|████▊     | 482/1000 [00:06<00:03, 137.07 examples/s]
Map:  50%|████▉     | 497/1000 [00:06<00:03, 138.21 examples/s]
Map:  52%|█████▏    | 515/1000 [00:07<00:03, 147.15 examples/s]
Map:  53%|█████▎    | 531/1000 [00:07<00:03, 148.56 examples/s]
Map:  55%|█████▍    | 547/1000 [00:07<00:03, 148.12 examples/s]
Map:  56%|█████▋    | 564/1000 [00:07<00:02, 152.44 examples/s]
Map:  58%|█████▊    | 581/1000 [00:07<00:02, 157.06 examples/s]
Map:  60%|█████▉    | 598/1000 [00:07<00:02, 157.44 examples/s]
Map:  61%|██████▏   | 614/1000 [00:07<00:02, 153.92 examples/s]
Map:  63%|██████▎   | 630/1000 [00:07<00:02, 150.37 examples/s]
Map:  65%|██████▌   | 651/1000 [00:08<00:02, 140.97 examples/s]
Map:  67%|██████▋   | 668/1000 [00:08<00:02, 123.92 examples/s]
Map:  68%|██████▊   | 681/1000 [00:08<00:02, 109.22 examples/s]
Map:  70%|██████▉   | 696/1000 [00:08<00:03, 101.09 examples/s]
Map:  71%|███████   | 707/1000 [00:08<00:02, 99.20 examples/s] 
Map:  72%|███████▏  | 723/1000 [00:08<00:02, 111.80 examples/s]
Map:  74%|███████▍  | 739/1000 [00:08<00:02, 123.10 examples/s]
Map:  76%|███████▌  | 756/1000 [00:08<00:01, 132.53 examples/s]
Map:  77%|███████▋  | 772/1000 [00:09<00:01, 138.01 examples/s]
Map:  79%|███████▉  | 789/1000 [00:09<00:01, 143.50 examples/s]
Map:  80%|████████  | 804/1000 [00:09<00:01, 139.38 examples/s]
Map:  82%|████████▏ | 822/1000 [00:09<00:01, 146.25 examples/s]
Map:  84%|████████▍ | 839/1000 [00:09<00:01, 149.94 examples/s]
Map:  86%|████████▌ | 856/1000 [00:09<00:00, 151.37 examples/s]
Map:  87%|████████▋ | 873/1000 [00:09<00:00, 153.53 examples/s]
Map:  89%|████████▉ | 891/1000 [00:09<00:00, 156.55 examples/s]
Map:  91%|█████████▏| 914/1000 [00:09<00:00, 153.03 examples/s]
Map:  93%|█████████▎| 930/1000 [00:10<00:00, 151.93 examples/s]
Map:  95%|█████████▍| 948/1000 [00:10<00:00, 156.79 examples/s]
Map:  96%|█████████▋| 964/1000 [00:10<00:00, 155.21 examples/s]
Map:  99%|█████████▉| 988/1000 [00:10<00:00, 154.98 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 45267.97it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  36%|███▋      | 364/1000 [00:00<00:00, 3633.82it/s]
Logging series metrics to wandb:  73%|███████▎  | 728/1000 [00:00<00:00, 3561.48it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3491.40it/s]
2024-01-10 19:12:05.257795: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:12:05.308446: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:12:05.308494: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:12:05.309723: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:12:05.317215: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:12:06.644921: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61299.62lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 23/1000 [00:00<00:04, 212.41 examples/s]
Map:   5%|▍         | 47/1000 [00:00<00:04, 218.76 examples/s]
Map:   7%|▋         | 72/1000 [00:00<00:04, 227.59 examples/s]
Map:  10%|▉         | 97/1000 [00:00<00:03, 231.86 examples/s]
Map:  12%|█▏        | 121/1000 [00:00<00:03, 230.77 examples/s]
Map:  15%|█▍        | 146/1000 [00:00<00:03, 234.48 examples/s]
Map:  18%|█▊        | 181/1000 [00:00<00:03, 229.90 examples/s]
Map:  20%|██        | 205/1000 [00:00<00:03, 229.52 examples/s]
Map:  23%|██▎       | 231/1000 [00:01<00:03, 233.72 examples/s]
Map:  26%|██▌       | 256/1000 [00:01<00:03, 234.04 examples/s]
Map:  28%|██▊       | 281/1000 [00:01<00:03, 235.47 examples/s]
Map:  30%|███       | 305/1000 [00:01<00:02, 235.25 examples/s]
Map:  33%|███▎      | 331/1000 [00:01<00:02, 238.76 examples/s]
Map:  36%|███▌      | 355/1000 [00:01<00:02, 236.33 examples/s]
Map:  38%|███▊      | 380/1000 [00:01<00:02, 236.55 examples/s]
Map:  40%|████      | 405/1000 [00:01<00:02, 235.91 examples/s]
Map:  44%|████▍     | 441/1000 [00:01<00:02, 233.07 examples/s]
Map:  47%|████▋     | 466/1000 [00:02<00:02, 232.45 examples/s]
Map:  49%|████▉     | 490/1000 [00:02<00:02, 230.77 examples/s]
Map:  51%|█████▏    | 514/1000 [00:02<00:02, 230.10 examples/s]
Map:  54%|█████▍    | 540/1000 [00:02<00:01, 234.73 examples/s]
Map:  56%|█████▋    | 565/1000 [00:02<00:01, 235.37 examples/s]
Map:  59%|█████▉    | 589/1000 [00:02<00:01, 235.59 examples/s]
Map:  61%|██████▏   | 613/1000 [00:02<00:01, 235.51 examples/s]
Map:  65%|██████▍   | 648/1000 [00:02<00:01, 233.63 examples/s]
Map:  67%|██████▋   | 673/1000 [00:02<00:01, 236.09 examples/s]
Map:  70%|██████▉   | 697/1000 [00:02<00:01, 235.00 examples/s]
Map:  72%|███████▏  | 722/1000 [00:03<00:01, 236.63 examples/s]
Map:  75%|███████▌  | 753/1000 [00:03<00:01, 223.65 examples/s]
Map:  79%|███████▊  | 786/1000 [00:03<00:00, 217.54 examples/s]
Map:  81%|████████  | 810/1000 [00:03<00:00, 221.30 examples/s]
Map:  83%|████████▎ | 833/1000 [00:03<00:00, 221.39 examples/s]
Map:  86%|████████▌ | 857/1000 [00:03<00:00, 224.05 examples/s]
Map:  88%|████████▊ | 880/1000 [00:03<00:00, 224.94 examples/s]
Map:  90%|█████████ | 904/1000 [00:03<00:00, 227.72 examples/s]
Map:  93%|█████████▎| 929/1000 [00:04<00:00, 229.57 examples/s]
Map:  96%|█████████▌| 962/1000 [00:04<00:00, 221.52 examples/s]
Map:  99%|█████████▉| 994/1000 [00:04<00:00, 212.82 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 26546.23it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  33%|███▎      | 332/1000 [00:00<00:00, 3312.71it/s]
Logging series metrics to wandb:  68%|██████▊   | 679/1000 [00:00<00:00, 3399.93it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3267.89it/s]
2024-01-10 19:12:46.417897: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:12:46.467773: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:12:46.467840: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:12:46.468991: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:12:46.475999: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:12:47.964566: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 54331.77lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   6%|▋         | 64/1000 [00:00<00:01, 619.23 examples/s]
Map:  14%|█▍        | 141/1000 [00:00<00:01, 705.80 examples/s]
Map:  28%|██▊       | 278/1000 [00:00<00:00, 1002.43 examples/s]
Map:  42%|████▏     | 424/1000 [00:00<00:00, 1178.84 examples/s]
Map:  57%|█████▋    | 571/1000 [00:00<00:00, 1278.94 examples/s]
Map:  71%|███████   | 711/1000 [00:00<00:00, 1315.80 examples/s]
Map:  85%|████████▌ | 854/1000 [00:00<00:00, 1350.53 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1242.09 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 36015.90it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 255/1000 [00:00<00:00, 2546.14it/s]
Logging series metrics to wandb:  52%|█████▏    | 523/1000 [00:00<00:00, 2620.08it/s]
Logging series metrics to wandb:  80%|████████  | 804/1000 [00:00<00:00, 2703.40it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2658.26it/s]
2024-01-10 19:13:25.987849: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:13:26.039961: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:13:26.040056: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:13:26.041470: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:13:26.050058: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:13:27.513405: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60984.99lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  13%|█▎        | 131/1000 [00:00<00:00, 1287.65 examples/s]
Map:  28%|██▊       | 275/1000 [00:00<00:00, 1373.17 examples/s]
Map:  42%|████▎     | 425/1000 [00:00<00:00, 1423.91 examples/s]
Map:  57%|█████▋    | 570/1000 [00:00<00:00, 1430.18 examples/s]
Map:  73%|███████▎  | 726/1000 [00:00<00:00, 1473.57 examples/s]
Map:  92%|█████████▏| 916/1000 [00:00<00:00, 1203.95 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 20036.99it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  17%|█▋        | 171/1000 [00:00<00:00, 1704.01it/s]
Logging series metrics to wandb:  43%|████▎     | 434/1000 [00:00<00:00, 2243.95it/s]
Logging series metrics to wandb:  68%|██████▊   | 680/1000 [00:00<00:00, 2338.29it/s]
Logging series metrics to wandb:  94%|█████████▍| 945/1000 [00:00<00:00, 2457.48it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2371.96it/s]
2024-01-10 19:14:04.584675: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:14:04.636493: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:14:04.636641: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:14:04.638416: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:14:04.646197: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:14:06.168664: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64536.69lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  22%|██▏       | 216/1000 [00:00<00:00, 2129.81 examples/s]
Map:  45%|████▍     | 448/1000 [00:00<00:00, 2236.86 examples/s]
Map:  68%|██████▊   | 685/1000 [00:00<00:00, 2292.71 examples/s]
Map:  92%|█████████▏| 916/1000 [00:00<00:00, 2293.30 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 21849.54it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 271/1000 [00:00<00:00, 2708.40it/s]
Logging series metrics to wandb:  55%|█████▌    | 554/1000 [00:00<00:00, 2777.27it/s]
Logging series metrics to wandb:  83%|████████▎ | 832/1000 [00:00<00:00, 2760.87it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2746.86it/s]
2024-01-10 19:14:42.601541: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:14:42.660926: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:14:42.661014: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:14:42.662474: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:14:42.671090: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:14:44.308648: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56144.14lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  15%|█▍        | 149/1000 [00:00<00:00, 1468.62 examples/s]
Map:  31%|███       | 311/1000 [00:00<00:00, 1549.77 examples/s]
Map:  48%|████▊     | 475/1000 [00:00<00:00, 1587.06 examples/s]
Map:  65%|██████▍   | 646/1000 [00:00<00:00, 1631.57 examples/s]
Map:  81%|████████  | 810/1000 [00:00<00:00, 1628.55 examples/s]
Map:  98%|█████████▊| 976/1000 [00:00<00:00, 1634.91 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35718.70it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▋       | 264/1000 [00:00<00:00, 2633.42it/s]
Logging series metrics to wandb:  54%|█████▍    | 544/1000 [00:00<00:00, 2730.48it/s]
Logging series metrics to wandb:  82%|████████▏ | 819/1000 [00:00<00:00, 2738.47it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2747.43it/s]
finish opt
2024-01-10 19:15:20.844248: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:15:20.895671: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:15:20.895728: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:15:20.896913: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:15:20.904035: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:15:22.492664: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 59718.15lines/s]
Running swap attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  13%|█▎        | 134/1000 [00:00<00:00, 1320.78 examples/s]
Map:  29%|██▊       | 287/1000 [00:00<00:00, 1436.72 examples/s]
Map:  44%|████▎     | 435/1000 [00:00<00:00, 1456.29 examples/s]
Map:  58%|█████▊    | 581/1000 [00:00<00:00, 1455.44 examples/s]
Map:  74%|███████▎  | 737/1000 [00:00<00:00, 1489.34 examples/s]
Map:  96%|█████████▌| 958/1000 [00:00<00:00, 1479.68 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 39868.67it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 272/1000 [00:00<00:00, 2713.15it/s]
Logging series metrics to wandb:  56%|█████▌    | 555/1000 [00:00<00:00, 2779.37it/s]
Logging series metrics to wandb:  84%|████████▍ | 840/1000 [00:00<00:00, 2810.54it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2799.44it/s]
2024-01-10 19:15:59.263380: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:15:59.310714: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:15:59.310772: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:15:59.311899: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:15:59.318631: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:16:00.471620: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 51270.10lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<24:32,  1.47s/ examples]
Map:   1%|          | 7/1000 [00:01<02:49,  5.86 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:24, 11.71 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:47, 20.76 examples/s]
Map:   3%|▎         | 29/1000 [00:01<00:32, 30.04 examples/s]
Map:   4%|▍         | 38/1000 [00:02<00:24, 38.79 examples/s]
Map:   5%|▍         | 49/1000 [00:02<00:37, 25.55 examples/s]
Map:   6%|▌         | 59/1000 [00:02<00:27, 33.88 examples/s]
Map:   7%|▋         | 69/1000 [00:02<00:21, 42.75 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:16, 54.97 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:13, 68.99 examples/s]
Map:  11%|█         | 108/1000 [00:03<00:10, 83.26 examples/s]
Map:  12%|█▏        | 124/1000 [00:03<00:08, 99.98 examples/s]
Map:  14%|█▍        | 140/1000 [00:03<00:07, 111.86 examples/s]
Map:  16%|█▌        | 156/1000 [00:03<00:06, 121.27 examples/s]
Map:  17%|█▋        | 174/1000 [00:03<00:06, 133.22 examples/s]
Map:  19%|█▉        | 189/1000 [00:03<00:05, 135.27 examples/s]
Map:  21%|██        | 206/1000 [00:03<00:05, 141.84 examples/s]
Map:  22%|██▏       | 223/1000 [00:03<00:05, 148.37 examples/s]
Map:  24%|██▍       | 240/1000 [00:04<00:05, 151.28 examples/s]
Map:  26%|██▌       | 257/1000 [00:04<00:04, 154.41 examples/s]
Map:  27%|██▋       | 274/1000 [00:04<00:04, 154.62 examples/s]
Map:  29%|██▉       | 291/1000 [00:04<00:04, 157.58 examples/s]
Map:  31%|███       | 309/1000 [00:04<00:04, 161.16 examples/s]
Map:  33%|███▎      | 333/1000 [00:04<00:04, 159.98 examples/s]
Map:  35%|███▌      | 350/1000 [00:04<00:04, 159.27 examples/s]
Map:  37%|███▋      | 369/1000 [00:04<00:03, 165.76 examples/s]
Map:  39%|███▉      | 389/1000 [00:04<00:03, 171.29 examples/s]
Map:  41%|████      | 407/1000 [00:05<00:03, 171.14 examples/s]
Map:  42%|████▎     | 425/1000 [00:05<00:03, 171.48 examples/s]
Map:  44%|████▍     | 443/1000 [00:05<00:03, 172.86 examples/s]
Map:  46%|████▌     | 461/1000 [00:05<00:03, 171.52 examples/s]
Map:  48%|████▊     | 480/1000 [00:05<00:03, 173.33 examples/s]
Map:  50%|████▉     | 498/1000 [00:05<00:02, 174.81 examples/s]
Map:  52%|█████▏    | 518/1000 [00:05<00:02, 176.51 examples/s]
Map:  54%|█████▍    | 538/1000 [00:05<00:02, 181.30 examples/s]
Map:  56%|█████▌    | 558/1000 [00:05<00:02, 183.02 examples/s]
Map:  58%|█████▊    | 577/1000 [00:06<00:02, 179.13 examples/s]
Map:  60%|█████▉    | 597/1000 [00:06<00:02, 180.78 examples/s]
Map:  62%|██████▏   | 616/1000 [00:06<00:02, 181.14 examples/s]
Map:  64%|██████▎   | 636/1000 [00:06<00:01, 184.18 examples/s]
Map:  66%|██████▌   | 657/1000 [00:06<00:01, 188.36 examples/s]
Map:  68%|██████▊   | 677/1000 [00:06<00:01, 188.21 examples/s]
Map:  70%|██████▉   | 698/1000 [00:06<00:01, 193.23 examples/s]
Map:  72%|███████▏  | 719/1000 [00:06<00:01, 195.59 examples/s]
Map:  74%|███████▍  | 739/1000 [00:06<00:01, 193.13 examples/s]
Map:  76%|███████▌  | 759/1000 [00:06<00:01, 191.94 examples/s]
Map:  78%|███████▊  | 780/1000 [00:07<00:01, 193.74 examples/s]
Map:  80%|████████  | 801/1000 [00:07<00:01, 195.81 examples/s]
Map:  82%|████████▏ | 821/1000 [00:07<00:00, 195.43 examples/s]
Map:  84%|████████▍ | 841/1000 [00:07<00:00, 195.03 examples/s]
Map:  86%|████████▌ | 861/1000 [00:07<00:00, 195.00 examples/s]
Map:  89%|████████▉ | 891/1000 [00:07<00:00, 192.20 examples/s]
Map:  91%|█████████ | 911/1000 [00:07<00:00, 191.96 examples/s]
Map:  93%|█████████▎| 932/1000 [00:07<00:00, 193.53 examples/s]
Map:  95%|█████████▌| 953/1000 [00:07<00:00, 195.78 examples/s]
Map:  97%|█████████▋| 973/1000 [00:08<00:00, 195.42 examples/s]
Map:  99%|█████████▉| 994/1000 [00:08<00:00, 198.26 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 54210.99it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  40%|████      | 401/1000 [00:00<00:00, 4004.86it/s]
Logging series metrics to wandb:  81%|████████  | 810/1000 [00:00<00:00, 4049.26it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 4037.08it/s]
2024-01-10 19:16:39.416345: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:16:39.450862: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:16:39.450914: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:16:39.451793: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:16:39.456897: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:16:40.380549: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 66393.93lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<28:28,  1.71s/ examples]
Map:   1%|          | 6/1000 [00:01<03:48,  4.36 examples/s]
Map:   1%|          | 12/1000 [00:01<01:43,  9.58 examples/s]
Map:   2%|▏         | 19/1000 [00:02<00:58, 16.70 examples/s]
Map:   3%|▎         | 28/1000 [00:02<00:36, 26.72 examples/s]
Map:   4%|▎         | 36/1000 [00:02<00:27, 34.60 examples/s]
Map:   4%|▍         | 44/1000 [00:03<00:51, 18.55 examples/s]
Map:   5%|▌         | 52/1000 [00:03<00:38, 24.64 examples/s]
Map:   6%|▌         | 61/1000 [00:03<00:28, 32.87 examples/s]
Map:   7%|▋         | 70/1000 [00:03<00:22, 40.70 examples/s]
Map:   8%|▊         | 79/1000 [00:03<00:19, 48.29 examples/s]
Map:   9%|▉         | 88/1000 [00:03<00:16, 55.48 examples/s]
Map:  10%|▉         | 98/1000 [00:03<00:14, 62.90 examples/s]
Map:  11%|█         | 107/1000 [00:03<00:13, 67.74 examples/s]
Map:  12%|█▏        | 118/1000 [00:03<00:11, 75.38 examples/s]
Map:  13%|█▎        | 130/1000 [00:04<00:10, 84.56 examples/s]
Map:  14%|█▍        | 140/1000 [00:04<00:09, 86.73 examples/s]
Map:  15%|█▌        | 150/1000 [00:04<00:09, 88.42 examples/s]
Map:  16%|█▌        | 161/1000 [00:04<00:09, 90.89 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:08, 97.64 examples/s]
Map:  19%|█▊        | 186/1000 [00:04<00:08, 100.08 examples/s]
Map:  20%|█▉        | 197/1000 [00:04<00:07, 102.15 examples/s]
Map:  21%|██        | 209/1000 [00:04<00:07, 105.25 examples/s]
Map:  22%|██▏       | 221/1000 [00:04<00:07, 106.62 examples/s]
Map:  23%|██▎       | 233/1000 [00:05<00:07, 106.73 examples/s]
Map:  24%|██▍       | 245/1000 [00:05<00:07, 106.53 examples/s]
Map:  26%|██▌       | 256/1000 [00:05<00:07, 106.00 examples/s]
Map:  27%|██▋       | 268/1000 [00:05<00:06, 105.16 examples/s]
Map:  28%|██▊       | 280/1000 [00:05<00:06, 105.53 examples/s]
Map:  29%|██▉       | 292/1000 [00:05<00:06, 107.84 examples/s]
Map:  30%|███       | 304/1000 [00:05<00:06, 108.20 examples/s]
Map:  32%|███▏      | 315/1000 [00:05<00:06, 107.80 examples/s]
Map:  33%|███▎      | 327/1000 [00:05<00:06, 106.69 examples/s]
Map:  34%|███▍      | 339/1000 [00:06<00:06, 106.03 examples/s]
Map:  35%|███▌      | 351/1000 [00:06<00:05, 108.31 examples/s]
Map:  36%|███▋      | 363/1000 [00:06<00:05, 109.43 examples/s]
Map:  38%|███▊      | 376/1000 [00:06<00:05, 111.69 examples/s]
Map:  39%|███▉      | 389/1000 [00:06<00:05, 112.07 examples/s]
Map:  40%|████      | 401/1000 [00:06<00:05, 111.57 examples/s]
Map:  41%|████▏     | 413/1000 [00:06<00:05, 110.66 examples/s]
Map:  42%|████▎     | 425/1000 [00:06<00:05, 111.11 examples/s]
Map:  44%|████▍     | 438/1000 [00:06<00:04, 112.90 examples/s]
Map:  45%|████▌     | 451/1000 [00:07<00:04, 115.24 examples/s]
Map:  46%|████▋     | 463/1000 [00:07<00:04, 115.21 examples/s]
Map:  48%|████▊     | 477/1000 [00:07<00:04, 118.28 examples/s]
Map:  49%|████▉     | 490/1000 [00:07<00:04, 119.03 examples/s]
Map:  50%|█████     | 502/1000 [00:07<00:04, 117.16 examples/s]
Map:  52%|█████▏    | 516/1000 [00:07<00:04, 120.07 examples/s]
Map:  53%|█████▎    | 531/1000 [00:07<00:03, 125.56 examples/s]
Map:  55%|█████▍    | 545/1000 [00:07<00:03, 126.99 examples/s]
Map:  56%|█████▌    | 559/1000 [00:07<00:03, 127.96 examples/s]
Map:  57%|█████▋    | 572/1000 [00:08<00:03, 126.44 examples/s]
Map:  58%|█████▊    | 585/1000 [00:08<00:03, 123.34 examples/s]
Map:  60%|█████▉    | 598/1000 [00:08<00:03, 123.22 examples/s]
Map:  61%|██████    | 612/1000 [00:08<00:03, 125.57 examples/s]
Map:  62%|██████▎   | 625/1000 [00:08<00:02, 126.27 examples/s]
Map:  64%|██████▍   | 638/1000 [00:08<00:02, 126.90 examples/s]
Map:  66%|██████▌   | 656/1000 [00:08<00:02, 140.12 examples/s]
Map:  67%|██████▋   | 673/1000 [00:08<00:02, 148.22 examples/s]
Map:  69%|██████▉   | 691/1000 [00:08<00:02, 153.88 examples/s]
Map:  71%|███████   | 709/1000 [00:08<00:01, 160.07 examples/s]
Map:  73%|███████▎  | 726/1000 [00:09<00:01, 161.37 examples/s]
Map:  74%|███████▍  | 743/1000 [00:09<00:01, 161.77 examples/s]
Map:  76%|███████▌  | 760/1000 [00:09<00:01, 160.49 examples/s]
Map:  78%|███████▊  | 777/1000 [00:09<00:01, 160.26 examples/s]
Map:  80%|███████▉  | 795/1000 [00:09<00:01, 162.41 examples/s]
Map:  81%|████████▏ | 813/1000 [00:09<00:01, 164.69 examples/s]
Map:  84%|████████▎ | 836/1000 [00:09<00:01, 157.13 examples/s]
Map:  85%|████████▌ | 852/1000 [00:09<00:00, 155.85 examples/s]
Map:  87%|████████▋ | 868/1000 [00:09<00:00, 154.35 examples/s]
Map:  88%|████████▊ | 885/1000 [00:10<00:00, 157.08 examples/s]
Map:  90%|█████████ | 904/1000 [00:10<00:00, 162.01 examples/s]
Map:  92%|█████████▏| 922/1000 [00:10<00:00, 165.19 examples/s]
Map:  94%|█████████▍| 940/1000 [00:10<00:00, 167.94 examples/s]
Map:  96%|█████████▌| 959/1000 [00:10<00:00, 169.95 examples/s]
Map:  98%|█████████▊| 977/1000 [00:10<00:00, 169.38 examples/s]
Map: 100%|█████████▉| 995/1000 [00:10<00:00, 168.36 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 28137.42it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  30%|███       | 305/1000 [00:00<00:00, 3041.06it/s]
Logging series metrics to wandb:  61%|██████    | 610/1000 [00:00<00:00, 2953.58it/s]
Logging series metrics to wandb:  91%|█████████ | 906/1000 [00:00<00:00, 2886.50it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2931.78it/s]
2024-01-10 19:17:24.797009: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:17:24.850703: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:17:24.850796: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:17:24.852120: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:17:24.860017: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:17:26.475005: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61590.37lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:32,  1.53s/ examples]
Map:   1%|          | 7/1000 [00:01<02:56,  5.63 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:27, 11.22 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:49, 19.80 examples/s]
Map:   3%|▎         | 29/1000 [00:01<00:33, 29.08 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:25, 37.28 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:45, 21.22 examples/s]
Map:   5%|▌         | 52/1000 [00:02<00:33, 28.28 examples/s]
Map:   6%|▌         | 61/1000 [00:02<00:25, 36.68 examples/s]
Map:   7%|▋         | 69/1000 [00:03<00:21, 43.57 examples/s]
Map:   8%|▊         | 78/1000 [00:03<00:17, 51.48 examples/s]
Map:   9%|▊         | 87/1000 [00:03<00:15, 58.76 examples/s]
Map:  10%|▉         | 97/1000 [00:03<00:13, 68.10 examples/s]
Map:  11%|█         | 108/1000 [00:03<00:11, 75.02 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:10, 82.83 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:09, 87.48 examples/s]
Map:  14%|█▍        | 140/1000 [00:03<00:09, 90.39 examples/s]
Map:  15%|█▌        | 150/1000 [00:03<00:09, 91.90 examples/s]
Map:  16%|█▌        | 160/1000 [00:04<00:09, 91.93 examples/s]
Map:  17%|█▋        | 173/1000 [00:04<00:08, 100.65 examples/s]
Map:  19%|█▉        | 188/1000 [00:04<00:08, 99.68 examples/s] 
Map:  20%|██        | 200/1000 [00:04<00:07, 101.10 examples/s]
Map:  21%|██        | 212/1000 [00:04<00:07, 102.87 examples/s]
Map:  22%|██▏       | 223/1000 [00:04<00:07, 104.07 examples/s]
Map:  24%|██▎       | 235/1000 [00:04<00:07, 106.66 examples/s]
Map:  25%|██▍       | 247/1000 [00:04<00:06, 107.58 examples/s]
Map:  26%|██▌       | 259/1000 [00:04<00:06, 109.19 examples/s]
Map:  27%|██▋       | 271/1000 [00:05<00:06, 109.18 examples/s]
Map:  28%|██▊       | 283/1000 [00:05<00:06, 108.46 examples/s]
Map:  30%|██▉       | 295/1000 [00:05<00:06, 109.12 examples/s]
Map:  31%|███       | 307/1000 [00:05<00:06, 109.72 examples/s]
Map:  32%|███▏      | 319/1000 [00:05<00:06, 110.46 examples/s]
Map:  33%|███▎      | 332/1000 [00:05<00:05, 113.85 examples/s]
Map:  35%|███▍      | 348/1000 [00:05<00:05, 125.86 examples/s]
Map:  36%|███▋      | 363/1000 [00:05<00:04, 130.79 examples/s]
Map:  38%|███▊      | 379/1000 [00:05<00:04, 137.72 examples/s]
Map:  40%|███▉      | 396/1000 [00:06<00:04, 143.13 examples/s]
Map:  41%|████      | 412/1000 [00:06<00:04, 144.86 examples/s]
Map:  43%|████▎     | 429/1000 [00:06<00:03, 149.36 examples/s]
Map:  45%|████▍     | 446/1000 [00:06<00:03, 152.74 examples/s]
Map:  46%|████▋     | 463/1000 [00:06<00:03, 155.77 examples/s]
Map:  48%|████▊     | 480/1000 [00:06<00:03, 157.00 examples/s]
Map:  50%|████▉     | 496/1000 [00:06<00:03, 154.03 examples/s]
Map:  51%|█████     | 512/1000 [00:06<00:03, 153.64 examples/s]
Map:  53%|█████▎    | 528/1000 [00:06<00:03, 153.27 examples/s]
Map:  55%|█████▍    | 546/1000 [00:06<00:02, 159.47 examples/s]
Map:  56%|█████▋    | 564/1000 [00:07<00:02, 161.71 examples/s]
Map:  59%|█████▉    | 588/1000 [00:07<00:02, 159.40 examples/s]
Map:  60%|██████    | 604/1000 [00:07<00:02, 157.02 examples/s]
Map:  62%|██████▏   | 620/1000 [00:07<00:02, 154.75 examples/s]
Map:  64%|██████▎   | 637/1000 [00:07<00:02, 156.99 examples/s]
Map:  65%|██████▌   | 654/1000 [00:07<00:02, 159.75 examples/s]
Map:  67%|██████▋   | 672/1000 [00:07<00:02, 162.16 examples/s]
Map:  69%|██████▉   | 690/1000 [00:07<00:01, 164.34 examples/s]
Map:  72%|███████▏  | 716/1000 [00:08<00:01, 166.04 examples/s]
Map:  73%|███████▎  | 733/1000 [00:08<00:01, 165.26 examples/s]
Map:  75%|███████▌  | 750/1000 [00:08<00:01, 164.28 examples/s]
Map:  77%|███████▋  | 767/1000 [00:08<00:01, 164.70 examples/s]
Map:  79%|███████▊  | 786/1000 [00:08<00:01, 167.27 examples/s]
Map:  80%|████████  | 804/1000 [00:08<00:01, 167.52 examples/s]
Map:  82%|████████▏ | 822/1000 [00:08<00:01, 166.76 examples/s]
Map:  84%|████████▍ | 839/1000 [00:08<00:00, 164.81 examples/s]
Map:  86%|████████▌ | 857/1000 [00:08<00:00, 166.57 examples/s]
Map:  88%|████████▊ | 875/1000 [00:08<00:00, 167.63 examples/s]
Map:  89%|████████▉ | 894/1000 [00:09<00:00, 169.64 examples/s]
Map:  91%|█████████ | 912/1000 [00:09<00:00, 167.88 examples/s]
Map:  93%|█████████▎| 930/1000 [00:09<00:00, 169.98 examples/s]
Map:  96%|█████████▌| 957/1000 [00:09<00:00, 170.14 examples/s]
Map:  98%|█████████▊| 975/1000 [00:09<00:00, 172.01 examples/s]
Map:  99%|█████████▉| 994/1000 [00:09<00:00, 172.52 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 49545.85it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  33%|███▎      | 331/1000 [00:00<00:00, 3308.83it/s]
Logging series metrics to wandb:  70%|██████▉   | 697/1000 [00:00<00:00, 3511.19it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3448.97it/s]
2024-01-10 19:18:11.917414: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:18:11.976325: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:18:11.976410: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:18:11.977911: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:18:11.986478: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:18:13.474411: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61347.14lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:43,  1.54s/ examples]
Map:   1%|          | 7/1000 [00:01<02:57,  5.60 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:28, 11.14 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:49, 19.71 examples/s]
Map:   3%|▎         | 29/1000 [00:02<00:33, 28.63 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:26, 36.53 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:48, 19.89 examples/s]
Map:   5%|▌         | 52/1000 [00:02<00:35, 26.70 examples/s]
Map:   6%|▌         | 61/1000 [00:03<00:26, 35.32 examples/s]
Map:   7%|▋         | 69/1000 [00:03<00:22, 42.31 examples/s]
Map:   8%|▊         | 77/1000 [00:03<00:18, 48.95 examples/s]
Map:   9%|▊         | 86/1000 [00:03<00:16, 55.43 examples/s]
Map:  10%|▉         | 95/1000 [00:03<00:14, 62.59 examples/s]
Map:  10%|█         | 105/1000 [00:03<00:13, 67.19 examples/s]
Map:  12%|█▏        | 115/1000 [00:03<00:12, 73.43 examples/s]
Map:  13%|█▎        | 126/1000 [00:03<00:10, 81.60 examples/s]
Map:  14%|█▍        | 138/1000 [00:03<00:09, 87.93 examples/s]
Map:  15%|█▍        | 148/1000 [00:04<00:09, 87.49 examples/s]
Map:  16%|█▌        | 160/1000 [00:04<00:09, 92.25 examples/s]
Map:  17%|█▋        | 173/1000 [00:04<00:08, 100.08 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 100.38 examples/s]
Map:  20%|█▉        | 196/1000 [00:04<00:07, 101.78 examples/s]
Map:  21%|██        | 208/1000 [00:04<00:07, 102.76 examples/s]
Map:  22%|██▏       | 220/1000 [00:04<00:07, 106.41 examples/s]
Map:  23%|██▎       | 232/1000 [00:04<00:07, 108.27 examples/s]
Map:  24%|██▍       | 245/1000 [00:04<00:06, 109.64 examples/s]
Map:  26%|██▌       | 261/1000 [00:05<00:06, 121.10 examples/s]
Map:  28%|██▊       | 275/1000 [00:05<00:05, 121.73 examples/s]
Map:  29%|██▉       | 291/1000 [00:05<00:05, 128.95 examples/s]
Map:  31%|███       | 306/1000 [00:05<00:05, 132.72 examples/s]
Map:  32%|███▏      | 321/1000 [00:05<00:05, 135.35 examples/s]
Map:  34%|███▎      | 335/1000 [00:05<00:04, 134.56 examples/s]
Map:  35%|███▌      | 350/1000 [00:05<00:04, 135.74 examples/s]
Map:  37%|███▋      | 366/1000 [00:05<00:04, 139.01 examples/s]
Map:  38%|███▊      | 382/1000 [00:05<00:04, 140.78 examples/s]
Map:  40%|███▉      | 398/1000 [00:05<00:04, 145.30 examples/s]
Map:  41%|████▏     | 413/1000 [00:06<00:04, 143.40 examples/s]
Map:  43%|████▎     | 429/1000 [00:06<00:03, 143.82 examples/s]
Map:  44%|████▍     | 445/1000 [00:06<00:03, 145.55 examples/s]
Map:  46%|████▌     | 461/1000 [00:06<00:03, 146.47 examples/s]
Map:  48%|████▊     | 479/1000 [00:06<00:03, 150.79 examples/s]
Map:  50%|████▉     | 495/1000 [00:06<00:03, 149.82 examples/s]
Map:  51%|█████     | 512/1000 [00:06<00:03, 150.77 examples/s]
Map:  53%|█████▎    | 530/1000 [00:06<00:03, 154.89 examples/s]
Map:  55%|█████▍    | 546/1000 [00:06<00:03, 150.94 examples/s]
Map:  56%|█████▌    | 562/1000 [00:07<00:02, 152.73 examples/s]
Map:  58%|█████▊    | 585/1000 [00:07<00:02, 149.23 examples/s]
Map:  60%|██████    | 602/1000 [00:07<00:02, 151.72 examples/s]
Map:  62%|██████▏   | 619/1000 [00:07<00:02, 152.70 examples/s]
Map:  64%|██████▎   | 635/1000 [00:07<00:02, 152.34 examples/s]
Map:  65%|██████▌   | 653/1000 [00:07<00:02, 155.04 examples/s]
Map:  67%|██████▋   | 671/1000 [00:07<00:02, 158.62 examples/s]
Map:  69%|██████▉   | 689/1000 [00:07<00:01, 161.22 examples/s]
Map:  71%|███████   | 708/1000 [00:08<00:01, 165.03 examples/s]
Map:  73%|███████▎  | 726/1000 [00:08<00:01, 164.30 examples/s]
Map:  74%|███████▍  | 743/1000 [00:08<00:01, 161.86 examples/s]
Map:  76%|███████▌  | 761/1000 [00:08<00:01, 162.40 examples/s]
Map:  78%|███████▊  | 779/1000 [00:08<00:01, 164.10 examples/s]
Map:  80%|███████▉  | 798/1000 [00:08<00:01, 168.02 examples/s]
Map:  82%|████████▏ | 815/1000 [00:08<00:01, 164.66 examples/s]
Map:  83%|████████▎ | 834/1000 [00:08<00:01, 165.45 examples/s]
Map:  85%|████████▌ | 851/1000 [00:08<00:00, 163.29 examples/s]
Map:  88%|████████▊ | 876/1000 [00:09<00:00, 162.72 examples/s]
Map:  89%|████████▉ | 894/1000 [00:09<00:00, 163.36 examples/s]
Map:  92%|█████████▏| 916/1000 [00:09<00:00, 153.33 examples/s]
Map:  93%|█████████▎| 932/1000 [00:09<00:00, 154.01 examples/s]
Map:  95%|█████████▍| 948/1000 [00:09<00:00, 153.52 examples/s]
Map:  96%|█████████▋| 965/1000 [00:09<00:00, 156.05 examples/s]
Map:  98%|█████████▊| 982/1000 [00:09<00:00, 158.86 examples/s]
Map: 100%|█████████▉| 999/1000 [00:09<00:00, 157.05 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 41078.34it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  34%|███▍      | 342/1000 [00:00<00:00, 3418.24it/s]
Logging series metrics to wandb:  69%|██████▉   | 688/1000 [00:00<00:00, 3437.94it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3410.65it/s]
2024-01-10 19:18:57.582434: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:18:57.639753: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:18:57.639854: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:18:57.641482: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:18:57.649759: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:18:59.240853: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63150.11lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<26:52,  1.61s/ examples]
Map:   1%|          | 7/1000 [00:01<03:04,  5.39 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:31, 10.80 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:51, 19.12 examples/s]
Map:   3%|▎         | 29/1000 [00:02<00:34, 28.08 examples/s]
Map:   4%|▎         | 37/1000 [00:02<00:26, 36.19 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:45, 21.19 examples/s]
Map:   5%|▌         | 52/1000 [00:02<00:33, 28.22 examples/s]
Map:   6%|▌         | 61/1000 [00:03<00:25, 37.09 examples/s]
Map:   7%|▋         | 69/1000 [00:03<00:21, 44.28 examples/s]
Map:   8%|▊         | 78/1000 [00:03<00:17, 52.47 examples/s]
Map:   9%|▊         | 87/1000 [00:03<00:15, 58.66 examples/s]
Map:  10%|▉         | 97/1000 [00:03<00:13, 67.32 examples/s]
Map:  11%|█         | 107/1000 [00:03<00:12, 73.07 examples/s]
Map:  12%|█▏        | 118/1000 [00:03<00:10, 80.49 examples/s]
Map:  13%|█▎        | 128/1000 [00:03<00:10, 84.88 examples/s]
Map:  14%|█▍        | 139/1000 [00:03<00:10, 78.80 examples/s]
Map:  15%|█▌        | 152/1000 [00:04<00:11, 76.87 examples/s]
Map:  16%|█▋        | 164/1000 [00:04<00:09, 85.53 examples/s]
Map:  18%|█▊        | 176/1000 [00:04<00:08, 92.26 examples/s]
Map:  19%|█▊        | 186/1000 [00:04<00:08, 93.61 examples/s]
Map:  20%|█▉        | 197/1000 [00:04<00:08, 95.82 examples/s]
Map:  21%|██        | 208/1000 [00:04<00:08, 98.12 examples/s]
Map:  22%|██▏       | 219/1000 [00:04<00:07, 100.54 examples/s]
Map:  23%|██▎       | 230/1000 [00:04<00:07, 102.84 examples/s]
Map:  24%|██▍       | 245/1000 [00:05<00:07, 99.95 examples/s] 
Map:  26%|██▌       | 256/1000 [00:05<00:07, 101.68 examples/s]
Map:  27%|██▋       | 268/1000 [00:05<00:07, 102.47 examples/s]
Map:  28%|██▊       | 280/1000 [00:05<00:06, 104.47 examples/s]
Map:  29%|██▉       | 292/1000 [00:05<00:06, 105.17 examples/s]
Map:  30%|███       | 304/1000 [00:05<00:06, 106.42 examples/s]
Map:  32%|███▏      | 319/1000 [00:05<00:06, 102.48 examples/s]
Map:  33%|███▎      | 330/1000 [00:05<00:06, 101.83 examples/s]
Map:  34%|███▍      | 342/1000 [00:05<00:06, 103.16 examples/s]
Map:  36%|███▌      | 355/1000 [00:06<00:05, 107.89 examples/s]
Map:  37%|███▋      | 367/1000 [00:06<00:05, 109.70 examples/s]
Map:  38%|███▊      | 379/1000 [00:06<00:05, 110.69 examples/s]
Map:  39%|███▉      | 391/1000 [00:06<00:05, 112.78 examples/s]
Map:  40%|████      | 403/1000 [00:06<00:05, 111.54 examples/s]
Map:  42%|████▏     | 415/1000 [00:06<00:05, 110.18 examples/s]
Map:  43%|████▎     | 432/1000 [00:06<00:05, 108.34 examples/s]
Map:  44%|████▍     | 445/1000 [00:06<00:05, 110.98 examples/s]
Map:  46%|████▌     | 457/1000 [00:06<00:04, 111.34 examples/s]
Map:  47%|████▋     | 472/1000 [00:07<00:05, 103.26 examples/s]
Map:  48%|████▊     | 484/1000 [00:07<00:04, 105.88 examples/s]
Map:  50%|████▉     | 497/1000 [00:07<00:04, 107.78 examples/s]
Map:  51%|█████     | 511/1000 [00:07<00:04, 112.71 examples/s]
Map:  52%|█████▏    | 524/1000 [00:07<00:04, 115.85 examples/s]
Map:  54%|█████▎    | 537/1000 [00:07<00:03, 116.23 examples/s]
Map:  55%|█████▌    | 550/1000 [00:07<00:03, 116.55 examples/s]
Map:  56%|█████▌    | 562/1000 [00:07<00:03, 114.61 examples/s]
Map:  57%|█████▊    | 575/1000 [00:07<00:03, 114.94 examples/s]
Map:  59%|█████▉    | 588/1000 [00:08<00:03, 117.08 examples/s]
Map:  60%|██████    | 600/1000 [00:08<00:03, 115.18 examples/s]
Map:  61%|██████    | 612/1000 [00:08<00:03, 114.86 examples/s]
Map:  62%|██████▏   | 624/1000 [00:08<00:03, 113.52 examples/s]
Map:  64%|██████▎   | 637/1000 [00:08<00:03, 115.81 examples/s]
Map:  65%|██████▌   | 650/1000 [00:08<00:02, 118.29 examples/s]
Map:  66%|██████▋   | 664/1000 [00:08<00:02, 121.57 examples/s]
Map:  68%|██████▊   | 682/1000 [00:08<00:02, 118.00 examples/s]
Map:  70%|██████▉   | 695/1000 [00:09<00:02, 118.93 examples/s]
Map:  71%|███████   | 709/1000 [00:09<00:02, 121.98 examples/s]
Map:  72%|███████▏  | 723/1000 [00:09<00:02, 124.75 examples/s]
Map:  74%|███████▎  | 737/1000 [00:09<00:02, 125.01 examples/s]
Map:  75%|███████▌  | 753/1000 [00:09<00:02, 114.26 examples/s]
Map:  77%|███████▋  | 770/1000 [00:09<00:02, 106.05 examples/s]
Map:  78%|███████▊  | 785/1000 [00:09<00:01, 113.58 examples/s]
Map:  80%|████████  | 800/1000 [00:09<00:01, 119.68 examples/s]
Map:  81%|████████▏ | 814/1000 [00:10<00:01, 122.75 examples/s]
Map:  83%|████████▎ | 828/1000 [00:10<00:01, 125.44 examples/s]
Map:  84%|████████▍ | 842/1000 [00:10<00:01, 123.91 examples/s]
Map:  86%|████████▌ | 856/1000 [00:10<00:01, 126.56 examples/s]
Map:  87%|████████▋ | 869/1000 [00:10<00:01, 124.97 examples/s]
Map:  88%|████████▊ | 884/1000 [00:10<00:00, 127.26 examples/s]
Map:  90%|████████▉ | 898/1000 [00:10<00:00, 129.80 examples/s]
Map:  92%|█████████▏| 918/1000 [00:10<00:00, 128.89 examples/s]
Map:  93%|█████████▎| 933/1000 [00:10<00:00, 130.72 examples/s]
Map:  95%|█████████▍| 948/1000 [00:11<00:00, 133.50 examples/s]
Map:  96%|█████████▋| 963/1000 [00:11<00:00, 132.97 examples/s]
Map:  98%|█████████▊| 978/1000 [00:11<00:00, 133.82 examples/s]
Map:  99%|█████████▉| 994/1000 [00:11<00:00, 135.68 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 38726.42it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▎       | 236/1000 [00:00<00:00, 2354.33it/s]
Logging series metrics to wandb:  50%|████▉     | 498/1000 [00:00<00:00, 2506.57it/s]
Logging series metrics to wandb:  75%|███████▍  | 749/1000 [00:00<00:00, 2493.23it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2495.30it/s]
2024-01-10 19:19:45.201095: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:19:45.256314: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:19:45.256395: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:19:45.257843: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:19:45.267301: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:19:46.921302: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62999.29lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 17/1000 [00:00<00:06, 156.50 examples/s]
Map:   4%|▎         | 35/1000 [00:00<00:05, 165.15 examples/s]
Map:   5%|▌         | 53/1000 [00:00<00:05, 169.73 examples/s]
Map:   7%|▋         | 72/1000 [00:00<00:05, 171.74 examples/s]
Map:   9%|▉         | 91/1000 [00:00<00:05, 173.46 examples/s]
Map:  11%|█         | 112/1000 [00:00<00:04, 182.90 examples/s]
Map:  14%|█▎        | 135/1000 [00:00<00:04, 193.79 examples/s]
Map:  16%|█▌        | 156/1000 [00:00<00:04, 195.91 examples/s]
Map:  18%|█▊        | 178/1000 [00:00<00:04, 198.37 examples/s]
Map:  20%|█▉        | 199/1000 [00:01<00:04, 197.96 examples/s]
Map:  22%|██▏       | 219/1000 [00:01<00:03, 198.12 examples/s]
Map:  24%|██▍       | 241/1000 [00:01<00:03, 200.26 examples/s]
Map:  26%|██▋       | 263/1000 [00:01<00:03, 203.09 examples/s]
Map:  28%|██▊       | 285/1000 [00:01<00:03, 205.11 examples/s]
Map:  31%|███       | 306/1000 [00:01<00:03, 204.15 examples/s]
Map:  33%|███▎      | 327/1000 [00:01<00:03, 202.36 examples/s]
Map:  35%|███▍      | 348/1000 [00:01<00:03, 201.85 examples/s]
Map:  37%|███▋      | 369/1000 [00:01<00:03, 200.84 examples/s]
Map:  40%|███▉      | 398/1000 [00:02<00:03, 195.98 examples/s]
Map:  42%|████▏     | 418/1000 [00:02<00:02, 196.48 examples/s]
Map:  44%|████▍     | 439/1000 [00:02<00:02, 196.65 examples/s]
Map:  46%|████▌     | 461/1000 [00:02<00:02, 199.68 examples/s]
Map:  48%|████▊     | 482/1000 [00:02<00:02, 199.99 examples/s]
Map:  50%|█████     | 503/1000 [00:02<00:02, 199.68 examples/s]
Map:  52%|█████▏    | 524/1000 [00:02<00:02, 199.77 examples/s]
Map:  55%|█████▍    | 546/1000 [00:02<00:02, 201.87 examples/s]
Map:  57%|█████▋    | 567/1000 [00:02<00:02, 200.10 examples/s]
Map:  59%|█████▉    | 588/1000 [00:03<00:02, 200.64 examples/s]
Map:  61%|██████    | 609/1000 [00:03<00:01, 202.67 examples/s]
Map:  64%|██████▍   | 639/1000 [00:03<00:01, 199.75 examples/s]
Map:  67%|██████▋   | 668/1000 [00:03<00:01, 194.23 examples/s]
Map:  69%|██████▉   | 689/1000 [00:03<00:01, 196.34 examples/s]
Map:  71%|███████   | 712/1000 [00:03<00:01, 201.83 examples/s]
Map:  73%|███████▎  | 734/1000 [00:03<00:01, 204.54 examples/s]
Map:  76%|███████▌  | 755/1000 [00:03<00:01, 202.81 examples/s]
Map:  79%|███████▊  | 786/1000 [00:03<00:01, 200.51 examples/s]
Map:  81%|████████  | 808/1000 [00:04<00:00, 202.34 examples/s]
Map:  84%|████████▍ | 839/1000 [00:04<00:00, 202.32 examples/s]
Map:  86%|████████▌ | 860/1000 [00:04<00:00, 202.36 examples/s]
Map:  88%|████████▊ | 881/1000 [00:04<00:00, 201.70 examples/s]
Map:  90%|█████████ | 902/1000 [00:04<00:00, 201.85 examples/s]
Map:  92%|█████████▏| 923/1000 [00:04<00:00, 201.65 examples/s]
Map:  94%|█████████▍| 944/1000 [00:04<00:00, 199.99 examples/s]
Map:  97%|█████████▋| 967/1000 [00:04<00:00, 203.64 examples/s]
Map:  99%|█████████▉| 990/1000 [00:04<00:00, 208.97 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34876.39it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 260/1000 [00:00<00:00, 2594.74it/s]
Logging series metrics to wandb:  54%|█████▍    | 542/1000 [00:00<00:00, 2723.92it/s]
Logging series metrics to wandb:  83%|████████▎ | 830/1000 [00:00<00:00, 2790.98it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2778.06it/s]
2024-01-10 19:20:27.555272: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:20:27.610472: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:20:27.610558: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:20:27.611886: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:20:27.619993: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:20:28.963057: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 53393.89lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  17%|█▋        | 166/1000 [00:00<00:00, 1639.61 examples/s]
Map:  33%|███▎      | 333/1000 [00:00<00:00, 1650.43 examples/s]
Map:  50%|█████     | 504/1000 [00:00<00:00, 1673.37 examples/s]
Map:  68%|██████▊   | 676/1000 [00:00<00:00, 1686.20 examples/s]
Map:  85%|████████▌ | 851/1000 [00:00<00:00, 1705.85 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 22442.63it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▉       | 292/1000 [00:00<00:00, 2917.00it/s]
Logging series metrics to wandb:  58%|█████▊    | 584/1000 [00:00<00:00, 2796.15it/s]
Logging series metrics to wandb:  88%|████████▊ | 875/1000 [00:00<00:00, 2842.78it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2836.89it/s]
2024-01-10 19:21:04.534378: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:21:04.587483: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:21:04.587539: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:21:04.588692: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:21:04.595391: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:21:05.809625: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 43018.94lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  15%|█▌        | 153/1000 [00:00<00:00, 1504.54 examples/s]
Map:  33%|███▎      | 332/1000 [00:00<00:00, 1668.15 examples/s]
Map:  51%|█████     | 506/1000 [00:00<00:00, 1695.53 examples/s]
Map:  68%|██████▊   | 679/1000 [00:00<00:00, 1699.93 examples/s]
Map:  86%|████████▌ | 859/1000 [00:00<00:00, 1732.85 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34595.34it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 267/1000 [00:00<00:00, 2661.73it/s]
Logging series metrics to wandb:  54%|█████▍    | 542/1000 [00:00<00:00, 2710.99it/s]
Logging series metrics to wandb:  82%|████████▏ | 821/1000 [00:00<00:00, 2746.78it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2738.79it/s]
2024-01-10 19:21:41.349302: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:21:41.397591: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:21:41.397651: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:21:41.398815: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:21:41.405727: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:21:42.768114: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63217.69lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 177/1000 [00:00<00:00, 1738.94 examples/s]
Map:  37%|███▋      | 374/1000 [00:00<00:00, 1444.53 examples/s]
Map:  56%|█████▌    | 562/1000 [00:00<00:00, 1342.52 examples/s]
Map:  78%|███████▊  | 778/1000 [00:00<00:00, 1599.66 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1588.80 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37874.21it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 285/1000 [00:00<00:00, 2848.71it/s]
Logging series metrics to wandb:  57%|█████▋    | 570/1000 [00:00<00:00, 2815.93it/s]
Logging series metrics to wandb:  86%|████████▌ | 860/1000 [00:00<00:00, 2849.49it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2851.32it/s]
2024-01-10 19:22:19.142295: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:22:19.195177: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:22:19.195255: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:22:19.196394: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:22:19.204068: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:22:20.660930: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56778.76lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 183/1000 [00:00<00:00, 1798.04 examples/s]
Map:  37%|███▋      | 367/1000 [00:00<00:00, 1812.44 examples/s]
Map:  62%|██████▎   | 625/1000 [00:00<00:00, 1760.55 examples/s]
Map:  82%|████████▏ | 818/1000 [00:00<00:00, 1816.88 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/lean23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 22719.56it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 267/1000 [00:00<00:00, 2666.44it/s]
Logging series metrics to wandb:  54%|█████▎    | 537/1000 [00:00<00:00, 2681.74it/s]
Logging series metrics to wandb:  81%|████████  | 808/1000 [00:00<00:00, 2694.34it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2700.92it/s]
finish llama
finish lean23
start kiyoon23
2024-01-10 19:22:55.376395: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:22:55.428406: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:22:55.428502: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:22:55.429837: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:22:55.437612: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:22:56.973789: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62336.39lines/s]
Running swap attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  11%|█▏        | 113/1000 [00:00<00:00, 1111.58 examples/s]
Map:  25%|██▍       | 248/1000 [00:00<00:00, 1238.82 examples/s]
Map:  39%|███▊      | 387/1000 [00:00<00:00, 1304.42 examples/s]
Map:  52%|█████▏    | 523/1000 [00:00<00:00, 1323.19 examples/s]
Map:  67%|██████▋   | 669/1000 [00:00<00:00, 1363.79 examples/s]
Map:  81%|████████  | 811/1000 [00:00<00:00, 1378.51 examples/s]
Map:  95%|█████████▌| 951/1000 [00:00<00:00, 1383.42 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34836.12it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 271/1000 [00:00<00:00, 2706.30it/s]
Logging series metrics to wandb:  54%|█████▍    | 542/1000 [00:00<00:00, 2665.72it/s]
Logging series metrics to wandb:  81%|████████  | 809/1000 [00:00<00:00, 2651.10it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2680.17it/s]
2024-01-10 19:23:34.351427: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:23:34.410937: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:23:34.411026: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:23:34.412359: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:23:34.420214: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:23:36.024444: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65171.45lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:38,  1.54s/ examples]
Map:   1%|          | 8/1000 [00:01<02:33,  6.48 examples/s]
Map:   2%|▏         | 17/1000 [00:01<01:04, 15.21 examples/s]
Map:   3%|▎         | 26/1000 [00:01<00:39, 24.61 examples/s]
Map:   4%|▍         | 38/1000 [00:01<00:24, 38.63 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:19, 48.84 examples/s]
Map:   6%|▌         | 60/1000 [00:02<00:16, 55.76 examples/s]
Map:   7%|▋         | 71/1000 [00:02<00:14, 65.84 examples/s]
Map:   8%|▊         | 82/1000 [00:02<00:12, 74.06 examples/s]
Map:  10%|▉         | 96/1000 [00:03<00:24, 36.20 examples/s]
Map:  11%|█         | 108/1000 [00:03<00:19, 45.79 examples/s]
Map:  12%|█▏        | 121/1000 [00:03<00:15, 57.24 examples/s]
Map:  13%|█▎        | 133/1000 [00:03<00:12, 67.56 examples/s]
Map:  14%|█▍        | 143/1000 [00:03<00:11, 71.65 examples/s]
Map:  16%|█▌        | 155/1000 [00:03<00:10, 79.16 examples/s]
Map:  17%|█▋        | 167/1000 [00:03<00:09, 87.59 examples/s]
Map:  18%|█▊        | 179/1000 [00:03<00:08, 92.51 examples/s]
Map:  19%|█▉        | 192/1000 [00:04<00:08, 100.10 examples/s]
Map:  21%|██        | 206/1000 [00:04<00:07, 107.88 examples/s]
Map:  22%|██▏       | 218/1000 [00:04<00:07, 109.50 examples/s]
Map:  23%|██▎       | 232/1000 [00:04<00:06, 115.05 examples/s]
Map:  25%|██▌       | 250/1000 [00:04<00:06, 114.45 examples/s]
Map:  26%|██▋       | 263/1000 [00:04<00:06, 115.99 examples/s]
Map:  28%|██▊       | 276/1000 [00:04<00:06, 117.63 examples/s]
Map:  29%|██▉       | 292/1000 [00:04<00:05, 126.94 examples/s]
Map:  31%|███       | 310/1000 [00:05<00:05, 120.86 examples/s]
Map:  33%|███▎      | 327/1000 [00:05<00:05, 130.20 examples/s]
Map:  34%|███▍      | 341/1000 [00:05<00:05, 129.07 examples/s]
Map:  36%|███▌      | 356/1000 [00:05<00:05, 114.58 examples/s]
Map:  37%|███▋      | 368/1000 [00:05<00:05, 111.58 examples/s]
Map:  38%|███▊      | 382/1000 [00:05<00:05, 103.24 examples/s]
Map:  40%|███▉      | 397/1000 [00:05<00:06, 99.30 examples/s] 
Map:  41%|████      | 408/1000 [00:05<00:05, 99.85 examples/s]
Map:  42%|████▏     | 423/1000 [00:06<00:05, 107.97 examples/s]
Map:  44%|████▍     | 439/1000 [00:06<00:04, 117.87 examples/s]
Map:  45%|████▌     | 452/1000 [00:06<00:04, 118.42 examples/s]
Map:  47%|████▋     | 466/1000 [00:06<00:04, 118.92 examples/s]
Map:  48%|████▊     | 481/1000 [00:06<00:04, 124.78 examples/s]
Map:  50%|████▉     | 495/1000 [00:06<00:04, 123.17 examples/s]
Map:  51%|█████     | 511/1000 [00:06<00:03, 129.06 examples/s]
Map:  52%|█████▎    | 525/1000 [00:06<00:03, 129.42 examples/s]
Map:  54%|█████▍    | 540/1000 [00:06<00:03, 133.64 examples/s]
Map:  55%|█████▌    | 554/1000 [00:07<00:03, 131.08 examples/s]
Map:  57%|█████▋    | 568/1000 [00:07<00:03, 130.82 examples/s]
Map:  58%|█████▊    | 582/1000 [00:07<00:03, 129.25 examples/s]
Map:  60%|█████▉    | 597/1000 [00:07<00:03, 128.06 examples/s]
Map:  61%|██████    | 612/1000 [00:07<00:02, 131.03 examples/s]
Map:  63%|██████▎   | 626/1000 [00:07<00:02, 129.39 examples/s]
Map:  64%|██████▍   | 640/1000 [00:07<00:02, 127.80 examples/s]
Map:  66%|██████▌   | 655/1000 [00:07<00:02, 130.51 examples/s]
Map:  67%|██████▋   | 670/1000 [00:07<00:02, 133.45 examples/s]
Map:  68%|██████▊   | 684/1000 [00:08<00:02, 132.17 examples/s]
Map:  70%|███████   | 704/1000 [00:08<00:02, 130.69 examples/s]
Map:  72%|███████▏  | 719/1000 [00:08<00:02, 132.45 examples/s]
Map:  74%|███████▍  | 738/1000 [00:08<00:02, 127.31 examples/s]
Map:  75%|███████▌  | 754/1000 [00:08<00:01, 133.69 examples/s]
Map:  77%|███████▋  | 770/1000 [00:08<00:01, 137.68 examples/s]
Map:  78%|███████▊  | 784/1000 [00:08<00:01, 134.35 examples/s]
Map:  80%|███████▉  | 798/1000 [00:08<00:01, 135.03 examples/s]
Map:  81%|████████  | 812/1000 [00:09<00:01, 132.20 examples/s]
Map:  83%|████████▎ | 826/1000 [00:09<00:01, 110.49 examples/s]
Map:  84%|████████▍ | 841/1000 [00:09<00:01, 104.65 examples/s]
Map:  86%|████████▌ | 856/1000 [00:09<00:01, 112.82 examples/s]
Map:  87%|████████▋ | 870/1000 [00:09<00:01, 117.93 examples/s]
Map:  88%|████████▊ | 884/1000 [00:09<00:00, 120.78 examples/s]
Map:  90%|████████▉ | 899/1000 [00:09<00:00, 127.16 examples/s]
Map:  91%|█████████▏| 914/1000 [00:09<00:00, 129.80 examples/s]
Map:  93%|█████████▎| 929/1000 [00:10<00:00, 132.85 examples/s]
Map:  94%|█████████▍| 943/1000 [00:10<00:00, 133.12 examples/s]
Map:  96%|█████████▌| 958/1000 [00:10<00:00, 136.40 examples/s]
Map:  97%|█████████▋| 973/1000 [00:10<00:00, 138.34 examples/s]
Map:  99%|█████████▉| 988/1000 [00:10<00:00, 138.16 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 36434.19it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▍       | 244/1000 [00:00<00:00, 2427.56it/s]
Logging series metrics to wandb:  50%|████▉     | 499/1000 [00:00<00:00, 2496.09it/s]
Logging series metrics to wandb:  76%|███████▋  | 763/1000 [00:00<00:00, 2559.54it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2681.20it/s]
2024-01-10 19:24:24.872067: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:24:24.921860: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:24:24.921919: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:24:24.923499: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:24:24.931388: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:24:26.422056: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62227.26lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<27:46,  1.67s/ examples]
Map:   1%|          | 7/1000 [00:01<03:15,  5.09 examples/s]
Map:   2%|▏         | 17/1000 [00:01<01:10, 13.94 examples/s]
Map:   3%|▎         | 26/1000 [00:02<00:43, 22.63 examples/s]
Map:   4%|▍         | 38/1000 [00:02<00:27, 35.54 examples/s]
Map:   5%|▍         | 46/1000 [00:02<00:22, 41.83 examples/s]
Map:   6%|▌         | 55/1000 [00:02<00:18, 50.00 examples/s]
Map:   7%|▋         | 66/1000 [00:02<00:15, 61.27 examples/s]
Map:   8%|▊         | 77/1000 [00:02<00:12, 71.26 examples/s]
Map:   9%|▊         | 87/1000 [00:03<00:31, 28.72 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:27, 32.94 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:24, 36.87 examples/s]
Map:  11%|█         | 111/1000 [00:03<00:19, 45.56 examples/s]
Map:  12%|█▏        | 124/1000 [00:03<00:14, 59.80 examples/s]
Map:  14%|█▎        | 137/1000 [00:04<00:11, 72.54 examples/s]
Map:  15%|█▌        | 152/1000 [00:04<00:10, 79.19 examples/s]
Map:  16%|█▋        | 165/1000 [00:04<00:09, 88.81 examples/s]
Map:  18%|█▊        | 179/1000 [00:04<00:08, 97.62 examples/s]
Map:  19%|█▉        | 192/1000 [00:04<00:07, 103.75 examples/s]
Map:  21%|██        | 206/1000 [00:04<00:07, 111.27 examples/s]
Map:  22%|██▏       | 220/1000 [00:04<00:06, 117.59 examples/s]
Map:  23%|██▎       | 233/1000 [00:04<00:07, 104.69 examples/s]
Map:  24%|██▍       | 245/1000 [00:04<00:07, 105.39 examples/s]
Map:  26%|██▌       | 259/1000 [00:05<00:06, 111.06 examples/s]
Map:  27%|██▋       | 271/1000 [00:05<00:06, 111.12 examples/s]
Map:  29%|██▊       | 286/1000 [00:05<00:05, 120.44 examples/s]
Map:  30%|███       | 304/1000 [00:05<00:05, 118.25 examples/s]
Map:  32%|███▏      | 318/1000 [00:05<00:05, 119.79 examples/s]
Map:  33%|███▎      | 331/1000 [00:05<00:05, 120.87 examples/s]
Map:  35%|███▍      | 346/1000 [00:05<00:05, 126.12 examples/s]
Map:  36%|███▋      | 364/1000 [00:05<00:05, 120.16 examples/s]
Map:  38%|███▊      | 377/1000 [00:06<00:05, 118.61 examples/s]
Map:  39%|███▉      | 390/1000 [00:06<00:05, 119.56 examples/s]
Map:  41%|████      | 408/1000 [00:06<00:05, 113.93 examples/s]
Map:  42%|████▏     | 421/1000 [00:06<00:05, 100.08 examples/s]
Map:  44%|████▎     | 435/1000 [00:06<00:05, 106.27 examples/s]
Map:  45%|████▌     | 452/1000 [00:06<00:04, 118.10 examples/s]
Map:  47%|████▋     | 468/1000 [00:06<00:04, 126.58 examples/s]
Map:  48%|████▊     | 485/1000 [00:06<00:03, 135.28 examples/s]
Map:  50%|█████     | 504/1000 [00:07<00:03, 147.86 examples/s]
Map:  52%|█████▏    | 521/1000 [00:07<00:03, 149.91 examples/s]
Map:  54%|█████▎    | 537/1000 [00:07<00:03, 151.27 examples/s]
Map:  55%|█████▌    | 554/1000 [00:07<00:02, 153.59 examples/s]
Map:  57%|█████▋    | 572/1000 [00:07<00:02, 158.78 examples/s]
Map:  59%|█████▉    | 590/1000 [00:07<00:02, 161.12 examples/s]
Map:  61%|██████    | 608/1000 [00:07<00:02, 163.35 examples/s]
Map:  62%|██████▎   | 625/1000 [00:07<00:02, 163.84 examples/s]
Map:  64%|██████▍   | 643/1000 [00:07<00:02, 165.69 examples/s]
Map:  66%|██████▌   | 660/1000 [00:08<00:02, 166.27 examples/s]
Map:  68%|██████▊   | 681/1000 [00:08<00:02, 151.46 examples/s]
Map:  70%|██████▉   | 698/1000 [00:08<00:01, 155.31 examples/s]
Map:  72%|███████▏  | 716/1000 [00:08<00:01, 158.56 examples/s]
Map:  74%|███████▍  | 740/1000 [00:08<00:01, 156.53 examples/s]
Map:  76%|███████▌  | 762/1000 [00:08<00:01, 148.50 examples/s]
Map:  79%|███████▊  | 786/1000 [00:08<00:01, 148.77 examples/s]
Map:  80%|████████  | 804/1000 [00:08<00:01, 153.65 examples/s]
Map:  82%|████████▏ | 823/1000 [00:09<00:01, 159.26 examples/s]
Map:  84%|████████▍ | 841/1000 [00:09<00:00, 161.49 examples/s]
Map:  86%|████████▌ | 858/1000 [00:09<00:00, 161.52 examples/s]
Map:  88%|████████▊ | 876/1000 [00:09<00:00, 164.70 examples/s]
Map:  89%|████████▉ | 893/1000 [00:09<00:00, 162.21 examples/s]
Map:  91%|█████████ | 912/1000 [00:09<00:00, 163.08 examples/s]
Map:  93%|█████████▎| 931/1000 [00:09<00:00, 165.69 examples/s]
Map:  95%|█████████▌| 952/1000 [00:09<00:00, 173.22 examples/s]
Map:  98%|█████████▊| 979/1000 [00:09<00:00, 174.07 examples/s]
Map: 100%|██████████| 1000/1000 [00:10<00:00, 155.08 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47404.51it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  37%|███▋      | 369/1000 [00:00<00:00, 3685.69it/s]
Logging series metrics to wandb:  74%|███████▍  | 738/1000 [00:00<00:00, 3568.74it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3538.43it/s]
2024-01-10 19:25:15.221643: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:25:15.272734: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:25:15.272803: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:25:15.274100: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:25:15.281679: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:25:16.799347: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61137.89lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:57,  1.56s/ examples]
Map:   1%|          | 8/1000 [00:01<02:34,  6.41 examples/s]
Map:   2%|▏         | 17/1000 [00:01<01:05, 15.06 examples/s]
Map:   3%|▎         | 26/1000 [00:01<00:39, 24.35 examples/s]
Map:   4%|▍         | 38/1000 [00:02<00:25, 38.46 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:19, 48.74 examples/s]
Map:   6%|▌         | 62/1000 [00:02<00:16, 58.46 examples/s]
Map:   7%|▋         | 73/1000 [00:02<00:13, 67.63 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:27, 33.24 examples/s]
Map:  10%|▉         | 96/1000 [00:03<00:21, 42.76 examples/s]
Map:  11%|█         | 108/1000 [00:03<00:16, 53.42 examples/s]
Map:  12%|█▏        | 121/1000 [00:03<00:13, 65.63 examples/s]
Map:  13%|█▎        | 133/1000 [00:03<00:11, 74.50 examples/s]
Map:  14%|█▍        | 144/1000 [00:03<00:10, 79.08 examples/s]
Map:  16%|█▌        | 155/1000 [00:03<00:09, 85.87 examples/s]
Map:  17%|█▋        | 168/1000 [00:03<00:08, 94.02 examples/s]
Map:  18%|█▊        | 180/1000 [00:03<00:08, 98.49 examples/s]
Map:  19%|█▉        | 193/1000 [00:04<00:07, 104.58 examples/s]
Map:  21%|██        | 207/1000 [00:04<00:07, 110.90 examples/s]
Map:  22%|██▏       | 219/1000 [00:04<00:07, 110.92 examples/s]
Map:  23%|██▎       | 232/1000 [00:04<00:06, 114.16 examples/s]
Map:  25%|██▌       | 250/1000 [00:04<00:06, 111.88 examples/s]
Map:  26%|██▌       | 262/1000 [00:04<00:06, 111.97 examples/s]
Map:  28%|██▊       | 275/1000 [00:04<00:06, 113.15 examples/s]
Map:  29%|██▉       | 290/1000 [00:04<00:05, 120.78 examples/s]
Map:  30%|███       | 303/1000 [00:05<00:05, 119.57 examples/s]
Map:  32%|███▏      | 316/1000 [00:05<00:05, 120.55 examples/s]
Map:  33%|███▎      | 329/1000 [00:05<00:05, 119.71 examples/s]
Map:  35%|███▍      | 348/1000 [00:05<00:05, 119.02 examples/s]
Map:  36%|███▌      | 361/1000 [00:05<00:05, 119.49 examples/s]
Map:  37%|███▋      | 374/1000 [00:05<00:05, 119.86 examples/s]
Map:  39%|███▉      | 391/1000 [00:05<00:05, 114.55 examples/s]
Map:  40%|████      | 403/1000 [00:05<00:05, 112.43 examples/s]
Map:  42%|████▏     | 415/1000 [00:05<00:05, 111.57 examples/s]
Map:  43%|████▎     | 430/1000 [00:06<00:04, 118.77 examples/s]
Map:  44%|████▍     | 444/1000 [00:06<00:04, 118.17 examples/s]
Map:  46%|████▌     | 458/1000 [00:06<00:04, 122.53 examples/s]
Map:  48%|████▊     | 475/1000 [00:06<00:03, 132.76 examples/s]
Map:  49%|████▉     | 492/1000 [00:06<00:03, 140.73 examples/s]
Map:  51%|█████     | 512/1000 [00:06<00:03, 154.56 examples/s]
Map:  53%|█████▎    | 530/1000 [00:06<00:02, 158.67 examples/s]
Map:  55%|█████▍    | 546/1000 [00:06<00:02, 158.35 examples/s]
Map:  57%|█████▋    | 566/1000 [00:06<00:02, 167.91 examples/s]
Map:  58%|█████▊    | 583/1000 [00:07<00:02, 165.83 examples/s]
Map:  60%|██████    | 602/1000 [00:07<00:02, 168.51 examples/s]
Map:  62%|██████▏   | 621/1000 [00:07<00:02, 168.30 examples/s]
Map:  64%|██████▍   | 644/1000 [00:07<00:02, 153.80 examples/s]
Map:  67%|██████▋   | 666/1000 [00:07<00:02, 146.10 examples/s]
Map:  69%|██████▊   | 687/1000 [00:07<00:02, 140.37 examples/s]
Map:  71%|███████   | 707/1000 [00:07<00:02, 135.55 examples/s]
Map:  72%|███████▏  | 722/1000 [00:08<00:02, 134.11 examples/s]
Map:  74%|███████▍  | 741/1000 [00:08<00:02, 129.36 examples/s]
Map:  76%|███████▌  | 757/1000 [00:08<00:01, 133.66 examples/s]
Map:  77%|███████▋  | 772/1000 [00:08<00:01, 134.09 examples/s]
Map:  79%|███████▊  | 786/1000 [00:08<00:01, 133.42 examples/s]
Map:  80%|████████  | 800/1000 [00:08<00:01, 133.36 examples/s]
Map:  82%|████████▏ | 815/1000 [00:08<00:01, 133.23 examples/s]
Map:  83%|████████▎ | 830/1000 [00:08<00:01, 133.84 examples/s]
Map:  85%|████████▍ | 846/1000 [00:08<00:01, 135.83 examples/s]
Map:  86%|████████▌ | 860/1000 [00:09<00:01, 135.06 examples/s]
Map:  88%|████████▊ | 880/1000 [00:09<00:00, 130.02 examples/s]
Map:  90%|████████▉ | 895/1000 [00:09<00:00, 132.03 examples/s]
Map:  91%|█████████ | 910/1000 [00:09<00:00, 134.16 examples/s]
Map:  92%|█████████▏| 924/1000 [00:09<00:00, 133.94 examples/s]
Map:  94%|█████████▍| 939/1000 [00:09<00:00, 134.87 examples/s]
Map:  96%|█████████▌| 955/1000 [00:09<00:00, 136.71 examples/s]
Map:  97%|█████████▋| 970/1000 [00:09<00:00, 138.76 examples/s]
Map:  99%|█████████▊| 986/1000 [00:10<00:00, 140.30 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37540.98it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 268/1000 [00:00<00:00, 2679.77it/s]
Logging series metrics to wandb:  54%|█████▎    | 537/1000 [00:00<00:00, 2685.28it/s]
Logging series metrics to wandb:  81%|████████▏ | 813/1000 [00:00<00:00, 2717.56it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2683.69it/s]
2024-01-10 19:26:09.435169: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:26:09.526242: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:26:09.526342: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:26:09.528259: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:26:09.540701: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:26:11.197519: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64772.89lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:32,  1.53s/ examples]
Map:   1%|          | 8/1000 [00:01<02:32,  6.50 examples/s]
Map:   2%|▏         | 16/1000 [00:01<01:08, 14.31 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:42, 22.80 examples/s]
Map:   3%|▎         | 34/1000 [00:01<00:28, 34.39 examples/s]
Map:   4%|▍         | 43/1000 [00:02<00:21, 43.88 examples/s]
Map:   5%|▌         | 53/1000 [00:02<00:20, 46.37 examples/s]
Map:   6%|▌         | 60/1000 [00:02<00:19, 48.70 examples/s]
Map:   7%|▋         | 68/1000 [00:02<00:17, 52.78 examples/s]
Map:   8%|▊         | 79/1000 [00:02<00:14, 63.68 examples/s]
Map:   9%|▉         | 89/1000 [00:03<00:36, 24.70 examples/s]
Map:  10%|▉         | 99/1000 [00:03<00:28, 31.97 examples/s]
Map:  11%|█         | 110/1000 [00:03<00:21, 41.76 examples/s]
Map:  12%|█▏        | 122/1000 [00:03<00:16, 52.97 examples/s]
Map:  13%|█▎        | 134/1000 [00:03<00:13, 63.81 examples/s]
Map:  14%|█▍        | 144/1000 [00:04<00:12, 69.22 examples/s]
Map:  16%|█▌        | 156/1000 [00:04<00:10, 78.01 examples/s]
Map:  17%|█▋        | 169/1000 [00:04<00:09, 89.48 examples/s]
Map:  18%|█▊        | 181/1000 [00:04<00:08, 94.77 examples/s]
Map:  19%|█▉        | 194/1000 [00:04<00:07, 102.89 examples/s]
Map:  21%|██        | 208/1000 [00:04<00:07, 108.75 examples/s]
Map:  22%|██▏       | 223/1000 [00:04<00:06, 116.88 examples/s]
Map:  24%|██▎       | 236/1000 [00:04<00:06, 118.26 examples/s]
Map:  25%|██▍       | 249/1000 [00:04<00:06, 116.24 examples/s]
Map:  26%|██▌       | 262/1000 [00:05<00:06, 115.09 examples/s]
Map:  28%|██▊       | 277/1000 [00:05<00:05, 123.24 examples/s]
Map:  30%|██▉       | 295/1000 [00:05<00:05, 138.03 examples/s]
Map:  31%|███       | 311/1000 [00:05<00:04, 143.13 examples/s]
Map:  33%|███▎      | 329/1000 [00:05<00:04, 151.01 examples/s]
Map:  35%|███▍      | 348/1000 [00:05<00:04, 155.12 examples/s]
Map:  37%|███▋      | 366/1000 [00:05<00:03, 158.52 examples/s]
Map:  39%|███▉      | 390/1000 [00:05<00:03, 155.52 examples/s]
Map:  41%|████      | 407/1000 [00:05<00:03, 154.86 examples/s]
Map:  43%|████▎     | 426/1000 [00:06<00:03, 159.79 examples/s]
Map:  44%|████▍     | 443/1000 [00:06<00:04, 136.91 examples/s]
Map:  46%|████▌     | 462/1000 [00:06<00:04, 129.06 examples/s]
Map:  48%|████▊     | 479/1000 [00:06<00:03, 137.05 examples/s]
Map:  50%|████▉     | 496/1000 [00:06<00:03, 142.93 examples/s]
Map:  52%|█████▏    | 516/1000 [00:06<00:03, 154.16 examples/s]
Map:  54%|█████▎    | 536/1000 [00:06<00:03, 143.30 examples/s]
Map:  55%|█████▌    | 554/1000 [00:07<00:03, 131.96 examples/s]
Map:  57%|█████▋    | 568/1000 [00:07<00:03, 130.80 examples/s]
Map:  58%|█████▊    | 582/1000 [00:07<00:03, 129.99 examples/s]
Map:  60%|█████▉    | 596/1000 [00:07<00:03, 128.71 examples/s]
Map:  61%|██████▏   | 613/1000 [00:07<00:03, 105.94 examples/s]
Map:  63%|██████▎   | 626/1000 [00:07<00:03, 95.92 examples/s] 
Map:  64%|██████▍   | 643/1000 [00:07<00:03, 98.24 examples/s]
Map:  66%|██████▌   | 656/1000 [00:08<00:03, 103.04 examples/s]
Map:  67%|██████▋   | 671/1000 [00:08<00:02, 112.69 examples/s]
Map:  69%|██████▊   | 686/1000 [00:08<00:02, 118.01 examples/s]
Map:  70%|███████   | 700/1000 [00:08<00:02, 121.21 examples/s]
Map:  72%|███████▏  | 716/1000 [00:08<00:02, 127.91 examples/s]
Map:  73%|███████▎  | 730/1000 [00:08<00:02, 128.26 examples/s]
Map:  75%|███████▍  | 746/1000 [00:08<00:01, 133.42 examples/s]
Map:  76%|███████▌  | 762/1000 [00:08<00:01, 138.17 examples/s]
Map:  78%|███████▊  | 782/1000 [00:09<00:01, 133.15 examples/s]
Map:  80%|███████▉  | 797/1000 [00:09<00:01, 133.94 examples/s]
Map:  81%|████████  | 812/1000 [00:09<00:01, 134.62 examples/s]
Map:  83%|████████▎ | 826/1000 [00:09<00:01, 133.54 examples/s]
Map:  84%|████████▍ | 840/1000 [00:09<00:01, 130.40 examples/s]
Map:  86%|████████▌ | 856/1000 [00:09<00:01, 114.08 examples/s]
Map:  87%|████████▋ | 873/1000 [00:09<00:01, 125.72 examples/s]
Map:  89%|████████▉ | 891/1000 [00:09<00:00, 138.21 examples/s]
Map:  91%|█████████ | 910/1000 [00:09<00:00, 150.87 examples/s]
Map:  93%|█████████▎| 928/1000 [00:10<00:00, 156.92 examples/s]
Map:  95%|█████████▍| 948/1000 [00:10<00:00, 166.93 examples/s]
Map:  98%|█████████▊| 977/1000 [00:10<00:00, 171.76 examples/s]
Map: 100%|█████████▉| 995/1000 [00:10<00:00, 171.59 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 50998.30it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  35%|███▍      | 348/1000 [00:00<00:00, 3470.08it/s]
Logging series metrics to wandb:  70%|██████▉   | 696/1000 [00:00<00:00, 3256.55it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3333.67it/s]
2024-01-10 19:26:58.912167: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:26:58.971787: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:26:58.971874: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:26:58.973525: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:26:58.982644: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:27:00.407364: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62605.29lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<27:50,  1.67s/ examples]
Map:   1%|          | 10/1000 [00:01<02:10,  7.57 examples/s]
Map:   2%|▏         | 20/1000 [00:01<00:58, 16.76 examples/s]
Map:   3%|▎         | 32/1000 [00:02<00:33, 29.06 examples/s]
Map:   4%|▍         | 44/1000 [00:02<00:22, 42.24 examples/s]
Map:   6%|▌         | 56/1000 [00:02<00:17, 54.58 examples/s]
Map:   7%|▋         | 70/1000 [00:02<00:13, 70.38 examples/s]
Map:   8%|▊         | 84/1000 [00:02<00:21, 41.65 examples/s]
Map:  10%|▉         | 97/1000 [00:03<00:17, 52.73 examples/s]
Map:  11%|█         | 112/1000 [00:03<00:13, 67.37 examples/s]
Map:  13%|█▎        | 128/1000 [00:03<00:10, 82.78 examples/s]
Map:  14%|█▍        | 142/1000 [00:03<00:09, 92.34 examples/s]
Map:  16%|█▌        | 156/1000 [00:03<00:08, 101.53 examples/s]
Map:  17%|█▋        | 172/1000 [00:03<00:07, 113.51 examples/s]
Map:  19%|█▉        | 189/1000 [00:03<00:06, 123.93 examples/s]
Map:  21%|██        | 206/1000 [00:03<00:05, 133.71 examples/s]
Map:  22%|██▏       | 223/1000 [00:03<00:05, 140.26 examples/s]
Map:  24%|██▍       | 238/1000 [00:03<00:05, 142.33 examples/s]
Map:  25%|██▌       | 254/1000 [00:04<00:05, 144.37 examples/s]
Map:  27%|██▋       | 271/1000 [00:04<00:04, 146.47 examples/s]
Map:  29%|██▉       | 289/1000 [00:04<00:04, 154.66 examples/s]
Map:  31%|███       | 307/1000 [00:04<00:04, 159.67 examples/s]
Map:  32%|███▏      | 324/1000 [00:04<00:04, 158.96 examples/s]
Map:  34%|███▍      | 341/1000 [00:04<00:04, 160.56 examples/s]
Map:  36%|███▌      | 360/1000 [00:04<00:03, 165.88 examples/s]
Map:  38%|███▊      | 377/1000 [00:04<00:03, 164.78 examples/s]
Map:  40%|███▉      | 395/1000 [00:04<00:03, 165.09 examples/s]
Map:  42%|████▏     | 417/1000 [00:05<00:03, 155.54 examples/s]
Map:  44%|████▎     | 437/1000 [00:05<00:03, 164.07 examples/s]
Map:  46%|████▌     | 462/1000 [00:05<00:03, 161.37 examples/s]
Map:  48%|████▊     | 479/1000 [00:05<00:03, 162.08 examples/s]
Map:  50%|████▉     | 496/1000 [00:05<00:03, 160.99 examples/s]
Map:  51%|█████▏    | 514/1000 [00:05<00:02, 163.98 examples/s]
Map:  53%|█████▎    | 534/1000 [00:05<00:02, 168.70 examples/s]
Map:  55%|█████▌    | 553/1000 [00:05<00:02, 170.41 examples/s]
Map:  58%|█████▊    | 577/1000 [00:06<00:02, 164.78 examples/s]
Map:  60%|█████▉    | 596/1000 [00:06<00:02, 168.21 examples/s]
Map:  62%|██████▏   | 615/1000 [00:06<00:02, 171.17 examples/s]
Map:  63%|██████▎   | 634/1000 [00:06<00:02, 174.27 examples/s]
Map:  65%|██████▌   | 653/1000 [00:06<00:02, 172.87 examples/s]
Map:  68%|██████▊   | 679/1000 [00:06<00:01, 170.43 examples/s]
Map:  70%|██████▉   | 697/1000 [00:06<00:01, 171.59 examples/s]
Map:  72%|███████▏  | 716/1000 [00:06<00:01, 172.39 examples/s]
Map:  74%|███████▍  | 742/1000 [00:07<00:01, 168.40 examples/s]
Map:  76%|███████▋  | 763/1000 [00:07<00:01, 177.31 examples/s]
Map:  78%|███████▊  | 781/1000 [00:07<00:01, 173.09 examples/s]
Map:  80%|████████  | 800/1000 [00:07<00:01, 171.45 examples/s]
Map:  83%|████████▎ | 826/1000 [00:07<00:01, 168.59 examples/s]
Map:  84%|████████▍ | 844/1000 [00:07<00:00, 168.94 examples/s]
Map:  86%|████████▌ | 862/1000 [00:07<00:00, 168.57 examples/s]
Map:  88%|████████▊ | 879/1000 [00:07<00:00, 164.14 examples/s]
Map:  90%|████████▉ | 899/1000 [00:07<00:00, 170.98 examples/s]
Map:  92%|█████████▏| 918/1000 [00:08<00:00, 173.49 examples/s]
Map:  94%|█████████▍| 941/1000 [00:08<00:00, 159.71 examples/s]
Map:  96%|█████████▌| 959/1000 [00:08<00:00, 162.94 examples/s]
Map:  98%|█████████▊| 978/1000 [00:08<00:00, 167.28 examples/s]
Map: 100%|█████████▉| 995/1000 [00:08<00:00, 167.24 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47125.42it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 318/1000 [00:00<00:00, 3177.28it/s]
Logging series metrics to wandb:  67%|██████▋   | 667/1000 [00:00<00:00, 3356.96it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3293.51it/s]
2024-01-10 19:27:46.789207: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:27:46.842636: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:27:46.842715: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:27:46.844370: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:27:46.852811: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:27:48.315911: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61216.42lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 19/1000 [00:00<00:05, 175.24 examples/s]
Map:   4%|▍         | 39/1000 [00:00<00:05, 180.48 examples/s]
Map:   6%|▌         | 58/1000 [00:00<00:05, 179.21 examples/s]
Map:   8%|▊         | 79/1000 [00:00<00:04, 185.76 examples/s]
Map:  10%|▉         | 98/1000 [00:00<00:04, 183.81 examples/s]
Map:  12%|█▏        | 119/1000 [00:00<00:04, 189.88 examples/s]
Map:  14%|█▍        | 139/1000 [00:00<00:04, 190.15 examples/s]
Map:  16%|█▌        | 159/1000 [00:00<00:04, 191.49 examples/s]
Map:  18%|█▊        | 179/1000 [00:00<00:04, 192.35 examples/s]
Map:  20%|█▉        | 199/1000 [00:01<00:04, 192.80 examples/s]
Map:  22%|██▏       | 221/1000 [00:01<00:03, 198.51 examples/s]
Map:  24%|██▍       | 241/1000 [00:01<00:03, 196.12 examples/s]
Map:  26%|██▌       | 261/1000 [00:01<00:03, 195.41 examples/s]
Map:  28%|██▊       | 282/1000 [00:01<00:03, 195.06 examples/s]
Map:  30%|███       | 304/1000 [00:01<00:03, 198.16 examples/s]
Map:  33%|███▎      | 327/1000 [00:01<00:03, 202.88 examples/s]
Map:  35%|███▍      | 348/1000 [00:01<00:03, 201.26 examples/s]
Map:  38%|███▊      | 377/1000 [00:01<00:03, 193.01 examples/s]
Map:  40%|████      | 405/1000 [00:02<00:03, 187.57 examples/s]
Map:  42%|████▏     | 424/1000 [00:02<00:03, 186.56 examples/s]
Map:  44%|████▍     | 444/1000 [00:02<00:02, 188.15 examples/s]
Map:  46%|████▋     | 463/1000 [00:02<00:02, 185.52 examples/s]
Map:  48%|████▊     | 484/1000 [00:02<00:02, 189.55 examples/s]
Map:  50%|█████     | 504/1000 [00:02<00:02, 189.52 examples/s]
Map:  52%|█████▎    | 525/1000 [00:02<00:02, 190.35 examples/s]
Map:  55%|█████▍    | 546/1000 [00:02<00:02, 192.96 examples/s]
Map:  57%|█████▋    | 566/1000 [00:02<00:02, 192.25 examples/s]
Map:  59%|█████▉    | 593/1000 [00:03<00:02, 185.33 examples/s]
Map:  61%|██████▏   | 613/1000 [00:03<00:02, 188.15 examples/s]
Map:  63%|██████▎   | 633/1000 [00:03<00:01, 189.39 examples/s]
Map:  65%|██████▌   | 654/1000 [00:03<00:01, 189.94 examples/s]
Map:  68%|██████▊   | 681/1000 [00:03<00:01, 182.38 examples/s]
Map:  71%|███████   | 707/1000 [00:03<00:01, 176.18 examples/s]
Map:  73%|███████▎  | 726/1000 [00:03<00:01, 177.54 examples/s]
Map:  75%|███████▍  | 746/1000 [00:03<00:01, 180.88 examples/s]
Map:  77%|███████▋  | 766/1000 [00:04<00:01, 183.95 examples/s]
Map:  79%|███████▊  | 786/1000 [00:04<00:01, 184.51 examples/s]
Map:  81%|████████  | 806/1000 [00:04<00:01, 187.81 examples/s]
Map:  83%|████████▎ | 827/1000 [00:04<00:00, 191.83 examples/s]
Map:  85%|████████▍ | 848/1000 [00:04<00:00, 194.67 examples/s]
Map:  88%|████████▊ | 875/1000 [00:04<00:00, 185.71 examples/s]
Map:  90%|████████▉ | 895/1000 [00:04<00:00, 187.19 examples/s]
Map:  92%|█████████▏| 915/1000 [00:04<00:00, 188.60 examples/s]
Map:  94%|█████████▎| 936/1000 [00:04<00:00, 188.87 examples/s]
Map:  96%|█████████▌| 958/1000 [00:05<00:00, 193.84 examples/s]
Map:  98%|█████████▊| 978/1000 [00:05<00:00, 195.02 examples/s]
Map: 100%|█████████▉| 999/1000 [00:05<00:00, 195.58 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 22481.01it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 261/1000 [00:00<00:00, 2608.61it/s]
Logging series metrics to wandb:  56%|█████▌    | 558/1000 [00:00<00:00, 2815.81it/s]
Logging series metrics to wandb:  84%|████████▍ | 840/1000 [00:00<00:00, 2812.96it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2691.83it/s]
2024-01-10 19:28:30.715610: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:28:30.773829: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:28:30.773909: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:28:30.775324: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:28:30.783574: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:28:32.201139: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62763.61lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  13%|█▎        | 126/1000 [00:00<00:00, 1242.34 examples/s]
Map:  27%|██▋       | 271/1000 [00:00<00:00, 1355.99 examples/s]
Map:  42%|████▏     | 422/1000 [00:00<00:00, 1419.76 examples/s]
Map:  57%|█████▋    | 570/1000 [00:00<00:00, 1437.41 examples/s]
Map:  72%|███████▏  | 719/1000 [00:00<00:00, 1450.75 examples/s]
Map:  86%|████████▋ | 865/1000 [00:00<00:00, 1448.29 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34439.95it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▍       | 238/1000 [00:00<00:00, 2375.06it/s]
Logging series metrics to wandb:  48%|████▊     | 478/1000 [00:00<00:00, 2385.20it/s]
Logging series metrics to wandb:  74%|███████▍  | 742/1000 [00:00<00:00, 2501.14it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2528.53it/s]
2024-01-10 19:29:09.864247: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:29:09.915970: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:29:09.916084: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:29:09.917625: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:29:09.925618: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:29:11.344717: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 46358.71lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  15%|█▍        | 147/1000 [00:00<00:00, 1439.35 examples/s]
Map:  32%|███▏      | 322/1000 [00:00<00:00, 1612.88 examples/s]
Map:  49%|████▉     | 493/1000 [00:00<00:00, 1653.46 examples/s]
Map:  66%|██████▌   | 659/1000 [00:00<00:00, 1651.16 examples/s]
Map:  83%|████████▎ | 828/1000 [00:00<00:00, 1663.21 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1440.05 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 33537.26it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 273/1000 [00:00<00:00, 2721.70it/s]
Logging series metrics to wandb:  56%|█████▌    | 558/1000 [00:00<00:00, 2793.03it/s]
Logging series metrics to wandb:  84%|████████▍ | 839/1000 [00:00<00:00, 2799.17it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2746.07it/s]
2024-01-10 19:29:48.010451: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:29:48.070601: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:29:48.070675: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:29:48.072008: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:29:48.078949: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:29:49.543374: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62519.44lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  20%|██        | 200/1000 [00:00<00:00, 1966.53 examples/s]
Map:  44%|████▍     | 445/1000 [00:00<00:00, 2247.69 examples/s]
Map:  67%|██████▋   | 673/1000 [00:00<00:00, 2259.34 examples/s]
Map:  92%|█████████▏| 916/1000 [00:00<00:00, 2325.82 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 22043.15it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 258/1000 [00:00<00:00, 2569.39it/s]
Logging series metrics to wandb:  52%|█████▏    | 515/1000 [00:00<00:00, 2552.34it/s]
Logging series metrics to wandb:  77%|███████▋  | 771/1000 [00:00<00:00, 2509.71it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2546.45it/s]
2024-01-10 19:30:26.900319: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:30:26.986805: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:30:26.986903: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:30:26.988212: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:30:26.996194: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:30:28.480225: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65136.02lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  14%|█▍        | 144/1000 [00:00<00:00, 1413.24 examples/s]
Map:  31%|███▏      | 313/1000 [00:00<00:00, 1570.14 examples/s]
Map:  48%|████▊     | 485/1000 [00:00<00:00, 1630.57 examples/s]
Map:  66%|██████▌   | 658/1000 [00:00<00:00, 1662.97 examples/s]
Map:  83%|████████▎ | 833/1000 [00:00<00:00, 1691.79 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34904.25it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 270/1000 [00:00<00:00, 2698.99it/s]
Logging series metrics to wandb:  55%|█████▍    | 548/1000 [00:00<00:00, 2744.25it/s]
Logging series metrics to wandb:  82%|████████▎ | 825/1000 [00:00<00:00, 2752.17it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2710.90it/s]
finish opt
2024-01-10 19:31:06.188765: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:31:06.238681: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:31:06.238740: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:31:06.239887: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:31:06.246924: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:31:07.730142: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 58228.34lines/s]
Running swap attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  15%|█▌        | 152/1000 [00:00<00:00, 1501.53 examples/s]
Map:  31%|███       | 306/1000 [00:00<00:00, 1518.41 examples/s]
Map:  53%|█████▎    | 533/1000 [00:00<00:00, 1511.60 examples/s]
Map:  69%|██████▉   | 693/1000 [00:00<00:00, 1539.43 examples/s]
Map:  85%|████████▌ | 850/1000 [00:00<00:00, 1544.06 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 39092.42it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 260/1000 [00:00<00:00, 2593.65it/s]
Logging series metrics to wandb:  52%|█████▏    | 524/1000 [00:00<00:00, 2620.24it/s]
Logging series metrics to wandb:  80%|████████  | 800/1000 [00:00<00:00, 2680.07it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2681.29it/s]
2024-01-10 19:31:44.810977: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:31:44.862416: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:31:44.862506: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:31:44.863843: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:31:44.871935: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:31:46.265688: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 57185.18lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<22:35,  1.36s/ examples]
Map:   1%|          | 8/1000 [00:01<02:17,  7.20 examples/s]
Map:   1%|▏         | 14/1000 [00:01<01:14, 13.29 examples/s]
Map:   2%|▏         | 23/1000 [00:01<00:41, 23.50 examples/s]
Map:   3%|▎         | 32/1000 [00:01<00:28, 33.40 examples/s]
Map:   4%|▍         | 43/1000 [00:01<00:20, 46.60 examples/s]
Map:   5%|▌         | 53/1000 [00:02<00:35, 26.97 examples/s]
Map:   6%|▋         | 65/1000 [00:02<00:25, 37.25 examples/s]
Map:   8%|▊         | 76/1000 [00:02<00:19, 47.04 examples/s]
Map:   9%|▊         | 87/1000 [00:02<00:16, 55.97 examples/s]
Map:  10%|▉         | 98/1000 [00:03<00:13, 65.17 examples/s]
Map:  11%|█         | 110/1000 [00:03<00:11, 74.28 examples/s]
Map:  12%|█▏        | 121/1000 [00:03<00:10, 80.79 examples/s]
Map:  14%|█▎        | 135/1000 [00:03<00:09, 92.16 examples/s]
Map:  15%|█▍        | 146/1000 [00:03<00:09, 94.49 examples/s]
Map:  16%|█▌        | 158/1000 [00:03<00:08, 98.05 examples/s]
Map:  18%|█▊        | 175/1000 [00:03<00:08, 100.34 examples/s]
Map:  19%|█▊        | 186/1000 [00:03<00:08, 100.58 examples/s]
Map:  20%|█▉        | 198/1000 [00:03<00:07, 103.33 examples/s]
Map:  21%|██        | 210/1000 [00:04<00:07, 105.17 examples/s]
Map:  22%|██▏       | 222/1000 [00:04<00:07, 108.32 examples/s]
Map:  24%|██▎       | 236/1000 [00:04<00:06, 113.07 examples/s]
Map:  26%|██▌       | 255/1000 [00:04<00:06, 115.60 examples/s]
Map:  27%|██▋       | 267/1000 [00:04<00:06, 116.00 examples/s]
Map:  28%|██▊       | 281/1000 [00:04<00:05, 120.91 examples/s]
Map:  30%|██▉       | 298/1000 [00:04<00:06, 116.87 examples/s]
Map:  31%|███       | 312/1000 [00:04<00:05, 119.42 examples/s]
Map:  32%|███▎      | 325/1000 [00:05<00:05, 119.34 examples/s]
Map:  34%|███▍      | 343/1000 [00:05<00:05, 116.58 examples/s]
Map:  36%|███▌      | 357/1000 [00:05<00:05, 120.11 examples/s]
Map:  37%|███▋      | 372/1000 [00:05<00:05, 123.93 examples/s]
Map:  39%|███▊      | 386/1000 [00:05<00:04, 125.87 examples/s]
Map:  40%|████      | 400/1000 [00:05<00:04, 125.89 examples/s]
Map:  42%|████▏     | 415/1000 [00:05<00:04, 131.10 examples/s]
Map:  43%|████▎     | 429/1000 [00:05<00:04, 131.23 examples/s]
Map:  44%|████▍     | 444/1000 [00:05<00:04, 134.20 examples/s]
Map:  46%|████▌     | 462/1000 [00:06<00:04, 123.37 examples/s]
Map:  48%|████▊     | 476/1000 [00:06<00:04, 125.39 examples/s]
Map:  49%|████▉     | 491/1000 [00:06<00:03, 130.41 examples/s]
Map:  51%|█████     | 506/1000 [00:06<00:03, 133.17 examples/s]
Map:  52%|█████▏    | 521/1000 [00:06<00:03, 135.06 examples/s]
Map:  54%|█████▎    | 537/1000 [00:06<00:03, 139.55 examples/s]
Map:  56%|█████▌    | 558/1000 [00:06<00:03, 137.72 examples/s]
Map:  57%|█████▋    | 573/1000 [00:06<00:03, 139.30 examples/s]
Map:  59%|█████▉    | 592/1000 [00:07<00:02, 149.63 examples/s]
Map:  61%|██████    | 612/1000 [00:07<00:02, 161.74 examples/s]
Map:  63%|██████▎   | 632/1000 [00:07<00:02, 169.47 examples/s]
Map:  65%|██████▌   | 652/1000 [00:07<00:01, 177.10 examples/s]
Map:  67%|██████▋   | 673/1000 [00:07<00:01, 184.29 examples/s]
Map:  70%|██████▉   | 698/1000 [00:07<00:01, 198.24 examples/s]
Map:  73%|███████▎  | 727/1000 [00:07<00:01, 194.41 examples/s]
Map:  75%|███████▌  | 750/1000 [00:07<00:01, 202.44 examples/s]
Map:  77%|███████▋  | 771/1000 [00:07<00:01, 202.61 examples/s]
Map:  80%|███████▉  | 795/1000 [00:08<00:00, 211.62 examples/s]
Map:  83%|████████▎ | 829/1000 [00:08<00:00, 213.52 examples/s]
Map:  86%|████████▌ | 861/1000 [00:08<00:00, 209.12 examples/s]
Map:  88%|████████▊ | 884/1000 [00:08<00:00, 212.64 examples/s]
Map:  91%|█████████ | 906/1000 [00:08<00:00, 212.77 examples/s]
Map:  94%|█████████▎| 936/1000 [00:08<00:00, 203.88 examples/s]
Map:  96%|█████████▌| 959/1000 [00:08<00:00, 210.06 examples/s]
Map:  98%|█████████▊| 982/1000 [00:08<00:00, 213.37 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 56800.29it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 322/1000 [00:00<00:00, 3215.73it/s]
Logging series metrics to wandb:  64%|██████▍   | 644/1000 [00:00<00:00, 2896.43it/s]
Logging series metrics to wandb:  94%|█████████▎| 936/1000 [00:00<00:00, 2855.13it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2922.62it/s]
2024-01-10 19:32:29.537478: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:32:29.583469: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:32:29.583523: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:32:29.584658: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:32:29.591249: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:32:30.468729: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 67744.03lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<18:30,  1.11s/ examples]
Map:   1%|          | 11/1000 [00:01<01:23, 11.91 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:41, 23.80 examples/s]
Map:   4%|▎         | 35/1000 [00:01<00:23, 41.39 examples/s]
Map:   5%|▌         | 50/1000 [00:01<00:15, 60.74 examples/s]
Map:   6%|▌         | 62/1000 [00:02<00:24, 38.96 examples/s]
Map:   8%|▊         | 78/1000 [00:02<00:16, 54.78 examples/s]
Map:   9%|▉         | 94/1000 [00:02<00:12, 70.55 examples/s]
Map:  11%|█         | 111/1000 [00:02<00:10, 88.03 examples/s]
Map:  13%|█▎        | 127/1000 [00:02<00:08, 100.99 examples/s]
Map:  14%|█▍        | 145/1000 [00:02<00:07, 116.84 examples/s]
Map:  16%|█▋        | 163/1000 [00:02<00:06, 128.94 examples/s]
Map:  18%|█▊        | 181/1000 [00:02<00:05, 139.34 examples/s]
Map:  20%|█▉        | 197/1000 [00:02<00:05, 144.18 examples/s]
Map:  22%|██▏       | 215/1000 [00:03<00:05, 151.61 examples/s]
Map:  23%|██▎       | 233/1000 [00:03<00:04, 157.97 examples/s]
Map:  25%|██▌       | 254/1000 [00:03<00:04, 169.13 examples/s]
Map:  27%|██▋       | 273/1000 [00:03<00:04, 173.00 examples/s]
Map:  29%|██▉       | 293/1000 [00:03<00:03, 179.11 examples/s]
Map:  31%|███▏      | 313/1000 [00:03<00:03, 180.50 examples/s]
Map:  34%|███▍      | 342/1000 [00:03<00:03, 180.38 examples/s]
Map:  36%|███▌      | 362/1000 [00:03<00:03, 184.24 examples/s]
Map:  38%|███▊      | 383/1000 [00:03<00:03, 188.28 examples/s]
Map:  40%|████      | 404/1000 [00:04<00:03, 192.00 examples/s]
Map:  42%|████▎     | 425/1000 [00:04<00:02, 193.39 examples/s]
Map:  44%|████▍     | 445/1000 [00:04<00:02, 190.00 examples/s]
Map:  47%|████▋     | 474/1000 [00:04<00:02, 186.65 examples/s]
Map:  50%|████▉     | 495/1000 [00:04<00:02, 189.31 examples/s]
Map:  52%|█████▏    | 516/1000 [00:04<00:02, 190.22 examples/s]
Map:  54%|█████▍    | 539/1000 [00:04<00:02, 196.19 examples/s]
Map:  56%|█████▌    | 559/1000 [00:04<00:02, 193.76 examples/s]
Map:  59%|█████▉    | 588/1000 [00:05<00:02, 188.76 examples/s]
Map:  62%|██████▏   | 615/1000 [00:05<00:02, 183.57 examples/s]
Map:  64%|██████▎   | 636/1000 [00:05<00:01, 186.87 examples/s]
Map:  66%|██████▌   | 655/1000 [00:05<00:01, 185.72 examples/s]
Map:  68%|██████▊   | 677/1000 [00:05<00:01, 192.10 examples/s]
Map:  70%|███████   | 702/1000 [00:05<00:01, 204.93 examples/s]
Map:  72%|███████▏  | 724/1000 [00:05<00:01, 205.93 examples/s]
Map:  76%|███████▌  | 755/1000 [00:05<00:01, 203.49 examples/s]
Map:  78%|███████▊  | 777/1000 [00:05<00:01, 205.02 examples/s]
Map:  80%|███████▉  | 798/1000 [00:06<00:01, 200.14 examples/s]
Map:  83%|████████▎ | 830/1000 [00:06<00:00, 200.71 examples/s]
Map:  86%|████████▌ | 859/1000 [00:06<00:00, 194.82 examples/s]
Map:  88%|████████▊ | 880/1000 [00:06<00:00, 193.87 examples/s]
Map:  91%|█████████ | 909/1000 [00:06<00:00, 188.14 examples/s]
Map:  93%|█████████▎| 929/1000 [00:06<00:00, 189.35 examples/s]
Map:  96%|█████████▌| 961/1000 [00:06<00:00, 193.43 examples/s]
Map:  98%|█████████▊| 982/1000 [00:07<00:00, 194.71 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 44902.09it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 322/1000 [00:00<00:00, 3213.13it/s]
Logging series metrics to wandb:  64%|██████▍   | 645/1000 [00:00<00:00, 3219.02it/s]
Logging series metrics to wandb:  98%|█████████▊| 981/1000 [00:00<00:00, 3281.04it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3261.69it/s]
2024-01-10 19:33:15.558076: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:33:15.611125: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:33:15.611222: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:33:15.612695: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:33:15.621152: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:33:17.149243: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63749.03lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:57,  1.56s/ examples]
Map:   1%|          | 8/1000 [00:01<02:37,  6.32 examples/s]
Map:   1%|▏         | 14/1000 [00:01<01:23, 11.79 examples/s]
Map:   2%|▏         | 23/1000 [00:01<00:46, 20.87 examples/s]
Map:   3%|▎         | 31/1000 [00:02<00:33, 29.01 examples/s]
Map:   4%|▍         | 42/1000 [00:02<00:22, 41.77 examples/s]
Map:   5%|▌         | 51/1000 [00:02<00:18, 49.98 examples/s]
Map:   6%|▋         | 63/1000 [00:03<00:35, 26.05 examples/s]
Map:   7%|▋         | 73/1000 [00:03<00:27, 33.78 examples/s]
Map:   8%|▊         | 83/1000 [00:03<00:21, 42.07 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:17, 50.86 examples/s]
Map:  10%|█         | 105/1000 [00:03<00:15, 59.02 examples/s]
Map:  12%|█▏        | 116/1000 [00:03<00:13, 67.95 examples/s]
Map:  13%|█▎        | 126/1000 [00:03<00:12, 72.44 examples/s]
Map:  14%|█▍        | 139/1000 [00:03<00:10, 83.97 examples/s]
Map:  15%|█▌        | 150/1000 [00:03<00:09, 87.40 examples/s]
Map:  16%|█▌        | 162/1000 [00:04<00:09, 92.63 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:08, 98.38 examples/s]
Map:  18%|█▊        | 185/1000 [00:04<00:08, 98.99 examples/s]
Map:  20%|█▉        | 198/1000 [00:04<00:07, 102.24 examples/s]
Map:  21%|██        | 210/1000 [00:04<00:07, 105.04 examples/s]
Map:  22%|██▏       | 222/1000 [00:04<00:07, 108.15 examples/s]
Map:  23%|██▎       | 233/1000 [00:04<00:07, 107.92 examples/s]
Map:  25%|██▍       | 246/1000 [00:04<00:06, 110.07 examples/s]
Map:  26%|██▌       | 259/1000 [00:04<00:06, 112.23 examples/s]
Map:  27%|██▋       | 272/1000 [00:05<00:06, 113.05 examples/s]
Map:  29%|██▊       | 286/1000 [00:05<00:06, 118.24 examples/s]
Map:  30%|██▉       | 298/1000 [00:05<00:06, 116.29 examples/s]
Map:  31%|███       | 310/1000 [00:05<00:06, 112.71 examples/s]
Map:  32%|███▏      | 323/1000 [00:05<00:05, 114.06 examples/s]
Map:  34%|███▎      | 335/1000 [00:05<00:05, 113.04 examples/s]
Map:  35%|███▍      | 348/1000 [00:05<00:05, 115.47 examples/s]
Map:  36%|███▋      | 363/1000 [00:05<00:05, 121.52 examples/s]
Map:  38%|███▊      | 377/1000 [00:05<00:05, 124.42 examples/s]
Map:  39%|███▉      | 391/1000 [00:06<00:04, 126.00 examples/s]
Map:  40%|████      | 404/1000 [00:06<00:04, 122.80 examples/s]
Map:  42%|████▏     | 419/1000 [00:06<00:04, 128.16 examples/s]
Map:  44%|████▍     | 439/1000 [00:06<00:04, 127.68 examples/s]
Map:  45%|████▌     | 452/1000 [00:06<00:04, 125.80 examples/s]
Map:  46%|████▋     | 465/1000 [00:06<00:04, 124.53 examples/s]
Map:  48%|████▊     | 479/1000 [00:06<00:04, 125.93 examples/s]
Map:  49%|████▉     | 492/1000 [00:06<00:04, 125.47 examples/s]
Map:  51%|█████     | 506/1000 [00:06<00:03, 125.93 examples/s]
Map:  52%|█████▏    | 519/1000 [00:07<00:03, 125.07 examples/s]
Map:  54%|█████▎    | 535/1000 [00:07<00:03, 132.96 examples/s]
Map:  56%|█████▌    | 555/1000 [00:07<00:03, 130.16 examples/s]
Map:  57%|█████▋    | 573/1000 [00:07<00:03, 123.08 examples/s]
Map:  59%|█████▉    | 592/1000 [00:07<00:03, 121.40 examples/s]
Map:  60%|██████    | 605/1000 [00:07<00:03, 120.73 examples/s]
Map:  62%|██████▏   | 619/1000 [00:07<00:03, 123.54 examples/s]
Map:  63%|██████▎   | 632/1000 [00:07<00:02, 123.76 examples/s]
Map:  65%|██████▍   | 646/1000 [00:08<00:02, 125.84 examples/s]
Map:  66%|██████▌   | 661/1000 [00:08<00:02, 128.99 examples/s]
Map:  67%|██████▋   | 674/1000 [00:08<00:02, 125.59 examples/s]
Map:  69%|██████▉   | 691/1000 [00:08<00:02, 134.73 examples/s]
Map:  70%|███████   | 705/1000 [00:08<00:02, 114.61 examples/s]
Map:  72%|███████▏  | 719/1000 [00:08<00:02, 118.51 examples/s]
Map:  74%|███████▍  | 739/1000 [00:08<00:02, 121.60 examples/s]
Map:  75%|███████▌  | 754/1000 [00:08<00:01, 125.74 examples/s]
Map:  77%|███████▋  | 767/1000 [00:09<00:01, 125.32 examples/s]
Map:  78%|███████▊  | 781/1000 [00:09<00:01, 127.92 examples/s]
Map:  80%|███████▉  | 795/1000 [00:09<00:01, 127.78 examples/s]
Map:  81%|████████▏ | 814/1000 [00:09<00:01, 124.04 examples/s]
Map:  83%|████████▎ | 829/1000 [00:09<00:01, 128.39 examples/s]
Map:  84%|████████▍ | 842/1000 [00:09<00:01, 126.64 examples/s]
Map:  86%|████████▌ | 862/1000 [00:09<00:01, 126.70 examples/s]
Map:  88%|████████▊ | 878/1000 [00:09<00:00, 132.29 examples/s]
Map:  90%|████████▉ | 898/1000 [00:10<00:00, 130.50 examples/s]
Map:  91%|█████████▏| 914/1000 [00:10<00:00, 133.88 examples/s]
Map:  93%|█████████▎| 929/1000 [00:10<00:00, 136.57 examples/s]
Map:  95%|█████████▍| 949/1000 [00:10<00:00, 133.47 examples/s]
Map:  97%|█████████▋| 966/1000 [00:10<00:00, 140.11 examples/s]
Map:  98%|█████████▊| 982/1000 [00:10<00:00, 143.70 examples/s]
Map: 100%|█████████▉| 999/1000 [00:10<00:00, 147.63 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 55620.00it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  35%|███▌      | 350/1000 [00:00<00:00, 3493.76it/s]
Logging series metrics to wandb:  70%|███████   | 700/1000 [00:00<00:00, 3206.98it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3397.65it/s]
2024-01-10 19:34:04.918296: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:34:04.970520: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:34:04.970608: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:34:04.972009: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:34:04.980434: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:34:06.707774: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65865.33lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<29:13,  1.75s/ examples]
Map:   1%|          | 8/1000 [00:01<02:54,  5.67 examples/s]
Map:   2%|▏         | 15/1000 [00:02<01:25, 11.58 examples/s]
Map:   2%|▏         | 23/1000 [00:02<00:50, 19.31 examples/s]
Map:   3%|▎         | 30/1000 [00:02<00:36, 26.37 examples/s]
Map:   4%|▍         | 41/1000 [00:02<00:24, 39.44 examples/s]
Map:   5%|▌         | 50/1000 [00:02<00:19, 48.91 examples/s]
Map:   6%|▌         | 59/1000 [00:03<00:39, 23.70 examples/s]
Map:   7%|▋         | 69/1000 [00:03<00:29, 31.71 examples/s]
Map:   8%|▊         | 81/1000 [00:03<00:21, 42.92 examples/s]
Map:   9%|▉         | 91/1000 [00:03<00:17, 51.35 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:15, 59.18 examples/s]
Map:  11%|█         | 112/1000 [00:03<00:12, 68.85 examples/s]
Map:  12%|█▏        | 123/1000 [00:03<00:11, 75.87 examples/s]
Map:  14%|█▎        | 136/1000 [00:03<00:09, 86.47 examples/s]
Map:  15%|█▌        | 151/1000 [00:04<00:09, 89.87 examples/s]
Map:  16%|█▌        | 162/1000 [00:04<00:08, 93.34 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:08, 99.01 examples/s]
Map:  18%|█▊        | 185/1000 [00:04<00:08, 99.78 examples/s]
Map:  20%|█▉        | 197/1000 [00:04<00:07, 102.21 examples/s]
Map:  21%|██        | 209/1000 [00:04<00:07, 102.58 examples/s]
Map:  22%|██▏       | 221/1000 [00:04<00:07, 103.35 examples/s]
Map:  23%|██▎       | 233/1000 [00:04<00:07, 104.86 examples/s]
Map:  25%|██▍       | 248/1000 [00:05<00:06, 116.60 examples/s]
Map:  26%|██▋       | 265/1000 [00:05<00:05, 130.39 examples/s]
Map:  28%|██▊       | 283/1000 [00:05<00:05, 142.57 examples/s]
Map:  30%|██▉       | 298/1000 [00:05<00:04, 141.21 examples/s]
Map:  31%|███▏      | 313/1000 [00:05<00:04, 142.91 examples/s]
Map:  33%|███▎      | 328/1000 [00:05<00:04, 141.32 examples/s]
Map:  35%|███▍      | 346/1000 [00:05<00:04, 150.39 examples/s]
Map:  36%|███▋      | 365/1000 [00:05<00:03, 159.03 examples/s]
Map:  38%|███▊      | 383/1000 [00:05<00:03, 160.26 examples/s]
Map:  40%|████      | 401/1000 [00:05<00:03, 160.25 examples/s]
Map:  42%|████▏     | 420/1000 [00:06<00:03, 167.48 examples/s]
Map:  44%|████▎     | 437/1000 [00:06<00:03, 166.36 examples/s]
Map:  46%|████▌     | 455/1000 [00:06<00:03, 168.37 examples/s]
Map:  47%|████▋     | 473/1000 [00:06<00:03, 167.78 examples/s]
Map:  49%|████▉     | 492/1000 [00:06<00:02, 172.10 examples/s]
Map:  51%|█████     | 511/1000 [00:06<00:02, 174.36 examples/s]
Map:  53%|█████▎    | 530/1000 [00:06<00:02, 175.70 examples/s]
Map:  55%|█████▌    | 550/1000 [00:06<00:02, 179.97 examples/s]
Map:  58%|█████▊    | 577/1000 [00:06<00:02, 174.64 examples/s]
Map:  60%|█████▉    | 595/1000 [00:07<00:02, 174.22 examples/s]
Map:  61%|██████▏   | 613/1000 [00:07<00:02, 172.50 examples/s]
Map:  63%|██████▎   | 632/1000 [00:07<00:02, 173.14 examples/s]
Map:  65%|██████▌   | 650/1000 [00:07<00:02, 173.00 examples/s]
Map:  67%|██████▋   | 670/1000 [00:07<00:01, 174.69 examples/s]
Map:  69%|██████▉   | 690/1000 [00:07<00:01, 178.10 examples/s]
Map:  71%|███████   | 709/1000 [00:07<00:01, 180.06 examples/s]
Map:  73%|███████▎  | 729/1000 [00:07<00:01, 182.13 examples/s]
Map:  75%|███████▍  | 749/1000 [00:07<00:01, 183.60 examples/s]
Map:  77%|███████▋  | 768/1000 [00:08<00:01, 181.70 examples/s]
Map:  79%|███████▉  | 788/1000 [00:08<00:01, 182.82 examples/s]
Map:  81%|████████  | 807/1000 [00:08<00:01, 180.51 examples/s]
Map:  83%|████████▎ | 826/1000 [00:08<00:00, 182.17 examples/s]
Map:  84%|████████▍ | 845/1000 [00:08<00:00, 179.16 examples/s]
Map:  86%|████████▋ | 863/1000 [00:08<00:00, 177.07 examples/s]
Map:  88%|████████▊ | 883/1000 [00:08<00:00, 179.33 examples/s]
Map:  91%|█████████ | 910/1000 [00:08<00:00, 177.99 examples/s]
Map:  93%|█████████▎| 929/1000 [00:08<00:00, 178.59 examples/s]
Map:  95%|█████████▍| 947/1000 [00:09<00:00, 176.41 examples/s]
Map:  97%|█████████▋| 970/1000 [00:09<00:00, 186.34 examples/s]
Map:  99%|█████████▉| 991/1000 [00:09<00:00, 190.58 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 50380.21it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 324/1000 [00:00<00:00, 3237.19it/s]
Logging series metrics to wandb:  65%|██████▌   | 651/1000 [00:00<00:00, 3253.50it/s]
Logging series metrics to wandb:  98%|█████████▊| 979/1000 [00:00<00:00, 3261.64it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3254.50it/s]
2024-01-10 19:34:52.412168: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:34:52.466592: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:34:52.466689: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:34:52.468069: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:34:52.476775: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:34:53.910989: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62356.78lines/s]
Running synonym attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<31:33,  1.90s/ examples]
Map:   1%|          | 8/1000 [00:02<03:07,  5.29 examples/s]
Map:   1%|▏         | 14/1000 [00:02<01:37, 10.08 examples/s]
Map:   2%|▏         | 21/1000 [00:02<00:59, 16.58 examples/s]
Map:   3%|▎         | 30/1000 [00:02<00:37, 25.87 examples/s]
Map:   4%|▎         | 36/1000 [00:02<00:31, 30.71 examples/s]
Map:   4%|▍         | 45/1000 [00:02<00:23, 41.09 examples/s]
Map:   5%|▌         | 53/1000 [00:03<00:48, 19.38 examples/s]
Map:   6%|▋         | 63/1000 [00:03<00:34, 27.38 examples/s]
Map:   7%|▋         | 74/1000 [00:03<00:24, 37.22 examples/s]
Map:   8%|▊         | 85/1000 [00:03<00:19, 47.44 examples/s]
Map:  10%|▉         | 95/1000 [00:03<00:16, 54.78 examples/s]
Map:  10%|█         | 104/1000 [00:03<00:14, 60.81 examples/s]
Map:  12%|█▏        | 115/1000 [00:04<00:12, 70.74 examples/s]
Map:  13%|█▎        | 126/1000 [00:04<00:11, 76.19 examples/s]
Map:  14%|█▍        | 139/1000 [00:04<00:09, 86.93 examples/s]
Map:  15%|█▌        | 150/1000 [00:04<00:09, 89.86 examples/s]
Map:  16%|█▌        | 162/1000 [00:04<00:08, 93.59 examples/s]
Map:  17%|█▋        | 174/1000 [00:04<00:08, 99.21 examples/s]
Map:  19%|█▊        | 186/1000 [00:04<00:08, 100.64 examples/s]
Map:  20%|█▉        | 198/1000 [00:04<00:07, 104.12 examples/s]
Map:  21%|██▏       | 214/1000 [00:05<00:07, 103.21 examples/s]
Map:  23%|██▎       | 227/1000 [00:05<00:07, 105.05 examples/s]
Map:  24%|██▍       | 239/1000 [00:05<00:07, 107.13 examples/s]
Map:  25%|██▌       | 252/1000 [00:05<00:06, 108.60 examples/s]
Map:  27%|██▋       | 266/1000 [00:05<00:06, 114.74 examples/s]
Map:  28%|██▊       | 280/1000 [00:05<00:06, 119.71 examples/s]
Map:  30%|██▉       | 297/1000 [00:05<00:06, 115.12 examples/s]
Map:  31%|███       | 310/1000 [00:05<00:05, 115.48 examples/s]
Map:  32%|███▏      | 322/1000 [00:05<00:05, 115.55 examples/s]
Map:  34%|███▍      | 340/1000 [00:06<00:05, 114.49 examples/s]
Map:  35%|███▌      | 354/1000 [00:06<00:05, 118.46 examples/s]
Map:  37%|███▋      | 368/1000 [00:06<00:05, 120.54 examples/s]
Map:  38%|███▊      | 381/1000 [00:06<00:05, 120.59 examples/s]
Map:  39%|███▉      | 394/1000 [00:06<00:05, 120.29 examples/s]
Map:  41%|████      | 408/1000 [00:06<00:04, 120.95 examples/s]
Map:  42%|████▏     | 424/1000 [00:06<00:04, 126.02 examples/s]
Map:  44%|████▍     | 444/1000 [00:06<00:04, 122.30 examples/s]
Map:  46%|████▌     | 460/1000 [00:07<00:04, 115.22 examples/s]
Map:  47%|████▋     | 473/1000 [00:07<00:04, 118.17 examples/s]
Map:  49%|████▉     | 488/1000 [00:07<00:04, 125.24 examples/s]
Map:  50%|█████     | 505/1000 [00:07<00:04, 117.95 examples/s]
Map:  52%|█████▏    | 519/1000 [00:07<00:04, 106.38 examples/s]
Map:  53%|█████▎    | 534/1000 [00:07<00:04, 114.75 examples/s]
Map:  55%|█████▍    | 548/1000 [00:07<00:03, 118.27 examples/s]
Map:  56%|█████▌    | 561/1000 [00:07<00:03, 120.29 examples/s]
Map:  57%|█████▋    | 574/1000 [00:08<00:03, 118.13 examples/s]
Map:  59%|█████▊    | 587/1000 [00:08<00:03, 118.44 examples/s]
Map:  60%|█████▉    | 599/1000 [00:08<00:03, 117.81 examples/s]
Map:  61%|██████    | 612/1000 [00:08<00:03, 118.64 examples/s]
Map:  62%|██████▎   | 625/1000 [00:08<00:03, 117.44 examples/s]
Map:  64%|██████▍   | 640/1000 [00:08<00:02, 122.92 examples/s]
Map:  65%|██████▌   | 654/1000 [00:08<00:02, 126.02 examples/s]
Map:  67%|██████▋   | 669/1000 [00:08<00:02, 129.75 examples/s]
Map:  69%|██████▉   | 690/1000 [00:09<00:02, 130.96 examples/s]
Map:  71%|███████   | 706/1000 [00:09<00:02, 134.70 examples/s]
Map:  72%|███████▏  | 721/1000 [00:09<00:02, 137.56 examples/s]
Map:  74%|███████▍  | 740/1000 [00:09<00:01, 132.54 examples/s]
Map:  76%|███████▌  | 755/1000 [00:09<00:02, 120.79 examples/s]
Map:  77%|███████▋  | 768/1000 [00:09<00:01, 119.82 examples/s]
Map:  78%|███████▊  | 784/1000 [00:09<00:01, 127.83 examples/s]
Map:  80%|███████▉  | 797/1000 [00:09<00:01, 127.63 examples/s]
Map:  81%|████████  | 811/1000 [00:09<00:01, 127.16 examples/s]
Map:  82%|████████▎ | 825/1000 [00:10<00:01, 128.12 examples/s]
Map:  84%|████████▍ | 839/1000 [00:10<00:01, 127.98 examples/s]
Map:  85%|████████▌ | 852/1000 [00:10<00:01, 124.70 examples/s]
Map:  87%|████████▋ | 866/1000 [00:10<00:01, 126.42 examples/s]
Map:  88%|████████▊ | 882/1000 [00:10<00:00, 133.67 examples/s]
Map:  90%|████████▉ | 899/1000 [00:10<00:00, 123.00 examples/s]
Map:  91%|█████████▏| 914/1000 [00:10<00:00, 127.31 examples/s]
Map:  93%|█████████▎| 929/1000 [00:10<00:00, 130.17 examples/s]
Map:  95%|█████████▍| 949/1000 [00:11<00:00, 129.80 examples/s]
Map:  96%|█████████▋| 965/1000 [00:11<00:00, 135.58 examples/s]
Map:  98%|█████████▊| 980/1000 [00:11<00:00, 135.55 examples/s]
Map: 100%|█████████▉| 996/1000 [00:11<00:00, 137.59 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 31808.04it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  25%|██▌       | 251/1000 [00:00<00:00, 2504.03it/s]
Logging series metrics to wandb:  51%|█████▏    | 513/1000 [00:00<00:00, 2567.23it/s]
Logging series metrics to wandb:  78%|███████▊  | 783/1000 [00:00<00:00, 2626.35it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2623.49it/s]
2024-01-10 19:35:41.141300: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:35:41.193940: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:35:41.194019: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:35:41.195403: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:35:41.207607: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:35:42.871959: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64521.80lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 19/1000 [00:00<00:05, 180.97 examples/s]
Map:   4%|▍         | 43/1000 [00:00<00:04, 206.69 examples/s]
Map:   7%|▋         | 66/1000 [00:00<00:04, 211.40 examples/s]
Map:   9%|▉         | 89/1000 [00:00<00:04, 217.24 examples/s]
Map:  11%|█         | 112/1000 [00:00<00:04, 217.79 examples/s]
Map:  14%|█▎        | 137/1000 [00:00<00:03, 224.61 examples/s]
Map:  16%|█▌        | 160/1000 [00:00<00:03, 222.42 examples/s]
Map:  19%|█▉        | 192/1000 [00:00<00:03, 213.00 examples/s]
Map:  22%|██▏       | 215/1000 [00:01<00:03, 214.93 examples/s]
Map:  24%|██▍       | 238/1000 [00:01<00:03, 216.43 examples/s]
Map:  26%|██▌       | 261/1000 [00:01<00:03, 218.15 examples/s]
Map:  28%|██▊       | 284/1000 [00:01<00:03, 216.08 examples/s]
Map:  31%|███       | 306/1000 [00:01<00:03, 210.85 examples/s]
Map:  33%|███▎      | 331/1000 [00:01<00:03, 192.04 examples/s]
Map:  36%|███▌      | 358/1000 [00:01<00:03, 186.46 examples/s]
Map:  38%|███▊      | 384/1000 [00:01<00:03, 179.82 examples/s]
Map:  41%|████      | 406/1000 [00:01<00:03, 186.94 examples/s]
Map:  43%|████▎     | 430/1000 [00:02<00:02, 198.24 examples/s]
Map:  45%|████▌     | 454/1000 [00:02<00:02, 207.44 examples/s]
Map:  49%|████▊     | 487/1000 [00:02<00:02, 209.46 examples/s]
Map:  52%|█████▏    | 518/1000 [00:02<00:02, 207.57 examples/s]
Map:  54%|█████▍    | 541/1000 [00:02<00:02, 211.80 examples/s]
Map:  56%|█████▋    | 564/1000 [00:02<00:02, 215.11 examples/s]
Map:  59%|█████▊    | 586/1000 [00:02<00:01, 212.33 examples/s]
Map:  61%|██████    | 609/1000 [00:02<00:01, 212.65 examples/s]
Map:  63%|██████▎   | 631/1000 [00:03<00:01, 210.92 examples/s]
Map:  65%|██████▌   | 653/1000 [00:03<00:01, 210.83 examples/s]
Map:  68%|██████▊   | 675/1000 [00:03<00:01, 211.96 examples/s]
Map:  70%|██████▉   | 699/1000 [00:03<00:01, 216.47 examples/s]
Map:  72%|███████▏  | 722/1000 [00:03<00:01, 215.59 examples/s]
Map:  76%|███████▌  | 755/1000 [00:03<00:01, 211.49 examples/s]
Map:  79%|███████▊  | 787/1000 [00:03<00:01, 211.61 examples/s]
Map:  81%|████████  | 809/1000 [00:03<00:00, 210.57 examples/s]
Map:  83%|████████▎ | 832/1000 [00:03<00:00, 214.24 examples/s]
Map:  86%|████████▋ | 864/1000 [00:04<00:00, 212.34 examples/s]
Map:  89%|████████▊ | 887/1000 [00:04<00:00, 215.00 examples/s]
Map:  91%|█████████ | 909/1000 [00:04<00:00, 213.67 examples/s]
Map:  93%|█████████▎| 931/1000 [00:04<00:00, 211.18 examples/s]
Map:  95%|█████████▌| 953/1000 [00:04<00:00, 211.92 examples/s]
Map:  98%|█████████▊| 978/1000 [00:04<00:00, 218.83 examples/s]
Map: 100%|██████████| 1000/1000 [00:04<00:00, 190.74 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35168.23it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 267/1000 [00:00<00:00, 2668.38it/s]
Logging series metrics to wandb:  55%|█████▍    | 548/1000 [00:00<00:00, 2750.54it/s]
Logging series metrics to wandb:  82%|████████▏ | 824/1000 [00:00<00:00, 2686.84it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2714.07it/s]
2024-01-10 19:36:24.446622: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:36:24.504295: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:36:24.504380: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:36:24.505865: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:36:24.514614: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:36:26.012429: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 68083.82lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 183/1000 [00:00<00:00, 1804.25 examples/s]
Map:  37%|███▋      | 371/1000 [00:00<00:00, 1845.06 examples/s]
Map:  57%|█████▋    | 571/1000 [00:00<00:00, 1907.54 examples/s]
Map:  85%|████████▌ | 850/1000 [00:00<00:00, 1877.70 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 40105.03it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  29%|██▉       | 288/1000 [00:00<00:00, 2872.11it/s]
Logging series metrics to wandb:  58%|█████▊    | 581/1000 [00:00<00:00, 2902.94it/s]
Logging series metrics to wandb:  87%|████████▋ | 872/1000 [00:00<00:00, 2888.56it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2870.83it/s]
2024-01-10 19:37:01.424942: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:37:01.480561: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:37:01.480660: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:37:01.482150: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:37:01.490147: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:37:02.890867: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 67431.46lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 176/1000 [00:00<00:00, 1729.99 examples/s]
Map:  45%|████▍     | 446/1000 [00:00<00:00, 1769.93 examples/s]
Map:  63%|██████▎   | 633/1000 [00:00<00:00, 1802.06 examples/s]
Map:  82%|████████▏ | 823/1000 [00:00<00:00, 1833.58 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37417.74it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▍       | 245/1000 [00:00<00:00, 2440.62it/s]
Logging series metrics to wandb:  49%|████▉     | 490/1000 [00:00<00:00, 2248.96it/s]
Logging series metrics to wandb:  77%|███████▋  | 772/1000 [00:00<00:00, 2494.47it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2527.69it/s]
2024-01-10 19:37:38.503179: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:37:38.557767: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:37:38.557856: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:37:38.559207: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:37:38.567948: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:37:40.124373: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 58468.61lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  22%|██▎       | 225/1000 [00:00<00:00, 2219.35 examples/s]
Map:  46%|████▌     | 455/1000 [00:00<00:00, 2262.28 examples/s]
Map:  71%|███████   | 711/1000 [00:00<00:00, 2392.53 examples/s]
Map:  96%|█████████▋| 965/1000 [00:00<00:00, 2445.39 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 30852.49it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 279/1000 [00:00<00:00, 2781.43it/s]
Logging series metrics to wandb:  56%|█████▌    | 558/1000 [00:00<00:00, 2776.32it/s]
Logging series metrics to wandb:  84%|████████▍ | 841/1000 [00:00<00:00, 2799.44it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2781.77it/s]
2024-01-10 19:38:16.773063: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:38:16.825459: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:38:16.825546: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:38:16.826900: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:38:16.836302: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:38:18.288016: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64700.95lines/s]
Running HELM attack
Loading tokenizer for: meta-llama/Llama-2-7b-chat-hf

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  17%|█▋        | 173/1000 [00:00<00:00, 1703.50 examples/s]
Map:  44%|████▍     | 442/1000 [00:00<00:00, 1758.64 examples/s]
Map:  62%|██████▎   | 625/1000 [00:00<00:00, 1781.04 examples/s]
Map:  81%|████████  | 811/1000 [00:00<00:00, 1806.89 examples/s]
Map: 100%|█████████▉| 998/1000 [00:00<00:00, 1824.48 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/kiyoon23/c4/llama/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 35149.96it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 258/1000 [00:00<00:00, 2577.15it/s]
Logging series metrics to wandb:  53%|█████▎    | 533/1000 [00:00<00:00, 2673.63it/s]
Logging series metrics to wandb:  81%|████████▏ | 813/1000 [00:00<00:00, 2728.39it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2735.47it/s]
finish llama
finish kiyoon23
start xiaoniu23
2024-01-10 19:38:54.566530: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:38:54.623844: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:38:54.623946: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:38:54.625785: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:38:54.637146: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:38:56.280390: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65450.10lines/s]
Running swap attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   7%|▋         | 68/1000 [00:00<00:01, 663.27 examples/s]
Map:  18%|█▊        | 178/1000 [00:00<00:00, 915.80 examples/s]
Map:  31%|███       | 311/1000 [00:00<00:00, 1101.62 examples/s]
Map:  45%|████▌     | 454/1000 [00:00<00:00, 1227.93 examples/s]
Map:  59%|█████▉    | 589/1000 [00:00<00:00, 1267.21 examples/s]
Map:  73%|███████▎  | 726/1000 [00:00<00:00, 1299.38 examples/s]
Map:  87%|████████▋ | 866/1000 [00:00<00:00, 1327.85 examples/s]
Map: 100%|██████████| 1000/1000 [00:00<00:00, 1170.43 examples/s]
                                                                 

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/swap/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/swap/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34335.36it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  25%|██▌       | 254/1000 [00:00<00:00, 2535.19it/s]
Logging series metrics to wandb:  51%|█████     | 508/1000 [00:00<00:00, 2498.65it/s]
Logging series metrics to wandb:  76%|███████▌  | 761/1000 [00:00<00:00, 2512.22it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2568.00it/s]
2024-01-10 19:39:32.894106: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:39:32.947761: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:39:32.947852: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:39:32.949206: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:39:32.956979: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:39:34.411658: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61601.22lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<20:57,  1.26s/ examples]
Map:   1%|          | 8/1000 [00:01<02:10,  7.59 examples/s]
Map:   2%|▏         | 15/1000 [00:01<01:05, 15.02 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:38, 25.11 examples/s]
Map:   3%|▎         | 32/1000 [00:01<00:28, 33.84 examples/s]
Map:   4%|▍         | 41/1000 [00:01<00:22, 42.75 examples/s]
Map:   5%|▍         | 49/1000 [00:02<00:51, 18.52 examples/s]
Map:   6%|▌         | 58/1000 [00:02<00:37, 25.21 examples/s]
Map:   7%|▋         | 66/1000 [00:03<00:29, 31.65 examples/s]
Map:   8%|▊         | 76/1000 [00:03<00:23, 39.98 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:20, 44.64 examples/s]
Map:   9%|▉         | 92/1000 [00:03<00:18, 50.02 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:15, 56.56 examples/s]
Map:  11%|█         | 111/1000 [00:03<00:13, 65.40 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:12, 68.26 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:11, 75.86 examples/s]
Map:  14%|█▍        | 142/1000 [00:03<00:10, 82.83 examples/s]
Map:  15%|█▌        | 153/1000 [00:04<00:09, 85.99 examples/s]
Map:  16%|█▌        | 162/1000 [00:04<00:09, 84.29 examples/s]
Map:  17%|█▋        | 173/1000 [00:04<00:09, 87.07 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 90.88 examples/s]
Map:  19%|█▉        | 194/1000 [00:04<00:08, 92.20 examples/s]
Map:  20%|██        | 204/1000 [00:04<00:08, 93.63 examples/s]
Map:  22%|██▏       | 217/1000 [00:04<00:07, 101.21 examples/s]
Map:  23%|██▎       | 230/1000 [00:04<00:07, 103.11 examples/s]
Map:  24%|██▍       | 245/1000 [00:05<00:07, 98.62 examples/s] 
Map:  26%|██▌       | 257/1000 [00:05<00:07, 102.79 examples/s]
Map:  27%|██▋       | 269/1000 [00:05<00:07, 104.36 examples/s]
Map:  28%|██▊       | 282/1000 [00:05<00:06, 108.11 examples/s]
Map:  30%|██▉       | 295/1000 [00:05<00:06, 110.78 examples/s]
Map:  31%|███       | 307/1000 [00:05<00:06, 110.26 examples/s]
Map:  32%|███▏      | 322/1000 [00:05<00:06, 102.52 examples/s]
Map:  33%|███▎      | 334/1000 [00:05<00:06, 104.77 examples/s]
Map:  34%|███▍      | 345/1000 [00:05<00:06, 103.80 examples/s]
Map:  36%|███▌      | 358/1000 [00:06<00:06, 106.13 examples/s]
Map:  37%|███▋      | 371/1000 [00:06<00:05, 110.84 examples/s]
Map:  39%|███▊      | 386/1000 [00:06<00:05, 118.27 examples/s]
Map:  40%|████      | 401/1000 [00:06<00:04, 125.05 examples/s]
Map:  42%|████▏     | 416/1000 [00:06<00:04, 128.92 examples/s]
Map:  43%|████▎     | 433/1000 [00:06<00:04, 137.82 examples/s]
Map:  45%|████▌     | 450/1000 [00:06<00:03, 145.81 examples/s]
Map:  47%|████▋     | 466/1000 [00:06<00:03, 145.42 examples/s]
Map:  48%|████▊     | 482/1000 [00:06<00:03, 147.15 examples/s]
Map:  51%|█████     | 506/1000 [00:07<00:03, 150.22 examples/s]
Map:  52%|█████▏    | 521/1000 [00:07<00:03, 144.95 examples/s]
Map:  54%|█████▍    | 539/1000 [00:07<00:03, 150.76 examples/s]
Map:  56%|█████▌    | 555/1000 [00:07<00:02, 150.61 examples/s]
Map:  57%|█████▋    | 571/1000 [00:07<00:02, 151.12 examples/s]
Map:  59%|█████▉    | 591/1000 [00:07<00:02, 161.69 examples/s]
Map:  61%|██████    | 609/1000 [00:07<00:02, 163.64 examples/s]
Map:  63%|██████▎   | 626/1000 [00:07<00:02, 163.52 examples/s]
Map:  65%|██████▌   | 650/1000 [00:07<00:02, 158.01 examples/s]
Map:  67%|██████▋   | 672/1000 [00:08<00:01, 170.61 examples/s]
Map:  69%|██████▉   | 691/1000 [00:08<00:01, 173.42 examples/s]
Map:  72%|███████▏  | 716/1000 [00:08<00:01, 166.64 examples/s]
Map:  74%|███████▍  | 740/1000 [00:08<00:01, 159.14 examples/s]
Map:  76%|███████▋  | 765/1000 [00:08<00:01, 159.73 examples/s]
Map:  79%|███████▉  | 789/1000 [00:08<00:01, 154.77 examples/s]
Map:  81%|████████  | 806/1000 [00:08<00:01, 155.60 examples/s]
Map:  83%|████████▎ | 827/1000 [00:09<00:01, 165.56 examples/s]
Map:  85%|████████▌ | 852/1000 [00:09<00:00, 163.92 examples/s]
Map:  87%|████████▋ | 870/1000 [00:09<00:00, 166.91 examples/s]
Map:  89%|████████▉ | 890/1000 [00:09<00:00, 172.70 examples/s]
Map:  91%|█████████ | 908/1000 [00:09<00:00, 172.46 examples/s]
Map:  93%|█████████▎| 926/1000 [00:09<00:00, 171.15 examples/s]
Map:  95%|█████████▌| 951/1000 [00:09<00:00, 164.53 examples/s]
Map:  98%|█████████▊| 976/1000 [00:09<00:00, 160.43 examples/s]
Map: 100%|██████████| 1000/1000 [00:10<00:00, 150.29 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.1/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.1/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 47220.92it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  32%|███▏      | 324/1000 [00:00<00:00, 3235.78it/s]
Logging series metrics to wandb:  65%|██████▌   | 652/1000 [00:00<00:00, 3260.21it/s]
Logging series metrics to wandb:  98%|█████████▊| 979/1000 [00:00<00:00, 3058.32it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3096.10it/s]
2024-01-10 19:40:19.246351: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:40:19.300747: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:40:19.300828: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:40:19.302269: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:40:19.311572: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:40:20.652536: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 65188.67lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<25:36,  1.54s/ examples]
Map:   1%|          | 8/1000 [00:01<02:36,  6.34 examples/s]
Map:   2%|▏         | 15/1000 [00:01<01:16, 12.85 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:43, 22.28 examples/s]
Map:   3%|▎         | 32/1000 [00:02<00:31, 30.80 examples/s]
Map:   4%|▍         | 40/1000 [00:02<00:24, 38.90 examples/s]
Map:   5%|▍         | 48/1000 [00:02<00:20, 46.39 examples/s]
Map:   6%|▌         | 58/1000 [00:02<00:38, 24.54 examples/s]
Map:   7%|▋         | 67/1000 [00:03<00:29, 31.75 examples/s]
Map:   8%|▊         | 76/1000 [00:03<00:23, 38.79 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:20, 44.86 examples/s]
Map:   9%|▉         | 94/1000 [00:03<00:16, 54.03 examples/s]
Map:  10%|█         | 104/1000 [00:03<00:14, 61.92 examples/s]
Map:  11%|█▏        | 113/1000 [00:03<00:13, 67.02 examples/s]
Map:  12%|█▏        | 123/1000 [00:03<00:12, 72.16 examples/s]
Map:  14%|█▎        | 136/1000 [00:03<00:10, 82.96 examples/s]
Map:  15%|█▌        | 151/1000 [00:04<00:09, 86.14 examples/s]
Map:  16%|█▌        | 161/1000 [00:04<00:09, 85.83 examples/s]
Map:  17%|█▋        | 172/1000 [00:04<00:09, 89.45 examples/s]
Map:  18%|█▊        | 182/1000 [00:04<00:08, 91.86 examples/s]
Map:  19%|█▉        | 193/1000 [00:04<00:08, 91.92 examples/s]
Map:  20%|██        | 203/1000 [00:04<00:08, 91.81 examples/s]
Map:  22%|██▏       | 217/1000 [00:04<00:07, 101.14 examples/s]
Map:  23%|██▎       | 230/1000 [00:04<00:07, 103.86 examples/s]
Map:  25%|██▍       | 246/1000 [00:04<00:07, 101.86 examples/s]
Map:  26%|██▌       | 259/1000 [00:05<00:07, 104.56 examples/s]
Map:  27%|██▋       | 270/1000 [00:05<00:08, 90.55 examples/s] 
Map:  28%|██▊       | 282/1000 [00:05<00:08, 84.05 examples/s]
Map:  29%|██▉       | 294/1000 [00:05<00:07, 90.33 examples/s]
Map:  30%|███       | 305/1000 [00:05<00:07, 92.34 examples/s]
Map:  32%|███▏      | 316/1000 [00:05<00:07, 93.96 examples/s]
Map:  33%|███▎      | 328/1000 [00:05<00:06, 98.32 examples/s]
Map:  34%|███▍      | 344/1000 [00:06<00:06, 98.21 examples/s]
Map:  36%|███▌      | 357/1000 [00:06<00:06, 103.58 examples/s]
Map:  37%|███▋      | 369/1000 [00:06<00:06, 104.98 examples/s]
Map:  38%|███▊      | 381/1000 [00:06<00:05, 105.68 examples/s]
Map:  39%|███▉      | 392/1000 [00:06<00:05, 103.88 examples/s]
Map:  40%|████      | 404/1000 [00:06<00:05, 105.69 examples/s]
Map:  42%|████▏     | 415/1000 [00:06<00:05, 104.33 examples/s]
Map:  43%|████▎     | 428/1000 [00:06<00:05, 108.67 examples/s]
Map:  44%|████▍     | 440/1000 [00:06<00:05, 109.45 examples/s]
Map:  45%|████▌     | 452/1000 [00:07<00:05, 107.75 examples/s]
Map:  46%|████▋     | 463/1000 [00:07<00:04, 107.50 examples/s]
Map:  48%|████▊     | 475/1000 [00:07<00:04, 107.51 examples/s]
Map:  49%|████▉     | 488/1000 [00:07<00:04, 110.63 examples/s]
Map:  50%|█████     | 500/1000 [00:07<00:04, 110.68 examples/s]
Map:  51%|█████     | 512/1000 [00:07<00:04, 110.45 examples/s]
Map:  53%|█████▎    | 528/1000 [00:07<00:04, 104.84 examples/s]
Map:  54%|█████▍    | 541/1000 [00:07<00:04, 107.64 examples/s]
Map:  55%|█████▌    | 553/1000 [00:07<00:04, 109.01 examples/s]
Map:  57%|█████▋    | 569/1000 [00:08<00:04, 106.47 examples/s]
Map:  58%|█████▊    | 581/1000 [00:08<00:03, 106.65 examples/s]
Map:  60%|█████▉    | 596/1000 [00:08<00:03, 114.47 examples/s]
Map:  61%|██████    | 609/1000 [00:08<00:03, 116.43 examples/s]
Map:  62%|██████▏   | 622/1000 [00:08<00:03, 117.84 examples/s]
Map:  63%|██████▎   | 634/1000 [00:08<00:03, 113.41 examples/s]
Map:  65%|██████▍   | 646/1000 [00:08<00:03, 112.95 examples/s]
Map:  66%|██████▌   | 661/1000 [00:08<00:02, 122.48 examples/s]
Map:  68%|██████▊   | 675/1000 [00:08<00:02, 123.53 examples/s]
Map:  69%|██████▉   | 691/1000 [00:09<00:02, 111.43 examples/s]
Map:  71%|███████   | 707/1000 [00:09<00:02, 106.25 examples/s]
Map:  72%|███████▏  | 719/1000 [00:09<00:02, 107.25 examples/s]
Map:  73%|███████▎  | 731/1000 [00:09<00:02, 107.07 examples/s]
Map:  74%|███████▍  | 744/1000 [00:09<00:02, 110.70 examples/s]
Map:  76%|███████▋  | 763/1000 [00:09<00:02, 112.94 examples/s]
Map:  78%|███████▊  | 776/1000 [00:09<00:01, 116.93 examples/s]
Map:  79%|███████▉  | 794/1000 [00:10<00:01, 130.67 examples/s]
Map:  81%|████████  | 812/1000 [00:10<00:01, 124.24 examples/s]
Map:  83%|████████▎ | 826/1000 [00:10<00:01, 125.47 examples/s]
Map:  84%|████████▍ | 844/1000 [00:10<00:01, 119.86 examples/s]
Map:  86%|████████▌ | 857/1000 [00:10<00:01, 121.92 examples/s]
Map:  87%|████████▋ | 871/1000 [00:10<00:01, 125.34 examples/s]
Map:  88%|████████▊ | 885/1000 [00:10<00:00, 126.82 examples/s]
Map:  90%|█████████ | 900/1000 [00:10<00:00, 131.03 examples/s]
Map:  92%|█████████▏| 915/1000 [00:10<00:00, 134.17 examples/s]
Map:  93%|█████████▎| 930/1000 [00:11<00:00, 136.80 examples/s]
Map:  94%|█████████▍| 944/1000 [00:11<00:00, 132.96 examples/s]
Map:  96%|█████████▋| 963/1000 [00:11<00:00, 126.86 examples/s]
Map:  98%|█████████▊| 976/1000 [00:11<00:00, 126.40 examples/s]
Map:  99%|█████████▉| 989/1000 [00:11<00:00, 124.21 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.2/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.2/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 39824.00it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  26%|██▌       | 261/1000 [00:00<00:00, 2605.73it/s]
Logging series metrics to wandb:  52%|█████▏    | 522/1000 [00:00<00:00, 2569.69it/s]
Logging series metrics to wandb:  79%|███████▉  | 788/1000 [00:00<00:00, 2606.70it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2558.46it/s]
2024-01-10 19:41:05.901509: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:41:05.951343: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:41:05.951402: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:41:05.952583: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:41:05.960020: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:41:07.312913: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 63348.50lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<24:15,  1.46s/ examples]
Map:   1%|          | 8/1000 [00:01<02:28,  6.68 examples/s]
Map:   2%|▏         | 15/1000 [00:01<01:13, 13.43 examples/s]
Map:   2%|▏         | 24/1000 [00:01<00:42, 23.18 examples/s]
Map:   3%|▎         | 33/1000 [00:01<00:29, 32.88 examples/s]
Map:   4%|▍         | 41/1000 [00:02<00:23, 41.21 examples/s]
Map:   5%|▍         | 49/1000 [00:02<00:37, 25.53 examples/s]
Map:   6%|▌         | 58/1000 [00:02<00:28, 33.56 examples/s]
Map:   7%|▋         | 68/1000 [00:02<00:21, 42.59 examples/s]
Map:   8%|▊         | 77/1000 [00:02<00:18, 49.90 examples/s]
Map:   8%|▊         | 85/1000 [00:03<00:16, 54.21 examples/s]
Map:  10%|▉         | 95/1000 [00:03<00:14, 62.11 examples/s]
Map:  10%|█         | 105/1000 [00:03<00:12, 68.99 examples/s]
Map:  11%|█▏        | 114/1000 [00:03<00:12, 72.16 examples/s]
Map:  12%|█▏        | 123/1000 [00:03<00:11, 75.01 examples/s]
Map:  14%|█▎        | 136/1000 [00:03<00:09, 86.64 examples/s]
Map:  15%|█▍        | 146/1000 [00:03<00:09, 89.09 examples/s]
Map:  16%|█▌        | 156/1000 [00:03<00:09, 90.51 examples/s]
Map:  17%|█▋        | 166/1000 [00:03<00:09, 91.33 examples/s]
Map:  18%|█▊        | 176/1000 [00:04<00:09, 90.58 examples/s]
Map:  19%|█▊        | 187/1000 [00:04<00:08, 91.65 examples/s]
Map:  20%|██        | 201/1000 [00:04<00:09, 87.55 examples/s]
Map:  21%|██▏       | 213/1000 [00:04<00:08, 94.54 examples/s]
Map:  23%|██▎       | 227/1000 [00:04<00:07, 103.73 examples/s]
Map:  24%|██▍       | 242/1000 [00:04<00:07, 98.64 examples/s] 
Map:  26%|██▌       | 258/1000 [00:04<00:06, 111.67 examples/s]
Map:  27%|██▋       | 273/1000 [00:04<00:07, 103.67 examples/s]
Map:  29%|██▉       | 288/1000 [00:05<00:07, 99.37 examples/s] 
Map:  30%|███       | 300/1000 [00:05<00:06, 102.33 examples/s]
Map:  32%|███▏      | 315/1000 [00:05<00:06, 111.22 examples/s]
Map:  33%|███▎      | 330/1000 [00:05<00:05, 118.73 examples/s]
Map:  35%|███▍      | 346/1000 [00:05<00:05, 128.17 examples/s]
Map:  36%|███▌      | 362/1000 [00:05<00:04, 134.51 examples/s]
Map:  38%|███▊      | 378/1000 [00:05<00:04, 141.29 examples/s]
Map:  39%|███▉      | 393/1000 [00:05<00:04, 142.03 examples/s]
Map:  41%|████      | 409/1000 [00:06<00:04, 142.80 examples/s]
Map:  42%|████▎     | 425/1000 [00:06<00:03, 145.68 examples/s]
Map:  44%|████▍     | 440/1000 [00:06<00:03, 142.21 examples/s]
Map:  46%|████▌     | 456/1000 [00:06<00:03, 143.96 examples/s]
Map:  47%|████▋     | 473/1000 [00:06<00:03, 147.03 examples/s]
Map:  49%|████▉     | 490/1000 [00:06<00:04, 126.60 examples/s]
Map:  50%|█████     | 504/1000 [00:06<00:04, 114.46 examples/s]
Map:  52%|█████▏    | 517/1000 [00:06<00:04, 116.48 examples/s]
Map:  53%|█████▎    | 533/1000 [00:06<00:03, 124.64 examples/s]
Map:  55%|█████▍    | 548/1000 [00:07<00:03, 129.97 examples/s]
Map:  56%|█████▋    | 563/1000 [00:07<00:03, 132.10 examples/s]
Map:  58%|█████▊    | 579/1000 [00:07<00:03, 139.08 examples/s]
Map:  60%|█████▉    | 598/1000 [00:07<00:02, 149.05 examples/s]
Map:  62%|██████▏   | 615/1000 [00:07<00:02, 133.59 examples/s]
Map:  64%|██████▎   | 636/1000 [00:07<00:02, 132.41 examples/s]
Map:  65%|██████▌   | 650/1000 [00:07<00:02, 132.36 examples/s]
Map:  67%|██████▋   | 671/1000 [00:07<00:02, 149.30 examples/s]
Map:  69%|██████▉   | 690/1000 [00:08<00:01, 155.97 examples/s]
Map:  71%|███████   | 708/1000 [00:08<00:01, 157.45 examples/s]
Map:  72%|███████▎  | 725/1000 [00:08<00:01, 158.84 examples/s]
Map:  74%|███████▍  | 742/1000 [00:08<00:01, 158.33 examples/s]
Map:  76%|███████▌  | 759/1000 [00:08<00:01, 160.07 examples/s]
Map:  78%|███████▊  | 777/1000 [00:08<00:01, 159.75 examples/s]
Map:  79%|███████▉  | 794/1000 [00:08<00:01, 160.21 examples/s]
Map:  82%|████████▏ | 819/1000 [00:08<00:01, 156.86 examples/s]
Map:  84%|████████▎ | 837/1000 [00:08<00:01, 159.27 examples/s]
Map:  85%|████████▌ | 854/1000 [00:09<00:00, 159.29 examples/s]
Map:  87%|████████▋ | 873/1000 [00:09<00:00, 164.48 examples/s]
Map:  89%|████████▉ | 892/1000 [00:09<00:00, 168.31 examples/s]
Map:  91%|█████████ | 912/1000 [00:09<00:00, 174.11 examples/s]
Map:  93%|█████████▎| 930/1000 [00:09<00:00, 174.04 examples/s]
Map:  95%|█████████▍| 949/1000 [00:09<00:00, 175.97 examples/s]
Map:  98%|█████████▊| 975/1000 [00:09<00:00, 169.55 examples/s]
Map:  99%|█████████▉| 994/1000 [00:09<00:00, 171.11 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.4/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.4/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 53440.15it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  31%|███▏      | 313/1000 [00:00<00:00, 3120.33it/s]
Logging series metrics to wandb:  68%|██████▊   | 681/1000 [00:00<00:00, 3445.51it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 3416.57it/s]
2024-01-10 19:41:52.429431: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:41:52.515986: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:41:52.516058: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:41:52.517872: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:41:52.528701: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:41:53.979369: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 44280.61lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<27:05,  1.63s/ examples]
Map:   1%|          | 6/1000 [00:01<03:38,  4.55 examples/s]
Map:   1%|          | 12/1000 [00:01<01:38, 10.07 examples/s]
Map:   2%|▏         | 19/1000 [00:01<00:56, 17.40 examples/s]
Map:   3%|▎         | 27/1000 [00:02<00:36, 26.49 examples/s]
Map:   4%|▎         | 35/1000 [00:02<00:27, 34.55 examples/s]
Map:   4%|▍         | 43/1000 [00:02<00:22, 43.29 examples/s]
Map:   5%|▌         | 53/1000 [00:03<00:44, 21.23 examples/s]
Map:   6%|▌         | 62/1000 [00:03<00:33, 28.11 examples/s]
Map:   7%|▋         | 71/1000 [00:03<00:26, 34.94 examples/s]
Map:   8%|▊         | 79/1000 [00:03<00:22, 41.30 examples/s]
Map:   9%|▊         | 86/1000 [00:03<00:20, 45.36 examples/s]
Map:  10%|▉         | 95/1000 [00:03<00:17, 52.62 examples/s]
Map:  10%|█         | 104/1000 [00:03<00:15, 58.80 examples/s]
Map:  11%|█▏        | 113/1000 [00:03<00:13, 63.66 examples/s]
Map:  12%|█▏        | 123/1000 [00:04<00:12, 69.51 examples/s]
Map:  14%|█▎        | 135/1000 [00:04<00:10, 80.98 examples/s]
Map:  15%|█▍        | 149/1000 [00:04<00:10, 82.81 examples/s]
Map:  16%|█▌        | 161/1000 [00:04<00:10, 80.26 examples/s]
Map:  17%|█▋        | 171/1000 [00:04<00:09, 83.94 examples/s]
Map:  18%|█▊        | 182/1000 [00:04<00:09, 88.20 examples/s]
Map:  19%|█▉        | 193/1000 [00:04<00:08, 91.05 examples/s]
Map:  21%|██        | 208/1000 [00:04<00:08, 92.21 examples/s]
Map:  23%|██▎       | 226/1000 [00:05<00:06, 110.60 examples/s]
Map:  24%|██▍       | 239/1000 [00:05<00:06, 113.26 examples/s]
Map:  25%|██▌       | 254/1000 [00:05<00:06, 120.16 examples/s]
Map:  27%|██▋       | 269/1000 [00:05<00:05, 126.37 examples/s]
Map:  28%|██▊       | 285/1000 [00:05<00:05, 134.45 examples/s]
Map:  30%|███       | 300/1000 [00:05<00:05, 135.77 examples/s]
Map:  32%|███▏      | 316/1000 [00:05<00:04, 137.17 examples/s]
Map:  33%|███▎      | 331/1000 [00:05<00:04, 137.96 examples/s]
Map:  34%|███▍      | 345/1000 [00:05<00:04, 136.58 examples/s]
Map:  36%|███▋      | 363/1000 [00:06<00:04, 143.57 examples/s]
Map:  38%|███▊      | 380/1000 [00:06<00:04, 147.42 examples/s]
Map:  40%|███▉      | 395/1000 [00:06<00:04, 146.08 examples/s]
Map:  41%|████      | 410/1000 [00:06<00:04, 143.87 examples/s]
Map:  43%|████▎     | 426/1000 [00:06<00:04, 142.60 examples/s]
Map:  44%|████▍     | 441/1000 [00:06<00:04, 139.73 examples/s]
Map:  46%|████▌     | 456/1000 [00:06<00:03, 137.02 examples/s]
Map:  47%|████▋     | 472/1000 [00:06<00:03, 142.31 examples/s]
Map:  49%|████▊     | 487/1000 [00:06<00:03, 140.64 examples/s]
Map:  50%|█████     | 503/1000 [00:07<00:03, 140.53 examples/s]
Map:  52%|█████▏    | 519/1000 [00:07<00:03, 139.18 examples/s]
Map:  54%|█████▎    | 536/1000 [00:07<00:03, 144.07 examples/s]
Map:  55%|█████▌    | 551/1000 [00:07<00:03, 143.80 examples/s]
Map:  57%|█████▋    | 567/1000 [00:07<00:03, 124.18 examples/s]
Map:  58%|█████▊    | 583/1000 [00:07<00:03, 129.41 examples/s]
Map:  60%|██████    | 602/1000 [00:07<00:02, 143.17 examples/s]
Map:  62%|██████▏   | 619/1000 [00:07<00:02, 148.90 examples/s]
Map:  64%|██████▎   | 635/1000 [00:07<00:02, 146.61 examples/s]
Map:  66%|██████▌   | 661/1000 [00:08<00:02, 152.17 examples/s]
Map:  68%|██████▊   | 679/1000 [00:08<00:02, 157.11 examples/s]
Map:  70%|██████▉   | 695/1000 [00:08<00:01, 156.84 examples/s]
Map:  72%|███████▏  | 717/1000 [00:08<00:01, 151.02 examples/s]
Map:  73%|███████▎  | 733/1000 [00:08<00:01, 149.64 examples/s]
Map:  75%|███████▌  | 750/1000 [00:08<00:01, 150.85 examples/s]
Map:  77%|███████▋  | 766/1000 [00:08<00:01, 151.53 examples/s]
Map:  79%|███████▉  | 791/1000 [00:08<00:01, 154.64 examples/s]
Map:  81%|████████  | 807/1000 [00:09<00:01, 152.76 examples/s]
Map:  82%|████████▎ | 825/1000 [00:09<00:01, 156.63 examples/s]
Map:  85%|████████▍ | 848/1000 [00:09<00:01, 151.78 examples/s]
Map:  86%|████████▋ | 865/1000 [00:09<00:00, 154.99 examples/s]
Map:  88%|████████▊ | 882/1000 [00:09<00:00, 155.40 examples/s]
Map:  90%|████████▉ | 899/1000 [00:09<00:00, 155.50 examples/s]
Map:  92%|█████████▏| 917/1000 [00:09<00:00, 158.54 examples/s]
Map:  93%|█████████▎| 934/1000 [00:09<00:00, 158.67 examples/s]
Map:  95%|█████████▌| 951/1000 [00:10<00:00, 159.05 examples/s]
Map:  97%|█████████▋| 967/1000 [00:10<00:00, 155.45 examples/s]
Map:  98%|█████████▊| 985/1000 [00:10<00:00, 157.97 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.8/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-0.8/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 40983.61it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 278/1000 [00:00<00:00, 2769.53it/s]
Logging series metrics to wandb:  56%|█████▌    | 558/1000 [00:00<00:00, 2784.00it/s]
Logging series metrics to wandb:  84%|████████▎ | 837/1000 [00:00<00:00, 2741.26it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2733.59it/s]
2024-01-10 19:42:45.955370: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:42:46.015604: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:42:46.015714: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:42:46.017339: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:42:46.025821: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:42:47.553879: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 61644.68lines/s]
Running synonym attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   0%|          | 1/1000 [00:01<27:22,  1.64s/ examples]
Map:   1%|          | 6/1000 [00:01<03:39,  4.53 examples/s]
Map:   1%|▏         | 13/1000 [00:01<01:30, 10.95 examples/s]
Map:   2%|▏         | 21/1000 [00:01<00:51, 19.09 examples/s]
Map:   3%|▎         | 31/1000 [00:02<00:32, 30.01 examples/s]
Map:   4%|▍         | 40/1000 [00:02<00:24, 38.87 examples/s]
Map:   5%|▍         | 49/1000 [00:02<00:43, 22.07 examples/s]
Map:   6%|▌         | 58/1000 [00:03<00:32, 29.13 examples/s]
Map:   7%|▋         | 68/1000 [00:03<00:24, 37.66 examples/s]
Map:   8%|▊         | 76/1000 [00:03<00:21, 43.70 examples/s]
Map:   8%|▊         | 84/1000 [00:03<00:18, 48.86 examples/s]
Map:   9%|▉         | 93/1000 [00:03<00:16, 56.24 examples/s]
Map:  10%|█         | 101/1000 [00:03<00:14, 60.73 examples/s]
Map:  11%|█         | 111/1000 [00:03<00:13, 67.89 examples/s]
Map:  12%|█▏        | 119/1000 [00:03<00:12, 69.78 examples/s]
Map:  13%|█▎        | 130/1000 [00:03<00:11, 77.79 examples/s]
Map:  14%|█▍        | 140/1000 [00:04<00:10, 82.46 examples/s]
Map:  15%|█▌        | 151/1000 [00:04<00:09, 87.06 examples/s]
Map:  16%|█▌        | 161/1000 [00:04<00:09, 87.13 examples/s]
Map:  17%|█▋        | 172/1000 [00:04<00:09, 91.44 examples/s]
Map:  18%|█▊        | 184/1000 [00:04<00:08, 94.79 examples/s]
Map:  20%|█▉        | 197/1000 [00:04<00:07, 101.21 examples/s]
Map:  21%|██        | 211/1000 [00:04<00:07, 111.03 examples/s]
Map:  23%|██▎       | 229/1000 [00:04<00:06, 127.34 examples/s]
Map:  24%|██▍       | 244/1000 [00:04<00:05, 129.50 examples/s]
Map:  26%|██▌       | 259/1000 [00:05<00:05, 133.25 examples/s]
Map:  27%|██▋       | 274/1000 [00:05<00:05, 134.73 examples/s]
Map:  29%|██▉       | 291/1000 [00:05<00:05, 139.15 examples/s]
Map:  31%|███       | 312/1000 [00:05<00:05, 136.31 examples/s]
Map:  33%|███▎      | 334/1000 [00:05<00:04, 135.61 examples/s]
Map:  35%|███▌      | 350/1000 [00:05<00:04, 138.26 examples/s]
Map:  37%|███▋      | 367/1000 [00:05<00:04, 143.24 examples/s]
Map:  38%|███▊      | 384/1000 [00:05<00:04, 146.59 examples/s]
Map:  40%|████      | 401/1000 [00:06<00:03, 151.62 examples/s]
Map:  42%|████▎     | 425/1000 [00:06<00:03, 151.23 examples/s]
Map:  45%|████▍     | 449/1000 [00:06<00:03, 149.00 examples/s]
Map:  47%|████▋     | 466/1000 [00:06<00:03, 151.65 examples/s]
Map:  49%|████▉     | 488/1000 [00:06<00:03, 147.18 examples/s]
Map:  50%|█████     | 504/1000 [00:06<00:03, 149.72 examples/s]
Map:  53%|█████▎    | 527/1000 [00:06<00:03, 146.48 examples/s]
Map:  54%|█████▍    | 544/1000 [00:07<00:03, 147.82 examples/s]
Map:  56%|█████▌    | 559/1000 [00:07<00:03, 144.75 examples/s]
Map:  57%|█████▊    | 575/1000 [00:07<00:02, 146.54 examples/s]
Map:  59%|█████▉    | 594/1000 [00:07<00:02, 154.61 examples/s]
Map:  61%|██████    | 611/1000 [00:07<00:02, 156.15 examples/s]
Map:  63%|██████▎   | 629/1000 [00:07<00:02, 159.92 examples/s]
Map:  65%|██████▌   | 653/1000 [00:07<00:02, 156.98 examples/s]
Map:  68%|██████▊   | 675/1000 [00:07<00:01, 169.02 examples/s]
Map:  69%|██████▉   | 693/1000 [00:07<00:01, 169.25 examples/s]
Map:  72%|███████▏  | 717/1000 [00:08<00:01, 163.91 examples/s]
Map:  74%|███████▍  | 742/1000 [00:08<00:01, 161.18 examples/s]
Map:  76%|███████▌  | 760/1000 [00:08<00:01, 161.79 examples/s]
Map:  78%|███████▊  | 777/1000 [00:08<00:01, 162.00 examples/s]
Map:  80%|███████▉  | 795/1000 [00:08<00:01, 164.19 examples/s]
Map:  81%|████████▏ | 813/1000 [00:08<00:01, 142.32 examples/s]
Map:  83%|████████▎ | 829/1000 [00:08<00:01, 141.07 examples/s]
Map:  85%|████████▍ | 847/1000 [00:08<00:01, 132.51 examples/s]
Map:  86%|████████▌ | 861/1000 [00:09<00:01, 129.16 examples/s]
Map:  88%|████████▊ | 875/1000 [00:09<00:00, 130.63 examples/s]
Map:  89%|████████▉ | 889/1000 [00:09<00:00, 128.29 examples/s]
Map:  90%|█████████ | 905/1000 [00:09<00:00, 103.94 examples/s]
Map:  92%|█████████▏| 921/1000 [00:09<00:00, 91.80 examples/s] 
Map:  93%|█████████▎| 934/1000 [00:09<00:00, 84.47 examples/s]
Map:  95%|█████████▌| 950/1000 [00:10<00:00, 87.28 examples/s]
Map:  96%|█████████▌| 962/1000 [00:10<00:00, 91.77 examples/s]
Map:  97%|█████████▋| 974/1000 [00:10<00:00, 96.26 examples/s]
Map:  99%|█████████▊| 987/1000 [00:10<00:00, 103.12 examples/s]
Map: 100%|█████████▉| 999/1000 [00:10<00:00, 104.83 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-1.0/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/synonym-1.0/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 37920.44it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  24%|██▍       | 242/1000 [00:00<00:00, 2419.41it/s]
Logging series metrics to wandb:  52%|█████▏    | 518/1000 [00:00<00:00, 2615.34it/s]
Logging series metrics to wandb:  80%|███████▉  | 797/1000 [00:00<00:00, 2693.20it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2684.96it/s]
2024-01-10 19:43:35.272287: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:43:35.329231: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:43:35.329319: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:43:35.330665: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:43:35.339695: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:43:36.678758: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 62502.67lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:   2%|▏         | 20/1000 [00:00<00:05, 183.36 examples/s]
Map:   4%|▍         | 42/1000 [00:00<00:04, 194.34 examples/s]
Map:   6%|▋         | 64/1000 [00:00<00:04, 198.63 examples/s]
Map:   8%|▊         | 84/1000 [00:00<00:04, 192.77 examples/s]
Map:  10%|█         | 105/1000 [00:00<00:04, 193.30 examples/s]
Map:  12%|█▎        | 125/1000 [00:00<00:04, 190.18 examples/s]
Map:  15%|█▍        | 148/1000 [00:00<00:04, 200.65 examples/s]
Map:  18%|█▊        | 179/1000 [00:00<00:04, 197.80 examples/s]
Map:  20%|██        | 200/1000 [00:01<00:04, 199.16 examples/s]
Map:  22%|██▏       | 224/1000 [00:01<00:03, 206.80 examples/s]
Map:  26%|██▌       | 255/1000 [00:01<00:03, 202.45 examples/s]
Map:  28%|██▊       | 277/1000 [00:01<00:03, 202.46 examples/s]
Map:  30%|██▉       | 298/1000 [00:01<00:03, 203.31 examples/s]
Map:  33%|███▎      | 329/1000 [00:01<00:03, 200.50 examples/s]
Map:  35%|███▌      | 350/1000 [00:01<00:03, 200.13 examples/s]
Map:  37%|███▋      | 374/1000 [00:01<00:03, 205.48 examples/s]
Map:  40%|████      | 404/1000 [00:02<00:02, 200.60 examples/s]
Map:  43%|████▎     | 434/1000 [00:02<00:02, 197.59 examples/s]
Map:  46%|████▌     | 456/1000 [00:02<00:02, 198.93 examples/s]
Map:  48%|████▊     | 479/1000 [00:02<00:02, 202.00 examples/s]
Map:  50%|█████     | 500/1000 [00:02<00:02, 201.50 examples/s]
Map:  53%|█████▎    | 530/1000 [00:02<00:02, 196.73 examples/s]
Map:  56%|█████▌    | 558/1000 [00:02<00:02, 191.40 examples/s]
Map:  58%|█████▊    | 578/1000 [00:02<00:02, 191.44 examples/s]
Map:  60%|██████    | 600/1000 [00:03<00:02, 196.03 examples/s]
Map:  62%|██████▏   | 623/1000 [00:03<00:01, 200.37 examples/s]
Map:  65%|██████▌   | 653/1000 [00:03<00:01, 194.89 examples/s]
Map:  68%|██████▊   | 679/1000 [00:03<00:01, 206.04 examples/s]
Map:  70%|███████   | 701/1000 [00:03<00:01, 206.17 examples/s]
Map:  73%|███████▎  | 728/1000 [00:03<00:01, 194.69 examples/s]
Map:  76%|███████▌  | 756/1000 [00:03<00:01, 190.67 examples/s]
Map:  78%|███████▊  | 778/1000 [00:03<00:01, 193.44 examples/s]
Map:  80%|████████  | 800/1000 [00:04<00:01, 195.51 examples/s]
Map:  82%|████████▏ | 822/1000 [00:04<00:00, 198.91 examples/s]
Map:  85%|████████▌ | 853/1000 [00:04<00:00, 198.68 examples/s]
Map:  87%|████████▋ | 874/1000 [00:04<00:00, 197.42 examples/s]
Map:  90%|████████▉ | 896/1000 [00:04<00:00, 201.39 examples/s]
Map:  92%|█████████▏| 918/1000 [00:04<00:00, 202.11 examples/s]
Map:  95%|█████████▍| 948/1000 [00:04<00:00, 200.42 examples/s]
Map:  98%|█████████▊| 977/1000 [00:04<00:00, 194.25 examples/s]
Map: 100%|█████████▉| 997/1000 [00:05<00:00, 192.89 examples/s]
                                                               

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/MisspellingAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 27620.45it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 274/1000 [00:00<00:00, 2733.57it/s]
Logging series metrics to wandb:  56%|█████▌    | 559/1000 [00:00<00:00, 2796.37it/s]
Logging series metrics to wandb:  84%|████████▍ | 841/1000 [00:00<00:00, 2805.15it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2793.07it/s]
2024-01-10 19:44:18.062468: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:44:18.116386: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:44:18.116467: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:44:18.117904: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:44:18.126642: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:44:19.755982: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60963.72lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  14%|█▍        | 143/1000 [00:00<00:00, 1404.10 examples/s]
Map:  30%|███       | 302/1000 [00:00<00:00, 1505.70 examples/s]
Map:  46%|████▌     | 462/1000 [00:00<00:00, 1542.10 examples/s]
Map:  68%|██████▊   | 677/1000 [00:00<00:00, 1480.63 examples/s]
Map:  90%|█████████ | 900/1000 [00:00<00:00, 1479.01 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/TypoAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/TypoAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34352.79it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  20%|█▉        | 195/1000 [00:00<00:00, 1944.79it/s]
Logging series metrics to wandb:  39%|███▉      | 390/1000 [00:00<00:00, 1794.84it/s]
Logging series metrics to wandb:  64%|██████▍   | 644/1000 [00:00<00:00, 2118.76it/s]
Logging series metrics to wandb:  91%|█████████ | 911/1000 [00:00<00:00, 2329.23it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2240.86it/s]
2024-01-10 19:44:56.064457: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:44:56.124442: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:44:56.124541: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:44:56.125871: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:44:56.133728: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:44:57.590675: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 64667.04lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  14%|█▎        | 137/1000 [00:00<00:00, 1341.94 examples/s]
Map:  30%|███       | 305/1000 [00:00<00:00, 1534.26 examples/s]
Map:  54%|█████▍    | 542/1000 [00:00<00:00, 1558.28 examples/s]
Map:  71%|███████   | 712/1000 [00:00<00:00, 1602.06 examples/s]
Map:  94%|█████████▍| 945/1000 [00:00<00:00, 1577.95 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ContractionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ContractionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 33730.37it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  27%|██▋       | 269/1000 [00:00<00:00, 2675.03it/s]
Logging series metrics to wandb:  55%|█████▍    | 548/1000 [00:00<00:00, 2741.92it/s]
Logging series metrics to wandb:  83%|████████▎ | 829/1000 [00:00<00:00, 2770.17it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2783.97it/s]
2024-01-10 19:45:34.112896: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:45:34.172906: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:45:34.173172: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:45:34.175068: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:45:34.186486: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:45:35.839581: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 57819.77lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  18%|█▊        | 183/1000 [00:00<00:00, 1802.64 examples/s]
Map:  41%|████      | 409/1000 [00:00<00:00, 2067.81 examples/s]
Map:  72%|███████▏  | 723/1000 [00:00<00:00, 2075.41 examples/s]
Map:  94%|█████████▍| 942/1000 [00:00<00:00, 2112.02 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/LowercaseAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 34017.89it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  28%|██▊       | 277/1000 [00:00<00:00, 2766.41it/s]
Logging series metrics to wandb:  56%|█████▌    | 560/1000 [00:00<00:00, 2801.34it/s]
Logging series metrics to wandb:  85%|████████▍ | 849/1000 [00:00<00:00, 2839.37it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 2782.61it/s]
2024-01-10 19:46:13.151425: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:46:13.235226: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:46:13.235314: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:46:13.236989: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:46:13.247366: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:46:14.692887: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt
Loading previously generated outputs for attacking ...

Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl:   0%|          | 0/1000 [00:00<?, ?lines/s]
Reading JSON lines from /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/gen_table.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 60049.02lines/s]
Running HELM attack
Loading tokenizer for: facebook/opt-1.3b

Map:   0%|          | 0/1000 [00:00<?, ? examples/s]
Map:  16%|█▋        | 163/1000 [00:00<00:00, 1613.84 examples/s]
Map:  33%|███▎      | 327/1000 [00:00<00:00, 1626.29 examples/s]
Map:  49%|████▉     | 492/1000 [00:00<00:00, 1631.77 examples/s]
Map:  66%|██████▌   | 656/1000 [00:00<00:00, 1630.32 examples/s]
Map:  84%|████████▍ | 838/1000 [00:00<00:00, 1433.44 examples/s]
Map:  99%|█████████▉| 994/1000 [00:00<00:00, 1273.58 examples/s]
                                                                

Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl:   0%|          | 0/1000 [00:00<?, ?it/s]
Writing JSON lines at /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/opt/ExpansionAttack/gen_table_attacked.jsonl: 100%|██████████| 1000/1000 [00:00<00:00, 21945.12it/s]

Logging series metrics to wandb:   0%|          | 0/1000 [00:00<?, ?it/s]
Logging series metrics to wandb:  18%|█▊        | 180/1000 [00:00<00:00, 1796.98it/s]
Logging series metrics to wandb:  36%|███▌      | 360/1000 [00:00<00:00, 1790.92it/s]
Logging series metrics to wandb:  54%|█████▍    | 540/1000 [00:00<00:00, 1790.57it/s]
Logging series metrics to wandb:  72%|███████▏  | 720/1000 [00:00<00:00, 1784.79it/s]
Logging series metrics to wandb:  94%|█████████▍| 942/1000 [00:00<00:00, 1940.80it/s]
Logging series metrics to wandb: 100%|██████████| 1000/1000 [00:00<00:00, 1919.63it/s]
finish opt
2024-01-10 19:46:52.309966: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:46:52.362489: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:46:52.362557: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:46:52.363726: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:46:52.370831: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:46:53.974851: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/swap
Attack method: swap
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:47:07.374846: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:47:07.426834: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:47:07.426924: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:47:07.428396: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:47:07.437080: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:47:09.017890: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/synonym-0.1
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:47:23.218826: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:47:23.268515: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:47:23.268598: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:47:23.269785: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:47:23.277292: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:47:24.772339: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/synonym-0.2
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:47:39.312448: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:47:39.366358: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:47:39.366452: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:47:39.367747: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:47:39.376084: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:47:41.040813: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/synonym-0.4
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:47:55.492821: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:47:55.549161: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:47:55.549264: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:47:55.550605: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:47:55.558834: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:47:57.200384: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/synonym-0.8
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:48:11.619766: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:48:11.674749: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:48:11.674856: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:48:11.676338: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:48:11.684355: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:48:13.146730: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/synonym-1.0
Attack method: synonym
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:48:25.347694: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:48:25.399840: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:48:25.399904: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:48:25.401043: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:48:25.407752: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:48:26.551403: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/MisspellingAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:48:37.928088: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:48:37.978900: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:48:37.978972: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:48:37.980128: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:48:37.986890: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:48:39.144712: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/TypoAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:48:50.930644: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:48:50.984461: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:48:50.984556: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:48:50.986022: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:48:50.994494: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:48:52.544194: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/ContractionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:49:04.779412: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:49:04.827734: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:49:04.827789: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:49:04.828927: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:49:04.836579: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:49:06.213213: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/LowercaseAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
2024-01-10 19:49:18.459159: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-10 19:49:18.520126: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-10 19:49:18.520219: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-10 19:49:18.521573: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-10 19:49:18.529383: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-10 19:49:19.886683: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/jkl6486/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Output dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/ExpansionAttack
Attack method: helm
Input dir for this run: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama
Loading previously generated outputs for attacking ...
Traceback (most recent call last):
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 581, in <module>
    main(args)
  File "/home/jkl6486/sok-llm-watermark/watermark_reliability_release/attack_pipeline.py", line 97, in main
    assert os.path.exists(
AssertionError: failed file check for prev generations metadata json file: /home/jkl6486/sok-llm-watermark/runs/xiaoniu23/c4/llama/gen_table_meta.json
finish llama
finish xiaoniu23
finish all
